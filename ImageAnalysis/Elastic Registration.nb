(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     32593,       1023]*)
(*NotebookOutlinePosition[     33241,       1046]*)
(*  CellTagsIndexPosition[     33197,       1042]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[BoxData[
    \(<< "\<Research/Image\ Analysis/AlternativeDisplay.m\>"\)], "Input"],

Cell[BoxData[
    \(<< "\<C:\\Documents and Settings\\Adriel\\My Documents\\Research\\Image \
Analysis\\AlternativeDisplay.m\>"\)], "Input"],

Cell[BoxData[{
    \(\($IMAGESIZE = 1000;\)\), "\[IndentingNewLine]", 
    \(\($IMAGEARRAYSIZE = 1500;\)\)}], "Input"],

Cell[BoxData[{
    \(\($IMAGESIZE = 500;\)\), "\[IndentingNewLine]", 
    \(\($IMAGEARRAYSIZE = 500;\)\)}], "Input"],

Cell[CellGroupData[{

Cell["Test Images", "Subsection"],

Cell[CellGroupData[{

Cell["Stair case", "Subsubsection"],

Cell[BoxData[{
    \(\(img1 = 
        Table[UnitStep[x + 3, 3 - x] UnitStep[y + 3, 3 - y] 
            If[x > y, 1, 0], {x, \(-10\), 10}, {y, \(-10\), 10}];\)\), "\n", 
    \(\(img2 = 
        Table[UnitStep[x + 4, 2 - x] UnitStep[y + 4, 2 - y] 
            If[x > y, 1, 0], {x, \(-10\), 10}, {y, \(-10\), 
            10}];\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpolation", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({d1, d2} = Dimensions[img1];\)\), "\[IndentingNewLine]", 
    \(img1f = 
      ListInterpolation[img1, 
        InterpolationOrder \[Rule] 1]\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, 
          InterpolationOrder \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(DisplayTogetherArray[\[IndentingNewLine]\(DensityPlot[#[x, y], {x, 1, 
              d1}, {y, 1, d2}, PlotPoints \[Rule] {d1, d2}] &\) /@ {img1f, 
          img2f}\[IndentingNewLine]]\)}], "Input"],

Cell[BoxData[
    TagBox[\(InterpolatingFunction[{{1, 21}, {1, 21}}, "<>"]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]ListDensityPlot /@ {img1, img2, 
          img1 + img2}\[IndentingNewLine]]\)], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["1D Translation", "Subsection"],

Cell[BoxData[
    \(\(ClippedImage = 
        Function[{imgf, x}, imgf[Clip[x + m, {1, d1}]]];\)\)], "Input"],

Cell[BoxData[{
    \(\(d1 = 10;\)\), "\[IndentingNewLine]", 
    \(\(img1 = \(img2 = Table[0. , {d1}]\);\)\), "\[IndentingNewLine]", 
    \(\(img1[\([{5, 6}]\)] = 1. ;\)\), "\[IndentingNewLine]", 
    \(\(img2[\([{4, 5, 6, 7}]\)] = 1. ;\)\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(fx = 
      ListConvolve[N@{2, 0, \(-2\)}, Flatten[{0. , img1, 0. }]]\)], "Input"],

Cell[BoxData[
    \({0.`, 0.`, 0.`, 2.`, 2.`, \(-2.`\), \(-2.`\), 0.`, 0.`, 
      0.`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]ListPlot[img1, 
        PlotJoined \[Rule] True], \[IndentingNewLine]ListPlot[fx, 
        PlotJoined \[Rule] True]\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(\(ListPlot[img1 - img2];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(fx2 = Total[fx\^2]\)], "Input"],

Cell[BoxData[
    \(16.`\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(m = 0;\)\), "\n", 
    \(Do[\[IndentingNewLine]ft = 
        img1 - ClippedImage[img2f, Range[d1]]; \[IndentingNewLine]ftfx = 
        Total[ft\ fx]; \[IndentingNewLine]m += ftfx/fx2; \n
      DisplayTogether[ListPlot[img1, PlotJoined \[Rule] True], 
        Plot[ClippedImage[img2f, t], {t, 1, d1}], 
        DisplayFunction \[Rule] ani];, \[IndentingNewLine]{10}]\)}], "Input"],

Cell[BoxData[
    \(DisplayTogether[\[IndentingNewLine]ListPlot[ft, 
        PlotJoined \[Rule] True, 
        PlotStyle \[Rule] Hue[0]], \[IndentingNewLine]ListPlot[fx, 
        PlotJoined \[Rule] True]\[IndentingNewLine]]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["1D 1st order spatial derivative", "Subsection"],

Cell[BoxData[
    \(\(ClippedImage = 
        Function[{imgf, x}, imgf[Clip[x + m, {1, d1}]]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 10;\)\), "\[IndentingNewLine]", 
    \(\(img1 = \(img2 = Table[0. , {d1}]\);\)\), "\[IndentingNewLine]", 
    \(\(img1[\([{5, 6}]\)] = 1. ;\)\), "\[IndentingNewLine]", 
    \(\(img2[\([{4, 5, 6}]\)] = 1. ;\)\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(img2f\\)\\\" is similar to existing symbols \
\\!\\({img2, imgf}\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(fx = ListConvolve[N@{1, \(-1\)}, Flatten[{0. , img1, 0. }]]\)], "Input"],

Cell[BoxData[
    \({0.`, 0.`, 0.`, 0.`, 1.`, 0.`, \(-1.`\), 0.`, 0.`, 0.`, 
      0.`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]ListPlot[img1, 
        PlotJoined \[Rule] True], \[IndentingNewLine]ListPlot[fx, 
        PlotJoined \[Rule] True]\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(\(ListPlot[img1 - img2];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(fx2 = Total[fx\^2]\)], "Input"],

Cell[BoxData[
    \(16.`\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(m = 0;\)\), "\n", 
    \(Do[\[IndentingNewLine]ft = 
        img1 - ClippedImage[img2f, Range[d1]]; \[IndentingNewLine]ftfx = 
        Total[ft\ fx]; \[IndentingNewLine]m += ftfx/fx2; \n
      DisplayTogether[ListPlot[img1, PlotJoined \[Rule] True], 
        Plot[ClippedImage[img2f, t], {t, 1, d1}], 
        DisplayFunction \[Rule] ani];, \[IndentingNewLine]{10}]\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["1D Spatially Varying Translation", "Subsection"],

Cell[BoxData[{
    \(\(d1 = 100;\)\), "\[IndentingNewLine]", 
    \(\(img1 = 
        Table[Exp[\(-\((x - 50)\)\^2\)/50], {x, 
            d1}];\)\), "\[IndentingNewLine]", 
    \(\(img2 = 
        Table[Exp[\(-\((x - 70)\)\^2\)/50], {x, 
            d1}];\)\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[{
    \(\(d1 = 4;\)\), "\[IndentingNewLine]", 
    \(\(img1 = {0, 10, 0, 0};\)\), "\[IndentingNewLine]", 
    \(\(img2 = {0, 0, 10, 0};\)\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \(DisplayTogether[ListPlot[img1], ListPlot[img2]]\)], "Input"],

Cell[BoxData[
    \(\(fx = 
        ListConvolve[N@{2, 0, \(-2\)}, 
          Flatten[{0. , img1, 0. }]];\)\)], "Input"],

Cell[BoxData[
    \(\(m = Table[0. , {d1}];\)\)], "Input"],

Cell[BoxData[
    \(\(ClippedImage = 
        Function[{imgf, x}, imgf[Clip[x + m, {1, d1}]]];\)\)], "Input"],

Cell[BoxData[
    \(\(\(ListInterpolation\)\([\)\(Thread[\(\(img2\)\(+\)\), 
        InterpolationOrder \[Rule] 1]\)\)\)], "Input"],

Cell[BoxData[
    \(\(\[Lambda] = 2  Max[Abs[fx\^2]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(nei = Table[2. , {d1}];\)\), "\n", 
    \(\(nei[\([{1, \(-1\)}]\)] = 1;\)\), "\[IndentingNewLine]", 
    \(sp = 
      SparseArray[
        Join[\[IndentingNewLine]Table[{i, i}, {i, 
                d1}], \[IndentingNewLine]Table[{i, i + 1}, {i, 
                d1 - 1}], \[IndentingNewLine]Table[{i, i - 1}, {i, 2, 
                d1}]\[IndentingNewLine]] \[Rule] 
          Join[fx\^2 - nei\ \[Lambda], 
            Table[\[Lambda], {2 \((d1 - 1)\)}]], {d1, d1}]\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"SparseArray", "[", 
        RowBox[{
          InterpretationBox[\("<"\[InvisibleSpace]10\[InvisibleSpace]">"\),
            SequenceForm[ "<", 10, ">"],
            Editable->False], ",", \({4, 4}\)}], "]"}],
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(MatrixForm[sp]\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {\(-400.`\), "800.`", "0", "0"},
            {"800.`", \(-1600.`\), "800.`", "0"},
            {"0", "800.`", \(-1200.`\), "800.`"},
            {"0", "0", "800.`", \(-800.`\)}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ 
          SparseArray[ 
          Automatic, {4, 4}, 0, {1, {{0, 2, 5, 8, 10}, {{1}, {2}, {2}, {3}, {
            1}, {3}, {4}, {2}, {4}, {3}}}, {-400.0, 800.0, -1600.0, 800.0, 
            800.0, -1200.0, 800.0, 800.0, -800.0, 800.0}}]]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(sp[\([#, #]\)] &\) /@ Range[d1]\)], "Input"],

Cell[BoxData[
    \({\(-400.`\), \(-1600.`\), \(-1200.`\), \(-800.`\)}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ArrayPlot[sp]\)], "Input"],

Cell[BoxData[{
    \(\(m = Table[0. , {d1}];\)\), "\n", 
    \(Do[\[IndentingNewLine]ftfx = \((img1 - 
              ClippedImage[img2f, Range[d1]])\) fx; \[IndentingNewLine]m += 
        LinearSolve[sp, ftfx]; \[IndentingNewLine]DisplayTogether[
        ListPlot[img1, PlotJoined \[Rule] True], 
        ListPlot[ClippedImage[img2f, Range[d1]], 
          PlotStyle \[Rule] Thickness[ .01], PlotJoined \[Rule] True], 
        DisplayFunction \[Rule] ani];, \[IndentingNewLine]{3}]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\((img1 - ClippedImage[img2f, Range[d1]])\) // Abs\) // 
      Max\)], "Input"],

Cell[BoxData[
    \(1.`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(m\)], "Input"],

Cell[BoxData[
    \({1.5`, 0.75`, 0.`, 0.`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(DisplayTogether[ListPlot[img1, PlotJoined \[Rule] True], 
      ListPlot[{Range[d1] - m, img2}\[Transpose] , 
        PlotStyle \[Rule] Thickness[ .01], PlotJoined \[Rule] True], 
      DisplayFunction \[Rule] ani]\)], "Input"],

Cell[BoxData[
    \(ListPlot[Most[m] - Rest[m]]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["2D Translation", "Subsection"],

Cell[BoxData[
    \(\(pts = 
        Transpose@Flatten[Outer[List, Range[d1], Range[d2]], 1];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(img1 = 
        Table[\((6.5\^2 - \((x\^2 + y\^2)\))\) \((Sign[
                  6.5\^2 - \((x\^2 + y\^2)\)] + 1)\), {x, \(-10\), 
            10}, {y, \(-10\), 10}];\)\), "\[IndentingNewLine]", 
    \(\(img2 = 
        Table[\((6.5\^2 - \((x\^2 + y\^2)\))\) \((Sign[
                  6.5\^2 - \((x\^2 + y\^2)\)] + 1)\), {x, \(-7\), 
            13}, {y, \(-7\), 13}];\)\), "\[IndentingNewLine]", 
    \({d1, d2} = Dimensions[img1]\)}], "Input"],

Cell[BoxData[
    \({21, 21}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[img2]\)], "Input"],

Cell[BoxData[{
    \(\(m = {0, 0};\)\), "\[IndentingNewLine]", 
    \(d1 = 10; d2 = 15;\), "\[IndentingNewLine]", 
    \(\(img1 = \(img2 = 
          Table[0. , {d1}, {d2}]\);\)\), "\[IndentingNewLine]", 
    \(\(img1[\([5, 5]\)] = 1. ;\)\), "\[IndentingNewLine]", 
    \(\(img2[\([5, 6]\)] = 1. ;\)\)}], "Input"],

Cell[BoxData[{
    \(\(img1f = 
        ListInterpolation[img1, 
          InterpolationOrder \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]\(DensityPlot[#, {x, 1, 
              d1}, {y, 1, d2}, PlotPoints \[Rule] 4 {d1, d2}, 
            DisplayFunction \[Rule] ani, PlotRange \[Rule] {0, 2  Max[img1]}, 
            AspectRatio \[Rule] Automatic] &\) /@ {img1f[x, y], img2f[x, y], 
          img1f[x, y] + img2f[x, y]}\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(\(ClippedImage = 
        Function[{img, x, y}, 
          img[Clip[x + m[\([1]\)], {1, d1}], 
            Clip[y + m[\([2]\)], {1, d2}]]];\)\)], "Input"],

Cell[BoxData[{
    RowBox[{
      RowBox[{"fy", "=", 
        RowBox[{"ListConvolve", "[", 
          RowBox[{
            RowBox[{"N", "@", 
              RowBox[{"(", GridBox[{
                    {"0", "0", "0"},
                    {"2", "0", \(-2\)},
                    {"0", "0", "0"}
                    }], ")"}]}], ",", \(MirrorBC@img1\)}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"fx", "=", 
        RowBox[{"ListConvolve", "[", 
          RowBox[{
            RowBox[{"N", "@", 
              RowBox[{"(", GridBox[{
                    {"0", "2", "0"},
                    {"0", "0", "0"},
                    {"0", \(-2\), "0"}
                    }], ")"}]}], ",", \(MirrorBC@img1\)}], "]"}]}], 
      ";"}]}], "Input"],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]ListDensityPlot /@ {fx, 
          fy}\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(\(ft = 
        Function[{x, y}, 
          img1[\([x, y]\)] - ClippedImage[img2f, x, y]];\)\)], "Input"],

Cell[BoxData[{\(k[x_, y_] := ft[x, y]\), "\n", 
    RowBox[{\(c[x_, y_]\), ":=", 
      RowBox[{"(", GridBox[{
            {\(fx[\([x, y]\)]\)},
            {\(fy[\([x, y]\)]\)}
            }], ")"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(cc = 
        Sum[\[IndentingNewLine]c[x, 
              y] . \((c[x, y]\[Transpose] )\), \[IndentingNewLine]{x, 1, 
            d1}, {y, 1, d2}];\)\), "\[IndentingNewLine]", 
    \(MatrixForm[cc]\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"295364.`", "0.`"},
            {"0.`", "295364.`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(ListDensityPlot[img1];\)\), "\[IndentingNewLine]", 
    \(\(m = {0, 0};\)\), "\[IndentingNewLine]", 
    \(errors = 
      Table[\[IndentingNewLine]ck = 
          Sum[c[x, y] k[x, y], {x, d1}, {y, d2}]; \[IndentingNewLine]m += 
            Flatten@LinearSolve[cc, Flatten@ck] // 
          N; \[IndentingNewLine]DensityPlot[
          img1f[x, y] + ClippedImage[img2f, x, y], {x, 1, d1}, {y, 1, d2}, 
          PlotPoints \[Rule] 4 {d1, d2}, DisplayFunction \[Rule] ani, 
          PlotRange \[Rule] {0, 2  Max[img1]}, 
          AspectRatio \[Rule] 
            Automatic]; \[IndentingNewLine]Sum[\((img1[\([x, y]\)] - \
ClippedImage[img2f, x, y])\)\^2, {x, d1}, {y, 
            d2}], \[IndentingNewLine]{25}]\)}], "Input"],

Cell[BoxData[
    \({198769.45581344384`, 151731.86709763273`, 108495.05476234427`, 
      72369.91938700763`, 47770.4986151251`, 29948.997990349206`, 
      17544.558819386777`, 10230.473992602745`, 5931.328345190038`, 
      3419.3066787249713`, 1961.2019438508128`, 1120.0937129271786`, 
      637.5038501347153`, 361.8417881166754`, 204.9385140725915`, 
      115.88026929709358`, 65.44019040835714`, 36.91984905034149`, 
      20.814060725017704`, 11.727698573200255`, 6.605214304209911`, 
      3.7189811563667474`, 2.093427302042791`, 1.1781869621388625`, 
      0.6629980348660043`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Plot3D[
        img1f[x, y] - ClippedImage[img2f, x, y], {x, 1, d1}, {y, 1, d2}, 
        PlotPoints \[Rule] 4 {d1, d2}, DisplayFunction \[Rule] ani, 
        PlotRange \[Rule] All];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(DisplayTogether[\[IndentingNewLine]ListPlot[errors, 
          PlotJoined \[Rule] True, 
          PlotStyle \[Rule] Hue[0]], \[IndentingNewLine]ListPlot[error1, 
          PlotJoined \[Rule] True]];\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(ListPlot::"list"\), \(\(:\)\(\ \)\), "\<\"List expected at \
position \\!\\(1\\) in \\!\\(ListPlot[\\(\\(error1, \\(\\(PlotJoined \[Rule] \
True\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::list\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Show::"gcomb"\), \(\(:\)\(\ \)\), "\<\"An error was encountered \
in combining the graphics objects in \\!\\(Show[\\(\\(\\(\\({\\*TagBox[\\(\
\[SkeletonIndicator] Graphics \[SkeletonIndicator]\\), False, Rule[Editable, \
False]], \\(\\(ListPlot[\\(\\(error1, \\(\\(PlotJoined \[Rule] \
True\\)\\)\\)\\)]\\)\\)}\\)\\), \\(\\(DisplayFunction \[RuleDelayed] \
$DisplayFunction\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Show::gcomb\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(error1 = errors\)], "Input"],

Cell[BoxData[
    \({9.409492609305863`, 7.555442305032631`, 6.14188223926284`, 
      5.013912312783819`, 4.089530678876197`, 3.323050980183737`, 
      2.6862337795750575`, 2.1590289681456447`, 1.7253270857109784`, 
      1.3711875605745065`, 1.0842029073145452`, 0.8533229655600167`, 
      0.6688217900019473`, 0.5222746819326216`, 0.4065024689380986`, 
      0.3154795097147737`, 0.24421612857149883`, 0.18862878796628527`, 
      0.14540924963887814`, 0.1119006204400957`, 0.08598499321191475`, 
      0.06598488883480039`, 0.05057895389295049`, 0.03873126271412358`, 
      0.02963295704102872`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["2D Spatially Varying Translation", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(imgs = \(Import["\</home/abergman/Images/motility tiff/01 Printed \
Grad Test -Phase.tif\>"]\)[\([{1, 2}]\)];\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(imgs\\)\\\" is similar to existing symbol \\\
\"\\!\\(img\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[{
    \(\(img1 = imgs[\([1, 1, 1]\)];\)\), "\[IndentingNewLine]", 
    \(\(img2 = imgs[\([2, 1, 1]\)];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \({d1, d2} = Dimensions[img1]\)], "Input"],

Cell[BoxData[
    \({512, 512}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(img1 = 
        Table[\((6.5\^2 - \((x\^2 + y\^2)\))\) \((Sign[
                  6.5\^2 - \((x\^2 + y\^2)\)] + 1)\), {x, \(-20\), 
            20}, {y, \(-20\), 20}];\)\), "\[IndentingNewLine]", 
    \(\(img2 = 
        Table[\((6.5\^2 - \((x\^2 + y\^2)\))\) \((Sign[
                  6.5\^2 - \((x\^2 + y\^2)\)] + 1)\), {x, \(-22\), 
            18}, {y, \(-22\), 18}];\)\), "\[IndentingNewLine]", 
    \({d1, d2} = Dimensions[img1]\)}], "Input"],

Cell[BoxData[
    \({41, 41}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    RowBox[{
      RowBox[{"img1", "=", 
        RowBox[{"(", GridBox[{
              {"0", "0", "0"},
              {"0", "100", "0"},
              {"0", "0", "0"}
              }], ")"}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"img2", "=", 
        RowBox[{"(", GridBox[{
              {"0", "0", "0"},
              {"0", "0", "0"},
              {"0", "100", "0"}
              }], ")"}]}], ";"}], "\[IndentingNewLine]", \({d1, d2} = 
      Dimensions[img1]\)}], "Input"],

Cell[BoxData[
    \({3, 3}\)], "Output"],

Cell[BoxData[
    \(9\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(pts = 
        Transpose@Flatten[Outer[List, Range[d1], Range[d2]], 1];\)\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[img2 + img1]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(dd = d1\ d2\), "\[IndentingNewLine]", 
    \(\(img1f = 
        ListInterpolation[img1, 
          InterpolationOrder \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(\(img2f = 
        ListInterpolation[img2, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \(1681\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    RowBox[{
      RowBox[{"fx", "=", 
        RowBox[{"Flatten", "@", 
          RowBox[{"ListConvolve", "[", 
            RowBox[{
              RowBox[{"N", "@", 
                RowBox[{"(", GridBox[{
                      {"0", "2", "0"},
                      {"0", "0", "0"},
                      {"0", \(-2\), "0"}
                      }], ")"}]}], ",", \(MirrorBC@img1\)}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"fy", "=", 
        RowBox[{"Flatten", "@", 
          RowBox[{"ListConvolve", "[", 
            RowBox[{
              RowBox[{"N", "@", 
                RowBox[{"(", GridBox[{
                      {"0", "0", "0"},
                      {"2", "0", \(-2\)},
                      {"0", "0", "0"}
                      }], ")"}]}], ",", \(MirrorBC@img1\)}], "]"}]}]}], 
      ";"}], "\[IndentingNewLine]", \(fxfy = fx\ fy;\)}], "Input"],

Cell[BoxData[
    \(MatrixForm[fx]\)], "Input"],

Cell[BoxData[{
    \(\(NablaPos = 
        Function[
          offset, \[IndentingNewLine]\[IndentingNewLine]r = 
            Range[dd] + offset; \[IndentingNewLine]n = 
            Delete[r, Thread[{Range[d2, dd, d2]}]]; \[IndentingNewLine]rp = 
            Range[dd - d1] + offset; \[IndentingNewLine]rm = 
            Range[d1 + 1, dd] + 
              offset; \[IndentingNewLine]Join[\[IndentingNewLine]{r, 
                r}\[Transpose] , \[IndentingNewLine]{n, 
                n + 1}\[Transpose] , {n + 1, 
                n}\[Transpose] , \[IndentingNewLine]{rp, 
                rp + d1}\[Transpose] , {rm, 
                rm - d1}\[Transpose] \
\[IndentingNewLine]]\[IndentingNewLine]];\)\), "\[IndentingNewLine]", 
    \(\(NablaPos[0];\)\)}], "Input"],

Cell[BoxData[{
    \(\(nei = Table[4. , {dd}];\)\), "\n", 
    \(\(nei[\([Range[d2 + 1, dd - d2, d2]]\)] = 3. ;\)\), "\n", 
    \(\(nei[\([Range[2  d2, dd - d2, d2]]\)] = 3. ;\)\), "\n", 
    \(\(nei[\([Range[2, d2 - 1]]\)] = 3. ;\)\), "\n", 
    \(\(nei[\([Range[dd - d2 + 2, dd - 1]]\)] = 3. ;\)\), "\n", 
    \(\(nei[\([{1, d2, dd - d2 + 1, dd}]\)] = 2. ;\)\)}], "Input"],

Cell[BoxData[
    \(Partition[nei, d2] // MatrixForm\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Max[Max[fx\^2], Max[fy\^2]]\)], "Input"],

Cell[BoxData[
    \(6400.`\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(\[Lambda] = Max[Max[fx\^2], Max[fy\^2]];\)\), "\[IndentingNewLine]", 
    \(\(sp = 
        SparseArray[\[IndentingNewLine]Join[\[IndentingNewLine]NablaPos[
                0], \[IndentingNewLine]NablaPos[
                dd], \[IndentingNewLine]{Range[dd], 
                  Range[dd] + dd}\[Transpose] , {Range[dd] + dd, 
                  Range[dd]}\[Transpose] \[IndentingNewLine]] \[Rule] 
            Join[\[IndentingNewLine]fx\^2 - 
                nei\ \[Lambda], \[IndentingNewLine]Table[\[Lambda], {2 \((dd \
- d1)\) + 2 \((dd - d1)\)}], \[IndentingNewLine]fy\^2 - 
                nei\ \[Lambda], \[IndentingNewLine]Table[\[Lambda], {2 \((dd \
- d1)\) + 2 \((dd - d1)\)}], fxfy, fxfy\[IndentingNewLine]], {2  dd, 
            2  dd}];\)\)}], "Input"],

Cell[BoxData[
    \(ArrayPlot[sp, ImageSize \[Rule] $IMAGESIZE]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(sp[\([#, #]\)] &\) /@ Range[dd] // Min\)], "Input"],

Cell[BoxData[
    \(\(-25600.`\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(fx =. ; fy =. ; m1 =. ; m2 =. ; ft =. ;\), "\[IndentingNewLine]", 
    \(Solve[{\[IndentingNewLine]m1\ fx\^2 + m2\ A \[Equal] 
          fx\ ft, \[IndentingNewLine]m2\ fy\^2 + m1\ A \[Equal] 
          fy\ ft\[IndentingNewLine]}, {m1, m2}]\)}], "Input"],

Cell[BoxData[
    \({{m1 \[Rule] \(ft\ fy\)\/\(A + fx\ fy\), 
        m2 \[Rule] \(ft\ fx\)\/\(A + fx\ fy\)}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \({\[IndentingNewLine]m1\ fx\^2 + m2\ fx\ fy \[Equal] 
            fx\ ft, \[IndentingNewLine]m2\ fy\^2 + m1\ fx\ fy \[Equal] 
            fy\ ft\[IndentingNewLine]} /. {m1 -> \(\(ft\)\(\ \)\)\/\(\(2\)  \
\(fx\)\(\ \)\), m2 -> \(\(ft\)\(\ \)\)\/\(2\ fy\)} // Simplify\)], "Input"],

Cell[BoxData[
    \({True, True}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(m1 = \(m2 = Table[0. , {dd}]\);\)\), "\n", 
    \(\(l = {};\)\), "\n", 
    \(Do[\[IndentingNewLine]ft = \((Flatten[img1] - 
            img2f[Clip[pts[\([1]\)] + m1, {1, d1}], 
              Clip[pts[\([2]\)] + m2, {1, 
                  d2}]])\); \[IndentingNewLine]\[IndentingNewLine]AppendTo[l, 
        Norm[ft]]; \[IndentingNewLine]b = 
        Flatten[{ft\ fx, ft\ fy}]; \[IndentingNewLine]sol = 
        LinearSolve[sp, b, 
          Method \[Rule] {"\<Krylov\>", 
              Method \[Rule] "\<ConjugateGradient\>", 
              Preconditioner \[Rule] ILU}]; \[IndentingNewLine]m1 += 
        Take[sol, dd]; \[IndentingNewLine]m2 += 
        Take[sol, \(-dd\)]; \[IndentingNewLine]img2f[
            Clip[pts[\([1]\)] + m1, {1, d1}], 
            Clip[pts[\([2]\)] + m2, {1, d2}]]~Partition~d2 // 
        ListDensityPlot\[IndentingNewLine], {2}]\)}], "Input"],

Cell[BoxData[
    \(ListPlot[l]\)], "Input"],

Cell[BoxData[
    \(ListPlotVectorField[Partition[{\(-m2\), m1}\[Transpose] , d2], 
      ImageSize \[Rule] $IMAGESIZE]\)], "Input"],

Cell[BoxData[
    \(<< Graphics`PlotField`\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[
      Partition[Norm /@ \(({\(-m2\), m1}\[Transpose] )\), d2]]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["2D Spatially Varying Point Translation", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(img1 = 
        Table[\((6.5\^2 - \((x\^2 + y\^2)\))\) \((Sign[
                  6.5\^2 - \((x\^2 + y\^2)\)] + 1)\), {x, \(-20\), 
            20}, {y, \(-20\), 20}];\)\), "\[IndentingNewLine]", 
    \({d1, d2} = Dimensions[img1]\)}], "Input"],

Cell[BoxData[
    \({41, 41}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[img1]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(dd = d1\ d2\), "\[IndentingNewLine]", 
    \(\(img1f = 
        ListInterpolation[img1, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \(1681\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    RowBox[{
      RowBox[{"fx", "=", 
        RowBox[{"ListConvolve", "[", 
          RowBox[{
            RowBox[{"N", "@", 
              RowBox[{"(", GridBox[{
                    {"0", "2", "0"},
                    {"0", "0", "0"},
                    {"0", \(-2\), "0"}
                    }], ")"}]}], ",", \(MirrorBC@img1\)}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"fy", "=", 
        RowBox[{"ListConvolve", "[", 
          RowBox[{
            RowBox[{"N", "@", 
              RowBox[{"(", GridBox[{
                    {"0", "0", "0"},
                    {"2", "0", \(-2\)},
                    {"0", "0", "0"}
                    }], ")"}]}], ",", \(MirrorBC@img1\)}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(fxfy = 
        fx\ fy;\), "\[IndentingNewLine]", \(fxi = 
      ListInterpolation[fx, 
        InterpolationOrder \[Rule] 1]\), "\[IndentingNewLine]", \(fyi = 
      ListInterpolation[fy, InterpolationOrder \[Rule] 1]\)}], "Input"],

Cell[BoxData[
    TagBox[\(InterpolatingFunction[{{1.`, 41.`}, {1.`, 41.`}}, "<>"]\),
      False,
      Editable->False]], "Output"],

Cell[BoxData[
    TagBox[\(InterpolatingFunction[{{1.`, 41.`}, {1.`, 41.`}}, "<>"]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(u = 20; v = 20;\), "\[IndentingNewLine]", 
    \(\(fxi[u, v]\^2\) u + fx[u, v] fy[u, v]\)}], "Input"],

Cell[BoxData[{
    \(\(m1 = \(m2 = Table[0. , {dd}]\);\)\), "\n", 
    \(\(l = {};\)\), "\n", 
    \(Do[\[IndentingNewLine]ft = \((Flatten[img1] - 
            img2f[Clip[pts[\([1]\)] + m1, {1, d1}], 
              Clip[pts[\([2]\)] + m2, {1, 
                  d2}]])\); \[IndentingNewLine]\[IndentingNewLine]AppendTo[l, 
        Norm[ft]]; \[IndentingNewLine]b = 
        Flatten[{ft\ fx, ft\ fy}]; \[IndentingNewLine]sol = 
        LinearSolve[sp, b, 
          Method \[Rule] {"\<Krylov\>", 
              Method \[Rule] "\<ConjugateGradient\>", 
              Preconditioner \[Rule] ILU}]; \[IndentingNewLine]m1 += 
        Take[sol, dd]; \[IndentingNewLine]m2 += 
        Take[sol, \(-dd\)]; \[IndentingNewLine]img2f[
            Clip[pts[\([1]\)] + m1, {1, d1}], 
            Clip[pts[\([2]\)] + m2, {1, d2}]]~Partition~d2 // 
        ListDensityPlot\[IndentingNewLine], {2}]\)}], "Input"],

Cell[BoxData[
    \(ListPlot[l]\)], "Input"],

Cell[BoxData[
    \(ListPlotVectorField[Partition[{\(-m2\), m1}\[Transpose] , d2], 
      ImageSize \[Rule] $IMAGESIZE]\)], "Input"],

Cell[BoxData[
    \(<< Graphics`PlotField`\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[
      Partition[Norm /@ \(({\(-m2\), m1}\[Transpose] )\), d2]]\)], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Affine", "Subsection"],

Cell[BoxData[
    \(k[x_, y_] := 
      ft[\([x, y]\)] + x\ fx[\([x, y]\)] + y\ fy[\([x, y]\)]\)], "Input"],

Cell[BoxData[
    RowBox[{\(c[x_, y_]\), ":=", 
      RowBox[{"(", GridBox[{
            {\(x\ fx[\([x, y]\)]\)},
            {\(y\ fx[\([x, y]\)]\)},
            {\(x\ fy[\([x, y]\)]\)},
            {\(y\ fy[\([x, y]\)]\)},
            {\(fx[\([x, y]\)]\)},
            {\(fy[\([x, y]\)]\)}
            }], ")"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Image Pyramids", "Subsection"],

Cell["Odd rows/cols will be dropped from the partition", "Text"],

Cell[BoxData[
    \(\(MeanPyramid = 
        Function[
          img, \[IndentingNewLine]Map[Mean@\(Flatten@#\) &, 
            Partition[img, {3, 3}], {2}]\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(ListDensityPlot[MeanPyramid@\(MeanPyramid@\(MeanPyramid@#\)\), 
          DisplayFunction \[Rule] ani] &\) /@ {img1, img2}\)], "Input"],

Cell[BoxData[
    \({Null, Null}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(1200/16\)], "Input"],

Cell[BoxData[
    \(75\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"g", "=", 
      RowBox[{\(N@1/4\), " ", \(1/4\), " ", 
        RowBox[{
          RowBox[{"(", GridBox[{
                {"1"},
                {"2"},
                {"1"}
                }], ")"}], ".", 
          RowBox[{"(", GridBox[{
                {"1", "2", "1"}
                }], ")"}]}]}]}]], "Input"],

Cell[BoxData[
    \({{0.0625`, 0.125`, 0.0625`}, {0.125`, 0.25`, 0.125`}, {0.0625`, 0.125`, 
        0.0625`}}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(GausPyramid = 
        Function[img, 
          Map[Plus @@ Flatten[g\ #] &, 
            Partition[img, {3, 3}], {2}]];\)\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[GausPyramid@GausPyramid[img1]]\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[MeanPyramid@MeanPyramid[img1]]\)], "Input"]
}, Closed]]
},
FrontEndVersion->"5.2 for X",
ScreenRectangle->{{0, 1280}, {0, 1024}},
WindowSize->{744, 947},
WindowMargins->{{-3, Automatic}, {23, Automatic}},
Magnification->1
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 39, 1, 27, "Input"],
Cell[1796, 54, 87, 1, 27, "Input"],
Cell[1886, 57, 140, 2, 43, "Input"],
Cell[2029, 61, 118, 2, 43, "Input"],
Cell[2150, 65, 116, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[2291, 71, 33, 0, 38, "Subsection"],

Cell[CellGroupData[{
Cell[2349, 75, 35, 0, 28, "Subsubsection"],
Cell[2387, 77, 341, 7, 74, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[2765, 89, 38, 0, 28, "Subsubsection"],

Cell[CellGroupData[{
Cell[2828, 93, 515, 10, 122, "Input"],
Cell[3346, 105, 125, 3, 26, "Output"]
}, Open  ]],
Cell[3486, 111, 148, 2, 58, "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[3683, 119, 36, 0, 30, "Subsection"],
Cell[3722, 121, 109, 2, 26, "Input"],
Cell[3834, 125, 361, 6, 90, "Input"],

Cell[CellGroupData[{
Cell[4220, 135, 102, 2, 26, "Input"],
Cell[4325, 139, 101, 2, 26, "Output"]
}, Open  ]],
Cell[4441, 144, 208, 3, 74, "Input"],
Cell[4652, 149, 59, 1, 26, "Input"],

Cell[CellGroupData[{
Cell[4736, 154, 51, 1, 30, "Input"],
Cell[4790, 157, 38, 1, 26, "Output"]
}, Open  ]],
Cell[4843, 161, 402, 7, 138, "Input"],
Cell[5248, 170, 236, 4, 74, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[5521, 179, 53, 0, 30, "Subsection"],
Cell[5577, 181, 109, 2, 26, "Input"],

Cell[CellGroupData[{
Cell[5711, 187, 358, 6, 90, "Input"],
Cell[6072, 195, 356, 5, 32, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[6465, 205, 92, 1, 26, "Input"],
Cell[6560, 208, 101, 2, 26, "Output"]
}, Open  ]],
Cell[6676, 213, 208, 3, 74, "Input"],
Cell[6887, 218, 59, 1, 26, "Input"],

Cell[CellGroupData[{
Cell[6971, 223, 51, 1, 30, "Input"],
Cell[7025, 226, 38, 1, 26, "Output"]
}, Open  ]],
Cell[7078, 230, 402, 7, 138, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[7517, 242, 54, 0, 30, "Subsection"],
Cell[7574, 244, 381, 9, 84, "Input"],
Cell[7958, 255, 273, 5, 75, "Input"],
Cell[8234, 262, 80, 1, 27, "Input"],
Cell[8317, 265, 120, 3, 27, "Input"],
Cell[8440, 270, 58, 1, 27, "Input"],
Cell[8501, 273, 109, 2, 27, "Input"],
Cell[8613, 277, 131, 2, 27, "Input"],
Cell[8747, 281, 68, 1, 31, "Input"],

Cell[CellGroupData[{
Cell[8840, 286, 503, 10, 131, "Input"],
Cell[9346, 298, 298, 8, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9681, 311, 47, 1, 27, "Input"],
Cell[9731, 314, 687, 16, 81, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10455, 335, 66, 1, 27, "Input"],
Cell[10524, 338, 84, 1, 27, "Output"]
}, Open  ]],
Cell[10623, 342, 46, 1, 27, "Input"],
Cell[10672, 345, 495, 8, 139, "Input"],

Cell[CellGroupData[{
Cell[11192, 357, 101, 2, 27, "Input"],
Cell[11296, 361, 37, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[11370, 367, 34, 1, 27, "Input"],
Cell[11407, 370, 57, 1, 27, "Output"]
}, Open  ]],
Cell[11479, 374, 247, 4, 59, "Input"],
Cell[11729, 380, 60, 1, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[11826, 386, 36, 0, 30, "Subsection"],
Cell[11865, 388, 108, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[11998, 394, 470, 9, 68, "Input"],
Cell[12471, 405, 42, 1, 27, "Output"]
}, Open  ]],
Cell[12528, 409, 54, 1, 27, "Input"],
Cell[12585, 412, 313, 6, 91, "Input"],
Cell[12901, 420, 230, 5, 43, "Input"],
Cell[13134, 427, 374, 5, 59, "Input"],
Cell[13511, 434, 174, 4, 27, "Input"],
Cell[13688, 440, 767, 22, 123, "Input"],
Cell[14458, 464, 131, 2, 59, "Input"],
Cell[14592, 468, 125, 3, 27, "Input"],
Cell[14720, 473, 213, 5, 63, "Input"],

Cell[CellGroupData[{
Cell[14958, 482, 233, 5, 75, "Input"],
Cell[15194, 489, 336, 10, 45, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[15567, 504, 749, 14, 150, "Input"],
Cell[16319, 520, 604, 9, 43, "Output"]
}, Open  ]],
Cell[16938, 532, 219, 4, 27, "Input"],

Cell[CellGroupData[{
Cell[17182, 540, 236, 4, 59, "Input"],
Cell[17421, 546, 353, 5, 20, "Message"],
Cell[17777, 553, 580, 8, 20, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[18394, 566, 48, 1, 27, "Input"],
Cell[18445, 569, 616, 9, 43, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[19110, 584, 54, 0, 30, "Subsection"],

Cell[CellGroupData[{
Cell[19189, 588, 146, 2, 59, "Input"],
Cell[19338, 592, 355, 5, 33, "Message"]
}, Open  ]],
Cell[19708, 600, 131, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[19864, 606, 60, 1, 27, "Input"],
Cell[19927, 609, 44, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20008, 615, 472, 9, 68, "Input"],
Cell[20483, 626, 42, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20562, 632, 512, 15, 143, "Input"],
Cell[21077, 649, 40, 1, 27, "Output"],
Cell[21120, 652, 35, 1, 27, "Output"]
}, Open  ]],
Cell[21170, 656, 108, 2, 27, "Input"],
Cell[21281, 660, 61, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[21367, 665, 275, 6, 59, "Input"],
Cell[21645, 673, 38, 1, 27, "Output"]
}, Open  ]],
Cell[21698, 677, 912, 24, 143, "Input"],
Cell[22613, 703, 47, 1, 27, "Input"],
Cell[22663, 706, 764, 15, 219, "Input"],
Cell[23430, 723, 374, 6, 107, "Input"],
Cell[23807, 731, 65, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[23897, 736, 60, 1, 31, "Input"],
Cell[23960, 739, 40, 1, 27, "Output"]
}, Open  ]],
Cell[24015, 743, 785, 13, 221, "Input"],
Cell[24803, 758, 76, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[24904, 763, 73, 1, 27, "Input"],
Cell[24980, 766, 46, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[25063, 772, 274, 4, 101, "Input"],
Cell[25340, 778, 123, 2, 47, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[25500, 785, 298, 4, 103, "Input"],
Cell[25801, 791, 46, 1, 27, "Output"]
}, Open  ]],
Cell[25862, 795, 896, 17, 235, "Input"],
Cell[26761, 814, 44, 1, 27, "Input"],
Cell[26808, 817, 132, 2, 27, "Input"],
Cell[26943, 821, 55, 1, 27, "Input"],
Cell[27001, 824, 112, 2, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[27150, 831, 60, 0, 30, "Subsection"],

Cell[CellGroupData[{
Cell[27235, 835, 267, 5, 48, "Input"],
Cell[27505, 842, 42, 1, 27, "Output"]
}, Open  ]],
Cell[27562, 846, 54, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[27641, 851, 155, 3, 43, "Input"],
Cell[27799, 856, 38, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[27874, 862, 1014, 26, 175, "Input"],
Cell[28891, 890, 133, 3, 27, "Output"],
Cell[29027, 895, 133, 3, 27, "Output"]
}, Open  ]],
Cell[29175, 901, 122, 2, 45, "Input"],
Cell[29300, 905, 896, 17, 235, "Input"],
Cell[30199, 924, 44, 1, 27, "Input"],
Cell[30246, 927, 132, 2, 27, "Input"],
Cell[30381, 931, 55, 1, 27, "Input"],
Cell[30439, 934, 112, 2, 27, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[30588, 941, 28, 0, 38, "Subsection"],
Cell[30619, 943, 107, 2, 26, "Input"],
Cell[30729, 947, 326, 9, 116, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[31092, 961, 36, 0, 30, "Subsection"],
Cell[31131, 963, 64, 0, 32, "Text"],
Cell[31198, 965, 192, 4, 58, "Input"],

Cell[CellGroupData[{
Cell[31415, 973, 157, 2, 42, "Input"],
Cell[31575, 977, 46, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[31658, 983, 40, 1, 26, "Input"],
Cell[31701, 986, 36, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[31774, 992, 340, 11, 62, "Input"],
Cell[32117, 1005, 124, 2, 26, "Output"]
}, Open  ]],
Cell[32256, 1010, 157, 4, 42, "Input"],
Cell[32416, 1016, 79, 1, 26, "Input"],
Cell[32498, 1019, 79, 1, 26, "Input"]
}, Closed]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

