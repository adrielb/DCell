(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[    203211,       5495]*)
(*NotebookOutlinePosition[    203890,       5519]*)
(*  CellTagsIndexPosition[    203846,       5515]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["Init", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Get[Environment["\<ALT_DISP\>"]]\), "\[IndentingNewLine]", 
    \(\($IMAGESIZE = 650;\)\), "\[IndentingNewLine]", 
    \(SetDirectory[Environment["\<PETSC_TMP\>"]]\), "\[IndentingNewLine]", 
    \(Get["\</home/abergman/Research/DCell/PetscImport.m\>"]\)}], "Input",
  InitializationCell->True],

Cell[BoxData[
    \("/data/scratch"\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(imp[file_] := 
        Transpose@
          Partition[Import[file <> "\<.Real64\>", "\<Real64\>"], 
            d1];\)\), "\n", 
    \(\(imp[file_, index_] := 
        imp[file <> "\<.\>" <> ToString@index];\)\), "\n", 
    \(\(\(imp[file_, end_, step_] := \(imp[file, #] &\) /@ 
          Range[0, end, step];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(impNode[index_] := 
        Partition[
          Import["\<irregNode.\>" <> 
              ToString[index] <> "\<.Real64\>", "\<Real64\>"], 
          24];\)\)}], "Input",
  InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["FMM ani", "Section"],

Cell[BoxData[
    \(FileNames["\<fmm.*.Real64\>"]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 64;\)\), "\[IndentingNewLine]", 
    \(\(fmm1 = ImportVec2t[d1, 1, "\<fmm.1\>"];\)\), "\[IndentingNewLine]", 
    \(\(fmm2 = ImportVec2t[d1, 1, "\<fmm.-1\>"];\)\), "\[IndentingNewLine]", 
    \(\(ls = ImportVec2t[d1, 1, "\<ls\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions /@ {fmm1, fmm2, ls}\)}], "Input"],

Cell[BoxData[
    \({{632, 64, 64}, {416, 64, 64}, {1, 64, 64}}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(g = \(DisplayTogether[
              ListDensityPlot[#, PlotRange \[Rule] {All, All, {\(-5\), 5}}], 
              g] &\) /@ Join[Take[fmm1, {1, \(-1\), 10}], 
            Take[fmm2, {1, \(-1\), 10}]];\)\), "\[IndentingNewLine]", 
    \(\(\(Export["\<fmm/a.\>" <> ToString[# + 1000] <> "\<.png\>", 
            g[\([#]\)]] &\) /@ Range[Length[g]];\)\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Narrow Band", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 64;\)\), "\[IndentingNewLine]", 
    \(\(ls = ImportVec2t[d1, 1, "\<ls\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[ls]\)}], "Input"],

Cell[BoxData[
    \({1, 64, 64}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(f = \(ListInterpolation[#, {{1, Length[#]}, {1, 
                    Length[#[\([1]\)]]}} - 0.5, 
              InterpolationOrder \[Rule] 1] &\)[ls[\([1]\)]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(g = 
      DisplayTogether[\[IndentingNewLine]ListDensityPlot[ls[\([1]\)], 
          PlotRange \[Rule] {All, 
              All, {\(-5\), 5}}], \[IndentingNewLine]ContourPlot[
          f[x, y], {x, 0.5`, 63.5`}, {y, 0.5`, 63.5`}, Contours \[Rule] {0}, 
          ContourStyle \[Rule] {Red, Thickness[ .01]}, 
          ContourShading \[Rule] None, 
          PlotPoints \[Rule] 100], \[IndentingNewLine]ContourPlot[
          f[x, y], {x, 0.5`, 63.5`}, {y, 0.5`, 63.5`}, 
          Contours \[Rule] {\(-5\), 5}, 
          ContourStyle \[Rule] {Blue, Thickness[ .01]}, 
          ContourShading \[Rule] None, PlotPoints \[Rule] 100]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\<narrowband.png\>", g]\)], "Input"],

Cell[BoxData[
    \("narrowband.png"\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["fmm2d - SingleFMM", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"grid.10000.Real64", "grid.10000.Real64.info", 
      "grid.irregNode.10000.array", "grid.irregNode.10000.array.info", 
      "grid.pos", "grid.size", "lost+found"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(ImportIrreg["\<grid.irregNode.10000.array\>"];\)\), "\
\[IndentingNewLine]", 
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([1]\)]];\)\), "\[IndentingNewLine]", 
    \(Dimensions[phi]\)}], "Input"],

Cell[BoxData[
    \({1, 273, 273}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ListDensityPlot[phi[\([1]\)], ImageSize \[Rule] 6000, 
        Epilog \[Rule] {Green, 
            PointSize[0.001], \(Point[# - pos[\([1]\)] + 0.5] &\) /@ 
              ir`X}];\)\)], "Input"],

Cell[BoxData[
    \(\(ListContourPlot[phi[\([1]\)], Contours \[Rule] Range[\(-2\), 2, 0.5], 
        ImageSize \[Rule] 3000];\)\)], "Input"],

Cell[BoxData[{
    \(\(txt = Import["\</tmp/out\>", "\<Text\>"];\)\), "\n", 
    \(\(pts = 
        ToExpression@\(StringCases[
              txt, \[IndentingNewLine]RegularExpression["\<(?s)aaa(.*?),bbb\>\
"] -> "\<{$1}\>"]\)[\([1]\)];\)\), "\n", 
    \(Dimensions[pts]\)}], "Input"],

Cell[BoxData[{
    \(\(d =  .2;\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[\({Random[Real, {\(-d\), d}], 
                Random[Real, {\(-d\), d}]} + # &\) /@ pts, 
        PlotStyle \[Rule] PointSize[0.005], 
        AspectRatio \[Rule] 1];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot[pts, PlotJoined \[Rule] True]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ListPlot[pts[\([All, 1]\)], PlotJoined \[Rule] True];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\@0.5\)], "Input"],

Cell[BoxData[
    \(0.7071067811865476`\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    RowBox[{
      RowBox[{"phi", "=", 
        RowBox[{"(", GridBox[{
              {"0", "10", "0"},
              {"10", "0", "0.97"},
              {"0", "0", "0"}
              }], ")"}]}], 
      ";"}], "\[IndentingNewLine]", \(Dmx = 
        t - phi[\([1, 2]\)];\), "\[IndentingNewLine]", \(Dpx = 
        phi[\([3, 2]\)] - t;\), "\[IndentingNewLine]", \(Dmy = 
        t - phi[\([2, 1]\)];\), "\[IndentingNewLine]", 
    RowBox[{\(Dpy = phi[\([2, 3]\)] - t;\), 
      "\[IndentingNewLine]"}], "\[IndentingNewLine]", \(equ = 
      Max[Dmx, 0]\^2 + Min[Dpy, 0]\^2 + Min[Dpx, 0]\^2 + 
          Max[Dmy, 0]\^2 \[Equal] 1\), "\[IndentingNewLine]", \(Solve[
      equ]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Plot[equ[\([1]\)] // Evaluate, {t, 0, 1}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    RowBox[{
      RowBox[{"phi", "=", 
        RowBox[{"(", GridBox[{
              {"\[Placeholder]", "10", "\[Placeholder]"},
              {"10", "0.97", "0.7071067811865476`"},
              {"\[Placeholder]", "0", "\[Placeholder]"}
              }], ")"}]}], 
      ";"}], "\[IndentingNewLine]", \(Dmx = 
        phi[\([2, 2]\)] - phi[\([1, 2]\)];\), "\[IndentingNewLine]", \(Dpx = 
        phi[\([3, 2]\)] - 
          phi[\([\)\(2, 2\)\(]\)];\), "\[IndentingNewLine]", \(Dmy = 
        phi[\([\)\(2, 2\)\(]\)] - phi[\([2, 1]\)];\), "\[IndentingNewLine]", 
    RowBox[{\(Dpy = phi[\([2, 3]\)] - phi[\([\)\(2, 2\)\(]\)];\), 
      "\[IndentingNewLine]"}], "\[IndentingNewLine]", \(\@\(Max[Dmx, 0]\^2 + 
          Min[Dpx, 0]\^2 + Max[Dmy, 0]\^2 + Min[Dpy, 0]\^2\)\)}], "Input"],

Cell[BoxData[
    \(1.0049939524684204`\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["fmm2d - FMM vs Size", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(txt = Import["\</tmp/out\>", "\<Text\>"];\)\), "\n", 
    \(\(txt = \(StringCases[txt, 
            RegularExpression["\<(?s)({.*}),\>"] -> "\<{$1}\>"]\)[\([1]\)];\)\
\), "\[IndentingNewLine]", 
    \(\(dat = ToExpression[txt] // Transpose;\)\), "\[IndentingNewLine]", 
    \(\(narrowbandsize = dat[\([\(-2\)]\)];\)\), "\[IndentingNewLine]", 
    \(\(timing = dat[\([\(-1\)]\)];\)\), "\[IndentingNewLine]", 
    \(Dimensions[dat]\)}], "Input"],

Cell[BoxData[
    \({5, 1056}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(dat[\([3, \(-1\)]\)]\)], "Input"],

Cell[BoxData[
    \(4831204\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(fit = 
      Fit[{narrowbandsize, timing}\[Transpose] , {1, x, x\ Log[x]}, 
        x]\)], "Input"],

Cell[BoxData[
    \(\(\(0.0022310419723611803`\)\(\[InvisibleSpace]\)\) - 
      2.3774074687624096`*^-6\ x + 
      2.8032084305480647`*^-7\ x\ Log[x]\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\($TextStyle = {FontSize \[Rule] 20, FontFamily \[Rule] Arial, 
          FontWeight \[Rule] Bold};\)\), "\[IndentingNewLine]", 
    \(\(g = 
        Plot[fit, {x, narrowbandsize[\([1]\)], narrowbandsize[\([\(-1\)]\)]}, 
          PlotStyle \[Rule] {Green, Thickness[0.03]}, 
          Epilog \[Rule] 
            MapThread[
              Point[{#1, #2}] &, {narrowbandsize, timing}]];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\<FMM-timings.png\>", g]\)], "Input"],

Cell[BoxData[
    \("FMM-timings.png"\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ListPlot[{dat[\([\(-2\)]\)], 
            dat[\([\(-1\)]\)]}\[Transpose] ];\)\)], "Input"],

Cell[BoxData[
    \(\(ListPlot[{dat[\([1]\)], 
            dat[\([4]\)]/dat[\([3]\)]}\[Transpose] ];\)\)], "Input"],

Cell[BoxData[
    \(Exit[]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["2D FMM", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"FMM-err.10000.Real64", "FMM-err.10000.Real64.info", 
      "FMM-err.irregNode.10000.array", "FMM-err.irregNode.10000.array.info", 
      "FMM-err.pos", "FMM-err.size", ".rocks-release"}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(ImportIrreg["\<irregNode.10000.array\>"]\), "\[IndentingNewLine]", 
    \(\({tmp, pos} = ImportGrid["\<tmp\>"];\)\), "\[IndentingNewLine]", 
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(\(pos = pos[\([1]\)];\)\), "\[IndentingNewLine]", 
    \(\({ir`X} = \(Transpose[#\[Transpose]  - pos + 
                0.5] &\) /@ {ir`X};\)\), "\[IndentingNewLine]", 
    \(Dimensions[phi]\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\n", 
    \(\(ListDensityPlot[Sign@phi[\([1]\)], ImageSize \[Rule] 1000, 
        Epilog \[Rule] {Red, PointSize[0.01], Point /@ ir`X}];\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[tmp[\([1]\)], Epilog \[Rule] {Green, Point /@ ir`X}, 
        PlotRange \[Rule] {0.5, 1.5}];\)\)}], "Input"],

Cell[BoxData[
    \(\(Xs = 
        Array[\[IndentingNewLine]Function[
            ti, \[IndentingNewLine]ImportIrreg["\<irregNode.\>" <> 
                ToString[
                  10000 + ti] <> "\<.array\>"]; \[IndentingNewLine]Transpose[
              ir`X\[Transpose]  - pos + 0.5]\[IndentingNewLine]], 
          99];\)\)], "Input"],

Cell[BoxData[
    \(\(\(ListDensityPlot[phi[\([#]\)], 
            Epilog \[Rule] {Point /@ Xs[\([#]\)]}, Mesh \[Rule] True, 
            ImageSize \[Rule] 1000] &\) /@ Range[99];\)\)], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(\(ListPlot[Xs[\([1]\)], PlotStyle \[Rule] PointSize[0.01], 
            Epilog \[Rule] {Red, Point /@ #}, 
            AspectRatio \[Rule] Automatic] &\) /@ Xs;\)\)}], "Input"],

Cell[BoxData[{
    \(\(ListPlot[tmp[\([1, 22]\)]];\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[\(tmp[\([1, #, #]\)] &\) /@ Range[Length[tmp[\([1]\)]]], 
        PlotRange \[Rule] { .9, 1.1}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(ListPlot[phi[\([1, 22]\)]];\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[\(phi[\([1, #, #]\)] &\) /@ 
          Range[Length[tmp[\([1]\)]]]];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Select[Flatten[phi], Abs[#] < 0.001 &]\)], "Input"],

Cell[BoxData[
    \({0.`, 0.`, 1.7763568394002568`*^-14, 
      1.7763568394002568`*^-14}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ops = ir`idx + ir`shift/2. ;\)\), "\n", 
    \(\(p = 
        Function[p, 
          Pick[ops, \(# \[Equal] p &\) /@ 
              ir`shift]];\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[ops, AspectRatio \[Rule] 1, 
        Epilog \[Rule] {Red, Point /@ p[{0, 0}], Green, 
            Point /@ p[{0, \(-1\)}], Blue, 
            Point /@ p[{\(-1\), 0}]}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[Sign@phi[\([2]\)], 
        PlotRange \[Rule] Append[Transpose[{{11, 111}, {16, 114}}], All], 
        Mesh \[Rule] True, 
        Epilog \[Rule] {Red, \(Point[#] &\) /@ ir`X, 
            PointSize[0.005]}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(p = 
        Function[p, 
          Transpose[
            Pick[p, Total /@ ir`shift, 0]\[Transpose]  + 
              0.5]];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[Sign@phi[\([2]\)], 
        PlotRange \[Rule] Append[Transpose[{{11, 111}, {16, 114}}], All], 
        Mesh \[Rule] True, 
        Epilog \[Rule] {Red, \(Point[#] &\) /@ p[ir`X], PointSize[0.005], 
            Green, \(Point[#] &\) /@ p[ir`idx], 
            Blue, \(Line[{#1, #2}] &\)~
              MapThread~{p[ir`X], p[ir`idx]}}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListDensityPlot[phi[\([1]\)]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([2]\)], 
        Epilog \[Rule] {Blue, PointSize[0.001], Point /@ ir`X}, 
        ImageSize \[Rule] 3000];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(pts = {11.3629, 112.228};\)\), "\[IndentingNewLine]", 
    \(\(m = 1;\)\), "\[IndentingNewLine]", 
    \(\[Phi] = \(Function[
          pts, \[IndentingNewLine]Module[{p = 
                Reverse@Round[pts]}, \[IndentingNewLine]Take[
              phi[\([2]\)], {p[\([1]\)] - m, 
                p[\([1]\)] + m}, {p[\([2]\)] - m, 
                p[\([2]\)] + m}]\[IndentingNewLine]]]\)[
        pts]\), "\[IndentingNewLine]", 
    \(MatrixForm[\[Phi]]\), "\[IndentingNewLine]", 
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[\[Phi], 
        PlotRange \[Rule] {\(-7.5\), 7.5}];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[Sign@phi[\([1]\)], Mesh \[Rule] True, 
        Epilog \[Rule] {Blue, PointSize[0.01], Point /@ ir`X}, 
        PlotRange \[Rule] {{\(-m\) - 1, m} + pts[\([1]\)], {\(-m\) - 1, m} + 
              pts[\([2]\)], All}];\)\)}], "Input"],

Cell[BoxData[
    \({{3.005012587959042`, 2.0050251510569823`, 1.0050377772082644`}, {3.`, 
        2.`, 1.`}, {3.005012587959042`, 2.0050251510569823`, 
        1.0050377772082644`}}\)], "Output"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"3.005012587959042`", "2.0050251510569823`", 
              "1.0050377772082644`"},
            {"3.`", "2.`", "1.`"},
            {"3.005012587959042`", "2.0050251510569823`", 
              "1.0050377772082644`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(rng = Transpose[{{11, 110}, {16, 114}}];\)\), "\n", 
    \(\(box = 
        Function[x, 
          rng[\([1, 1]\)] < x[\([1]\)] < rng[\([1, 2]\)] && 
            rng[\([2, 1]\)] < x[\([2]\)] < rng[\([2, 2]\)]];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(dat = 
        Pick[{ir`idx, \(\@Total[#\^2] &\) /@ ir`op}\[Transpose] , 
          Thread[Map[box, Transpose[ir`idx\[Transpose] ]] && 
              Thread[Equal[Total /@ ir`shift, 
                  0]]]];\)\), "\[IndentingNewLine]", 
    \(MatrixForm[dat]\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {\({13, 111}\), "0.004999698984651196`"},
            {\({13, 111}\), "0.004999698984651196`"},
            {\({14, 111}\), "0.994949218114147`"},
            {\({12, 112}\), "0.`"},
            {\({13, 112}\), "0.`"},
            {\({13, 112}\), "0.`"},
            {\({13, 112}\), "0.`"},
            {\({13, 112}\), "0.`"},
            {\({14, 112}\), "0.9960937499999948`"},
            {\({13, 113}\), "0.00499970096713639`"},
            {\({13, 113}\), "0.00499970096713639`"},
            {\({14, 113}\), "0.9949492284181584`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(phi[\([1, 13, 112]\)]\)], "Input"],

Cell[BoxData[
    \(0.0019998000399899882`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[phi[\([2]\)]]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[
        Take[phi[\([2]\)], 110 + {2, 4}, {2, 4} + 10]];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Take[phi[\([1]\)], 110 + {2, 4}, {2, 4} + 10] // MatrixForm\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.2004901842999675`", "0.10049503737316792`", 
              "0.0004999875006249576`"},
            {"0.1999999999999993`", "0.09999999999999964`", "0.`"},
            {"0.20049018429996754`", "0.10049503737316794`", 
              "0.000499987500624975`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    RowBox[{"(", "\[NoBreak]", GridBox[{
          {"0.2004901842999675`", "0.10049503737316792`", 
            "0.0004999875006249576`"},
          {"0.1999999999999993`", "0.09999999999999964`", "0.`"},
          {"0.20049018429996754`", "0.10049503737316794`", 
            "0.000499987500624975`"}
          },
        RowSpacings->1,
        ColumnSpacings->1,
        ColumnAlignments->{Left}], "\[NoBreak]", ")"}]], "Input"],

Cell[BoxData[
    \({{0.2004901842999675`, 0.10049503737316792`, 
        0.0004999875006249576`}, {0.1999999999999993`, 0.09999999999999964`, 
        0.`}, {0.20049018429996754`, 0.10049503737316794`, 
        0.000499987500624975`}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Show@Graphics[\(Text[#2, #1] &\)~MapThread~Transpose@dat]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[op, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {PointSize[0.02], 
          MapThread[{RGBColor[#1, 0, 0], Point[#2]} &, {\@Rescale[Abs@k], 
              op}]}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Length /@ {ir, irX, irY}\)], "Input"],

Cell[BoxData[
    \({100, 96, 96}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[ir, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {Red, Point /@ irX, Blue, Point /@ irY}]\)], "Input"],

Cell[BoxData[
    \(ListPlot[op, AspectRatio \[Rule] 1, 
      PlotRange \[Rule] {4 {\(-1\), 1} + 45, 4 {\(-1\), 1} + 32}, 
      Epilog \[Rule] {PointSize[ .01], 
          MapThread[Line[List[##]] &, {ir, op}], \[IndentingNewLine]Red, 
          Point /@ ir, Blue, Point /@ op}]\)], "Input"],

Cell[BoxData[
    \(Epilog \[Rule] {Red, \(Point[# + 1] &\) /@ op}\)], "Input"],

Cell[BoxData[
    \(ListContourPlot[ls, Contours \[Rule] {0}, ImageSize \[Rule] 1600, 
      Epilog \[Rule] {PointSize[ .005], 
          MapThread[
            Line[List[##]] &, {ir + 1, 
              op + 1}], \[IndentingNewLine]Red, \(Point[# + 1] &\) /@ ir, 
          Blue, \(Point[# + 1] &\) /@ op}]\)], "Input"],

Cell[BoxData[
    \(ListPlot[op, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {MapThread[
            Line[List[##]] &, {ir, op}], \[IndentingNewLine]MapThread[
            Line[List[##]] &, {irX, opX}], \[IndentingNewLine]MapThread[
            Line[List[##]] &, {irY, opY}], Red, Point /@ opX, Blue, 
          Point /@ opY}]\)], "Input"],

Cell[BoxData[
    \(ListPlot[opX, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {MapThread[Line[List[##]] &, {irX, opX}], Red, 
          Point /@ opX}]\)], "Input"],

Cell[BoxData[
    \(MapThread[Line[List[##]] &, {ir, op}]\)], "Input"],

Cell[BoxData[
    \(ListPlot[
      Join[\(# + 2 { .5, 0} &\) /@ op10, \(# + 2 {0,  .5} &\) /@ op01], 
      AspectRatio \[Rule] 1, Epilog \[Rule] {Red, Point /@ op}]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["3D FMM", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"band.10000.array", "phi.10000.Real64", "phi.10000.Real64.info", 
      "phi.irregNode.10000.array", "phi.irregNode.10000.array.info", 
      "phi.pos", "phi.size"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(sizes\  = \ Import["\<phi.size\>", "\<Table\>"];\)\), "\n", 
    \(\(s = sizes[\([1]\)];\)\), "\n", 
    \(\(phi = 
        Rest@Import["\<phi.10000.Real64\>", "\<Real64\>", 
            ByteOrdering \[Rule] 1];\)\), "\n", 
    \(\(phi = Partition[phi, s[\([2]\)]*s[\([3]\)]];\)\), "\n", 
    \(\(phi = \(Partition[#, s[\([1]\)]] &\) /@ phi;\)\), "\n", 
    \(Dimensions[phi]\), "\[IndentingNewLine]", 
    \(Quantile[Flatten@phi, {0, 1}]\)}], "Input"],

Cell[BoxData[
    \({31, 37, 31}\)], "Output"],

Cell[BoxData[
    \({\(-0.9999999999999992`\), 7.5`}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListDensityPlot[#, PlotRange \[Rule] {\(-1.5\), 1.5}] &\) /@ 
        phi;\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListContourPlot[#, Contours \[Rule] {0}, 
            ContourShading \[Rule] None] &\) /@ phi;\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListPlot3D[#, PlotRange \[Rule] {All, All, {\(-1.5\), 1.5}}] &\) /@ 
        phi;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListDensityPlot[ls[\([26]\)], PlotRange \[Rule] All, 
      Epilog \[Rule] {Green, \(Point[ .5 + #] &\) /@ \(Select[
                ir, #[\([1]\)] \[Equal] 25 &]\)[\([All, {2, 
                  3}]\)]}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(TableForm[ls[\([All, 26]\)] /. \ _?\((# > 500 &)\) \[Rule] 0, 
      TableHeadings \[Rule] Automatic]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot3D[ls[\([25]\)], PlotRange \[Rule] {\(-10\), 10}, 
      ClipFill \[Rule] None, BoxRatios \[Rule] {1, 1,  .1}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  SurfaceGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(pos = Position[ls, _?\((\(-1.1\) < # < 1.1 &)\)];\)\), "\n", 
    \(Graphics3D[Point /@ pos] // Show\)}], "Input"],

Cell[BoxData[
    \(<< Graphics`Graphics3D`\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(dx = 0.5;\)\), "\[IndentingNewLine]", 
    \(ImportIrreg3D["\<phi.irregNode.10000.array\>"]\), \
"\[IndentingNewLine]", 
    \(\(ir`X = dx*ir`X;\)\), "\[IndentingNewLine]", 
    \(Length[ir`X]\)}], "Input"],

Cell[BoxData[
    \(314\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(color = Rescale[\(Norm[{1, \(-1\), 1} - #] &\) /@ ir`X];\)\), "\n", 
    \(\(g = 
        Show[Graphics3D[{PointSize[0.05], 
              MapThread[{GrayLevel[#1], Point[#2]} &, 
                Take[{color, ir`X}\[Transpose] , {1, \(-1\), 
                      1}]\[Transpose] ]}], Axes \[Rule] True, 
          ImageSize \[Rule] 800, Background \[Rule] Blue];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(r = Total /@ \(ir`X\^2\);\)\), "\[IndentingNewLine]", 
    \(\(Histogram[r];\)\), "\[IndentingNewLine]", 
    \(Quantile[r, {0, 1}]\)}], "Input"],

Cell[BoxData[
    \({0.9167172756490094`, 1.0154172663360166`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(<< Graphics`Animation`\)], "Input"],

Cell[BoxData[
    \(SpinShow[g]\)], "Input"],

Cell[BoxData[
    \(\(ScatterPlot3D[ir`X];\)\)], "Input"],

Cell[BoxData[
    \(\(ListPlot[ir`X, AspectRatio \[Rule] 1];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Length[ir`X]\)], "Input"],

Cell[BoxData[
    \(25970\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(band = 
        BinaryReadList["\<band.10000.array\>", {"\<Integer32\>", "\<Integer32\
\>", "\<Integer32\>"}, 
          ByteOrdering \[Rule] \(-1\)];\)\), "\[IndentingNewLine]", 
    \(Dimensions[band]\), "\[IndentingNewLine]", 
    \(\(b = 
        Select[band, #[\([3]\)] \[Equal] 0 &];\)\), "\[IndentingNewLine]", 
    \(Dimensions[b]\), "\[IndentingNewLine]", 
    \(\(ListPlot[b[\([All, {1, 2}]\)], AspectRatio \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \({79054, 3}\)], "Output"],

Cell[BoxData[
    \({1888, 3}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(dx = 0.1;\)\), "\[IndentingNewLine]", 
    \(ImportIrreg["\<phi.irregNode.10000.array\>"]\), "\[IndentingNewLine]", 
    \(\(ir`X = dx*ir`X;\)\), "\[IndentingNewLine]", 
    \(Length[ir`X]\), "\[IndentingNewLine]", 
    \(\(ListPlot[ir`X, AspectRatio \[Rule] Automatic];\)\)}], "Input"],

Cell[BoxData[
    \(128\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(box = 
        Function[
          o, \[IndentingNewLine]Join[\[IndentingNewLine]Table[
              Line[{{i, j, 0} + o, {i, j, 1} + o} - 0.5], {i, 0, 1}, {j, 0, 
                1}], \[IndentingNewLine]Table[
              Line[{{i, 0, j} + o, {i, 1, j} + o} - 0.5], {i, 0, 1}, {j, 0, 
                1}], \[IndentingNewLine]Table[
              Line[{{0, i, j} + o, {1, i, j} + o} - 0.5], {i, 0, 1}, {j, 0, 
                1}]\[IndentingNewLine]]];\)\)], "Input"],

Cell[BoxData[
    \(\(Show[
        Graphics3D[{Table[box[{i, j, k}], {i, 0, 1}, {j, 0, 1}, {k, 0, 1}]}], 
        Axes \[Rule] True, 
        PlotRange \[Rule] 
          2.  {{\(-1\), 1}, {\(-1\), 1}, {\(-1\), 1}}];\)\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["FMM-err", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(ImportIrreg["\<FMM-err.irregNode.10000.array\>"]\), "\n", 
    \(\({phi, pos} = ImportGrid["\<FMM-err\>"];\)\), "\n", 
    \(Dimensions[phi]\), "\n", 
    \(\(phi = phi[\([1]\)];\)\), "\[IndentingNewLine]", 
    \(\(pos = pos[\([1]\)];\)\)}], "Input"],

Cell[BoxData[
    \({1, 230, 225}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi, PlotRange \[Rule] All];\)\)}], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[phi, 
        Epilog \[Rule] {Green, 
            PointSize[0.001], \(Point[# - pos + 0.5] &\) /@ ir`X}, 
        PlotRange \[Rule] {All, All, {\(-2\), 2}}, 
        ImageSize \[Rule] 3000];\)\)], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[phi, 
        Epilog \[Rule] {Green, \(Point[# - pos + 0.5] &\) /@ 
              ir`X}];\)\)], "Input"],

Cell[BoxData[
    \(\(Histogram[Flatten[phi], 
        HistogramRange \[Rule] {\(-2\), 2}];\)\)], "Input"],

Cell[BoxData[
    \(\(pts = {};\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(m = 3;\)\), "\[IndentingNewLine]", 
    \(\(X = {510, 9} - pos + 1;\)\), "\[IndentingNewLine]", 
    \(\(mat = 
        Table[phi[\([j + X[\([2]\)], i + X[\([1]\)]]\)], {j, \(-m\), 
            m}, {i, \(-m\), m}];\)\), "\[IndentingNewLine]", 
    \(MatrixForm[mat // Reverse]\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[mat, PlotRange \[Rule] {\(-2\), 2}];\)\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {\(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \
\(-7.5`\), \(-7.5`\)},
            {\(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \
\(-7.5`\), \(-0.06617772914568014`\)},
            {\(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \
\(-0.19300248913891502`\), "0.6172473955901064`"},
            {\(-7.5`\), \(-7.5`\), \(-7.5`\), \(-7.5`\), \
\(-0.9109547285107412`\), "0.07424090122574357`", "7.5`"},
            {\(-0.06570435173018799`\), \(-0.13251168209977635`\), \
\(-0.19487407743039337`\), \(-0.07347765844374816`\), \
\(-0.5094371104270571`\), "0.27371660000080417`", "7.5`"},
            {"0.9324926248189592`", "0.8652008967388776`", 
              "0.8050156132993782`", "0.20811715247666485`", 
              "0.32564988660412464`", "7.5`", "7.5`"},
            {"7.5`", "7.5`", "7.5`", "7.5`", "7.5`", "7.5`", "7.5`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(X = {162, 19};\)\), "\[IndentingNewLine]", 
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi, ImageSize \[Rule] 1000, 
        Epilog \[Rule] {Green, 
            PointSize[0.001], \(Point[# - pos + 0.5] &\) /@ ir`X, Red, 
            PointSize[0.02], Point[X + 0.5], Pink, 
            Point[Reverse@X + 0.5]}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi, 
        Epilog \[Rule] {Green, 
            PointSize[0.004], \(Point[# - pos + 0.5] &\) /@ 
              pts}, \[IndentingNewLine]PlotRange \[Rule] {All, 
            All, {\(-1\), 1}}, ImageSize \[Rule] 1300];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Position[phi, _?\((Abs[# + 6] < 10\^\(-3\) &)\)]\)], "Input"],

Cell[BoxData[
    \({{44, 79}, {48, 107}, {113, 157}, {178, 107}, {182, 79}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(px = {x, 2.02, 1.04};\)\), "\[IndentingNewLine]", 
    \(\(py = {x, 3, 2.12};\)\), "\[IndentingNewLine]", 
    \(\(D2 = {3, \(-4\), 1}/2. ;\)\), "\[IndentingNewLine]", 
    \(Solve[\((px . D2)\)\^2 + \((py . D2)\)\^2 \[Equal] 1]\)}], "Input"],

Cell[BoxData[
    \({{x \[Rule] \(\(2.8200000000000003`\)\(\[InvisibleSpace]\)\) - 
            0.042687494916199005`\ \[ImaginaryI]}, {x \[Rule] \
\(\(2.8200000000000003`\)\(\[InvisibleSpace]\)\) + 
            0.042687494916199005`\ \[ImaginaryI]}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(25.38/9. \)], "Input"],

Cell[BoxData[
    \(2.82`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\((px . D2)\)\^2 + \((py . D2)\)\^2 - 1 // Expand\)], "Input"],

Cell[BoxData[
    \(\(\(35.794`\)\(\[InvisibleSpace]\)\) - 25.38`\ x + 
      4.5`\ x\^2\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Plot[\((px . D2)\)\^2 + \((py . D2)\)\^2 - 1, {x, 2.6, 
          3}];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(px = \(-{\(-x\), \(-0.073\), 0.208}\);\)\), "\[IndentingNewLine]", 
    \(\(py = \(-{\(-x\), \(-0.911\), 0.074}\);\)\), "\[IndentingNewLine]", 
    \(\(D2 = {3, \(-4\), 1}/2. ;\)\), "\[IndentingNewLine]", 
    \(\(D1 = {1, \(-1\), 0};\)\), "\[IndentingNewLine]", 
    \(Solve[\((px . D2)\)\^2 + \((py . D2)\)\^2 \[Equal] 
        1]\), "\[IndentingNewLine]", 
    \(\((px . D2)\)\^2 + \((py . D2)\)\^2 - 1 // Expand\)}], "Input"],

Cell[BoxData[
    \({{x \[Rule] \(\(0.703`\)\(\[InvisibleSpace]\)\) - 
            0.25579527404200075`\ \[ImaginaryI]}, {x \[Rule] \(\(0.703`\)\(\
\[InvisibleSpace]\)\) + 0.25579527404200075`\ \[ImaginaryI]}}\)], "Output"],

Cell[BoxData[
    \(\(\(2.5183809999999998`\)\(\[InvisibleSpace]\)\) - 6.327`\ x + 
      4.5`\ x\^2\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Solve[\((px . D2)\)\^2 \[Equal] 1]\)], "Input"],

Cell[BoxData[
    \({{x \[Rule] \(-0.49999999999999994`\)}, {x \[Rule] 
          0.8333333333333333`}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Solve[\((px . D1)\)\^2 \[Equal] 1]\)], "Input"],

Cell[BoxData[
    \({{x \[Rule] \(-0.9269999999999999`\)}, {x \[Rule] 1.073`}}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(a = 4.5;\)\), "\[IndentingNewLine]", 
    \(\(b = \(-6.33\);\)\), "\[IndentingNewLine]", 
    \(\(c = 2.52;\)\), "\[IndentingNewLine]", 
    \(\(Plot[a*x\^2 + b*x + c, {x, 0, 1.5}, 
        AxesOrigin \[Rule] {0, 0}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Solve[a*x\^2 + b*x + c \[Equal] 0]\)], "Input"],

Cell[BoxData[
    \({{x \[Rule] \(\(0.7033333333333334`\)\(\[InvisibleSpace]\)\) - 
            0.25558212422276766`\ \[ImaginaryI]}, {x \[Rule] \
\(\(0.7033333333333334`\)\(\[InvisibleSpace]\)\) + 
            0.25558212422276766`\ \[ImaginaryI]}}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["3D OrthoProj", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames["\<irreg*\>"]\)], "Input"],

Cell[BoxData[
    \({"irregNode.0.Real64"}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(dat = 
        Import["\<irregNode.0.Real64\>", "\<Real64\>"];\)\), "\
\[IndentingNewLine]", 
    \(\(dat = Partition[dat, 18];\)\)}], "Input"],

Cell[BoxData[{
    \(\(op = dat[\([All, {1, 2, 3}]\)];\)\), "\[IndentingNewLine]", 
    \(\(ir = dat[\([All, {4, 5, 6}]\)];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Length[ir]\)], "Input"],

Cell[BoxData[
    \(2752\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(g = 
      Show[Graphics3D[
          MapThread[{RGBColor[0, #1, 0], Point[#2]} &, {Rescale[Norm /@ ir], 
              ir}]]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(dat[\([1, 10]\)]\)], "Input"],

Cell[BoxData[
    \(1.`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(ddat = 
        Select[dat, #[\([10]\)] \[Equal] 1 &];\)\), "\[IndentingNewLine]", 
    \(\(op = ddat[\([All, {1, 2, 3}]\)];\)\), "\[IndentingNewLine]", 
    \(\(ir = ddat[\([All, {4, 5, 6}]\)];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(ddat\\)\\\" is similar to existing symbol \\\
\"\\!\\(dat\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\
\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Length[ddat]\)], "Input"],

Cell[BoxData[
    \(1550\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(g = 
      Show[Graphics3D[
          MapThread[{PointSize[ .004], Red, Point[#1], Blue, Point[#2], 
                Green, Line[{#1, #2}]} &, {op, ir}]]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(<< Graphics`Animation`\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(SpinShow[g, Frames \[Rule] 127]\)], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(Frames\\)\\\" is similar to existing symbol \
\\\"\\!\\(Frame\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{"SpinShow", "[", 
      RowBox[{
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", \(Frames \[Rule] 127\)}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(ddat = 
        Select[dat, 26.5 > #[\([1]\)] > 25.5 &];\)\), "\[IndentingNewLine]", 
    \(\(op = ddat[\([All, {1, 2, 3}]\)];\)\), "\[IndentingNewLine]", 
    \(\(ir = ddat[\([All, {4, 5, 6}]\)];\)\), "\[IndentingNewLine]", 
    \(ListPlot[op[\([All, {2, 3}]\)], AspectRatio \[Rule] 1]\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AdvectMAC", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(dat = 
        Function[i, 
            Import["\<ls.\>" <> ToString@i <> "\<.Real64\>", "\<Real64\>"] // 
              Partition[#, 1024] &] /@ Range[0, 10];\)\), "\n", 
    \(max = Max[dat]\), "\n", 
    \(min = Min[dat]\)}], "Input"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(max\\)\\\" is similar to existing symbol \
\\\"\\!\\(Max\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \(435.9123688633247`\)], "Output"],

Cell[BoxData[
    RowBox[{\(General::"spell1"\), \(\(:\)\(\ \)\), "\<\"Possible spelling \
error: new symbol name \\\"\\!\\(min\\)\\\" is similar to existing symbol \
\\\"\\!\\(Min\\)\\\". \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::spell1\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \(\(-215.15346687818158`\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(ListContourPlot[#, Contours \[Rule] {\(-10\), 0, 10}, 
          ContourStyle \[Rule] {{Red}, {Black, Thickness[ .0031]}, {Red}}, 
          ImageSize \[Rule] 850, ContourShading \[Rule] None, 
          PlotRange \[Rule] {min, max}, DisplayFunction \[Rule] ani] &\) /@ 
      dat\)], "Input"],

Cell[BoxData[
    \({Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\<img.gif\>", %]\)], "Input"],

Cell[BoxData[
    \("img.gif"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(ListDensityPlot[#, ImageSize \[Rule] 650, 
          PlotRange \[Rule] {min, max}, DisplayFunction \[Rule] ani] &\) /@ 
      dat\)], "Input"],

Cell[BoxData[
    \({Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot3D[\(-dat[\([\(-1\)]\)]\), Mesh \[Rule] False, 
      PlotRange \[Rule] {\(-1\), \(-min\)}, ClipFill \[Rule] None]\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[dat[\([\(-1\)]\)], Mesh \[Rule] False, 
      PlotRange \[Rule] All, ClipFill \[Rule] None]\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[Sign[dat[\([1]\)]]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(\(tot = Count[Sign[dat[\([1]\)]], \(-1\), 2]\)\(\n\)
    \)\), "\[IndentingNewLine]", 
    \(\(Count[Sign[#], \(-1\), 2]\/tot &\) /@ dat // ListPlot\)}], "Input"],

Cell[BoxData[
    \(225445\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Exit[]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extension", "Section"],

Cell[BoxData[{
    \(\(d1 = 1024;\)\), "\n", 
    \(\(Vn = 
        Partition[Import["\<Vn.Real64\>", "\<Real64\>"], 
          d1];\)\), "\[IndentingNewLine]", 
    \(\(z = 
        Partition[Rest@Import["\</tmp/dVn-dPhi.Real64\>", "\<Real64\>"], 
          d1];\)\), "\[IndentingNewLine]", 
    \(\(irreg = impNode[0];\)\)}], "Input"],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]{{ListDensityPlot[Vn, 
            Epilog \[Rule] {ridge, ic}]}, {ListDensityPlot[z, 
            PlotRange \[Rule] All, Epilog \[Rule] {ridge, ic}]}}, 
      ImageSize \[Rule] 600]\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[Vn, PlotRange \[Rule] {\(-2\), 2}]\)], "Input"],

Cell[BoxData[
    \(\(VnOld = Vn;\)\)], "Input"],

Cell[BoxData[
    \(\(ridge = {Red, 
          PointSize[ .02], \(Point[# +  .5] &\) /@ {{16, 9}, {9, 16}, {9, 
                16}, {23, 16}, {23, 16}, {9, 16}, {23, 16}, {16, 9}, {16, 
                9}, {16, 23}, {16, 23}, {16, 23}, {10, 11}, {22, 21}, {10, 
                21}, {22, 11}, {21, 10}, {11, 10}, {11, 22}, {21, 22}, {16, 
                8}, {16, 24}, {8, 16}, {24, 16}, {10, 23}, {22, 9}, {22, 
                23}, {10, 9}, {9, 22}, {9, 10}, {23, 10}, {23, 22}, {16, 
                25}, {16, 7}, {25, 16}, {7, 16}, {6, 16}, {16, 6}, {26, 
                16}, {16, 26}, {16, 27}, {27, 16}, {5, 16}, {16, 5}, {16, 
                28}, {16, 4}, {4, 16}, {28, 16}}};\)\)], "Input"],

Cell[BoxData[
    \(\(ic := {Green, 
          PointSize[ .01], \(Point[# +  .5] &\) /@ 
            irreg[\([All, {1, 2}]\)]};\)\)], "Input"],

Cell[BoxData[
    \(irreg[\([All, {1, 2}]\)] // ListPlot\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[Vn /. \ _?\((Abs[#] <  .00001 &)\) \[Rule] Indeterminate, 
      Mesh \[Rule] False, PlotRange \[Rule] All]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["AdvectVn", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[{
    \(\(\(irreg = \(Function[i, 
            ImportIrreg["\<irregNode.\>" <> 
                ToString[10000 + i] <> "\<.array\>"]]\)[
          1];\)\(\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(ijk = \(("\<ijk\>" /. irreg)\)[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(op = \(("\<op\>" /. irreg)\)[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(nv = \(("\<nv\>" /. irreg)\)[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(vn = \(("\<vn\>" /. irreg)\);\)\), "\n", 
    \(\(DisplayTogetherArray[\(ListPlot[#, 
              AspectRatio \[Rule] 1] &\) /@ {ijk, op}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 64;\)\), "\[IndentingNewLine]", 
    \(\(ls = ImportVec2t[d1, 1, "\<ls\>"];\)\), "\[IndentingNewLine]", 
    \(\(curv = ImportVec2t[d1, 1, "\<curv\>"];\)\), "\[IndentingNewLine]", 
    \(\(Vn = ImportVec2t[d1, 1, "\<Vn\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions /@ {ls, curv, Vn}\)}], "Input"],

Cell[BoxData[
    \({{59, 64, 64}, {59, 64, 64}, {58, 64, 64}}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(g = \(DisplayTogether[
              ListDensityPlot[#, PlotRange \[Rule] {All, All, {\(-5\), 5}}], 
              LSPlot[#]] &\) /@ ls;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(Do\)\([\)\(\[IndentingNewLine]\)\(\(DisplayTogetherArray[\
\[IndentingNewLine]DisplayTogether[
                ListDensityPlot[#, 
                  PlotRange \[Rule] {All, All, {\(-5\), 5}}], 
                LSPlot[#]], \[IndentingNewLine]ListDensityPlot[#2, 
                PlotRange \[Rule] 
                  All], \[IndentingNewLine]ListDensityPlot[#3, 
                PlotRange \[Rule] All], \[IndentingNewLine]ImageSize \[Rule] 
                1200\[IndentingNewLine]] &\)~
          MapThread~\((\(Take[#, {1, \(-1\), 1}] &\) /@ {ls, 
                curv})\);\)\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Function::"slotn"\), \(\(:\)\(\ \)\), "\<\"Slot number \
\\!\\(3\\) in \
\\!\\(\\(\\(DisplayTogetherArray[\\(\\(\\(\\(DisplayTogether[\\(\\(\\(\\(\
ListDensityPlot[\\(\\(#1, \\(\\(PlotRange \[Rule] \\(\\({All, All, \\(\\({\\(\
\\(-5\\)\\), 5}\\)\\)}\\)\\)\\)\\)\\)\\)]\\)\\), \
\\(\\(LSPlot[#1]\\)\\)\\)\\)]\\)\\), \\(\\(ListDensityPlot[\\(\\(#2, \
\\(\\(PlotRange \[Rule] All\\)\\)\\)\\)]\\)\\), \
\\(\\(ListDensityPlot[\\(\\(#3, \\(\\(PlotRange \[Rule] \
All\\)\\)\\)\\)]\\)\\), \\(\\(ImageSize \[Rule] 1200\\)\\)\\)\\)]\\)\\) &\\) \
cannot be filled from \
\\!\\(\\(\\((\\(\\(\\(DisplayTogetherArray[\\(\\(\\(\\(DisplayTogether[\\(\\(\
\\(\\(ListDensityPlot[\\(\\(#1, \\(\\(PlotRange \[Rule] \\(\\({All, All, \
\\(\\({\\(\\(-5\\)\\), 5}\\)\\)}\\)\\)\\)\\)\\)\\)]\\)\\), \
\\(\\(LSPlot[#1]\\)\\)\\)\\)]\\)\\), \\(\\(ListDensityPlot[\\(\\(#2, \
\\(\\(PlotRange \[Rule] All\\)\\)\\)\\)]\\)\\), \
\\(\\(ListDensityPlot[\\(\\(#3, \\(\\(PlotRange \[Rule] \
All\\)\\)\\)\\)]\\)\\), \\(\\(ImageSize \[Rule] 1200\\)\\)\\)\\)]\\)\\) &\\))\
\\)\\)[\\(\\(\\(\\({\\(\\({9.9999999`*^7, \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)\\)\\)]\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Function::slotn\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(DensityGraphics::"gmat"\), \(\(:\)\(\ \)\), "\<\"\\!\\(#3\\) is \
not a rectangular array larger than 2 x 2. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"DensityGraphics::gmat\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Function::"slotn"\), \(\(:\)\(\ \)\), "\<\"Slot number \
\\!\\(3\\) in \
\\!\\(\\(\\(DisplayTogetherArray[\\(\\(\\(\\(DisplayTogether[\\(\\(\\(\\(\
ListDensityPlot[\\(\\(#1, \\(\\(PlotRange \[Rule] \\(\\({All, All, \\(\\({\\(\
\\(-5\\)\\), 5}\\)\\)}\\)\\)\\)\\)\\)\\)]\\)\\), \
\\(\\(LSPlot[#1]\\)\\)\\)\\)]\\)\\), \\(\\(ListDensityPlot[\\(\\(#2, \
\\(\\(PlotRange \[Rule] All\\)\\)\\)\\)]\\)\\), \
\\(\\(ListDensityPlot[\\(\\(#3, \\(\\(PlotRange \[Rule] \
All\\)\\)\\)\\)]\\)\\), \\(\\(ImageSize \[Rule] 1200\\)\\)\\)\\)]\\)\\) &\\) \
cannot be filled from \
\\!\\(\\(\\((\\(\\(\\(DisplayTogetherArray[\\(\\(\\(\\(DisplayTogether[\\(\\(\
\\(\\(ListDensityPlot[\\(\\(#1, \\(\\(PlotRange \[Rule] \\(\\({All, All, \
\\(\\({\\(\\(-5\\)\\), 5}\\)\\)}\\)\\)\\)\\)\\)\\)]\\)\\), \
\\(\\(LSPlot[#1]\\)\\)\\)\\)]\\)\\), \\(\\(ListDensityPlot[\\(\\(#2, \
\\(\\(PlotRange \[Rule] All\\)\\)\\)\\)]\\)\\), \
\\(\\(ListDensityPlot[\\(\\(#3, \\(\\(PlotRange \[Rule] \
All\\)\\)\\)\\)]\\)\\), \\(\\(ImageSize \[Rule] 1200\\)\\)\\)\\)]\\)\\) &\\))\
\\)\\)[\\(\\(\\(\\({\\(\\({9.9999999`*^7, \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)\\)\\)]\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Function::slotn\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(DensityGraphics::"gmat"\), \(\(:\)\(\ \)\), "\<\"\\!\\(#3\\) is \
not a rectangular array larger than 2 x 2. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"DensityGraphics::gmat\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Function::"slotn"\), \(\(:\)\(\ \)\), "\<\"Slot number \
\\!\\(3\\) in \
\\!\\(\\(\\(DisplayTogetherArray[\\(\\(\\(\\(DisplayTogether[\\(\\(\\(\\(\
ListDensityPlot[\\(\\(#1, \\(\\(PlotRange \[Rule] \\(\\({All, All, \\(\\({\\(\
\\(-5\\)\\), 5}\\)\\)}\\)\\)\\)\\)\\)\\)]\\)\\), \
\\(\\(LSPlot[#1]\\)\\)\\)\\)]\\)\\), \\(\\(ListDensityPlot[\\(\\(#2, \
\\(\\(PlotRange \[Rule] All\\)\\)\\)\\)]\\)\\), \
\\(\\(ListDensityPlot[\\(\\(#3, \\(\\(PlotRange \[Rule] \
All\\)\\)\\)\\)]\\)\\), \\(\\(ImageSize \[Rule] 1200\\)\\)\\)\\)]\\)\\) &\\) \
cannot be filled from \
\\!\\(\\(\\((\\(\\(\\(DisplayTogetherArray[\\(\\(\\(\\(DisplayTogether[\\(\\(\
\\(\\(ListDensityPlot[\\(\\(#1, \\(\\(PlotRange \[Rule] \\(\\({All, All, \
\\(\\({\\(\\(-5\\)\\), 5}\\)\\)}\\)\\)\\)\\)\\)\\)]\\)\\), \
\\(\\(LSPlot[#1]\\)\\)\\)\\)]\\)\\), \\(\\(ListDensityPlot[\\(\\(#2, \
\\(\\(PlotRange \[Rule] All\\)\\)\\)\\)]\\)\\), \
\\(\\(ListDensityPlot[\\(\\(#3, \\(\\(PlotRange \[Rule] \
All\\)\\)\\)\\)]\\)\\), \\(\\(ImageSize \[Rule] 1200\\)\\)\\)\\)]\\)\\) &\\))\
\\)\\)[\\(\\(\\(\\({\\(\\({9.9999999`*^7, \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)\\)\\)]\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"Function::slotn\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Function :: \\\"slotn\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(DensityGraphics::"gmat"\), \(\(:\)\(\ \)\), "\<\"\\!\\(#3\\) is \
not a rectangular array larger than 2 x 2. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"DensityGraphics::gmat\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(DensityGraphics :: \\\"gmat\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Dimensions[Take[{ls, curv, Vn}, 1, {1, \(-1\), 50}]]\)], "Input"],

Cell[BoxData[
    \({1, 6, 64, 64}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(Export["\<ls/a.\>" <> ToString[# + 1000] <> "\<.png\>", 
          g[\([#]\)]] &\) /@ Range[Length[g]]\)], "Input"],

Cell[BoxData[
    \({"ls/a.1001.png", "ls/a.1002.png", "ls/a.1003.png", "ls/a.1004.png", 
      "ls/a.1005.png", "ls/a.1006.png", "ls/a.1007.png", "ls/a.1008.png", 
      "ls/a.1009.png", "ls/a.1010.png", "ls/a.1011.png", "ls/a.1012.png", 
      "ls/a.1013.png", "ls/a.1014.png", "ls/a.1015.png", "ls/a.1016.png", 
      "ls/a.1017.png", "ls/a.1018.png", "ls/a.1019.png", "ls/a.1020.png", 
      "ls/a.1021.png", "ls/a.1022.png", "ls/a.1023.png", "ls/a.1024.png", 
      "ls/a.1025.png", "ls/a.1026.png", "ls/a.1027.png", "ls/a.1028.png", 
      "ls/a.1029.png", "ls/a.1030.png", "ls/a.1031.png", "ls/a.1032.png", 
      "ls/a.1033.png", "ls/a.1034.png", "ls/a.1035.png", "ls/a.1036.png", 
      "ls/a.1037.png", "ls/a.1038.png", "ls/a.1039.png", 
      "ls/a.1040.png"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Quantile[Flatten@Vn, {0, 1}]\)], "Input"],

Cell[BoxData[
    \({\(-4.24140396181918`*^10\), 8.20224883259179`}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(DisplayTogetherArray[ListPlot[vn], 
      ListPlot[Rescale[vn, {\(-4.3\), \(-3.8\)}], 
        PlotRange \[Rule] All]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  GraphicsArray  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[ls[\([1]\)], PlotRange \[Rule] {\(-4\), 4}, 
        Epilog \[Rule] 
          MapThread[{RGBColor[#2, 0, 0], Point[#1]} &, {op + 0.5, 
              Rescale[vn, {\(-4.3\), \(-3.8\)}]}], 
        ImageSize \[Rule] 1800];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Graphics::"realu"\), \(\(:\)\(\ \)\), "\<\"Argument in \
\\!\\(RGBColor[\\(\\(1.1333840981441394`, 0, 0\\)\\)]\\) is not a real number \
between 0 and 1. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Graphics::realu\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Graphics::"realu"\), \(\(:\)\(\ \)\), "\<\"Argument in \
\\!\\(RGBColor[\\(\\(1.1333840981441394`, 0, 0\\)\\)]\\) is not a real number \
between 0 and 1. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Graphics::realu\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Graphics::"realu"\), \(\(:\)\(\ \)\), "\<\"Argument in \
\\!\\(RGBColor[\\(\\(1.1333840981443668`, 0, 0\\)\\)]\\) is not a real number \
between 0 and 1. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Graphics::realu\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Graphics :: \\\"realu\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vn", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(rng = Quantile[Flatten[Vn], {0, 1}]\), "\[IndentingNewLine]", 
    \(\(\(ListDensityPlot[#, 
            PlotRange \[Rule] {All, All, {\(-20\), 20}}] &\) /@ 
        Vn;\)\)}], "Input"],

Cell[BoxData[
    \({\(-40.40120861345797`\), 46.001661543975`}\)], "Output"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(dat = Table[0, {128}, {128}, {64}];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\</tmp/dat.dat\>", Flatten@dat, "\<Byte\>"]\)], "Input"],

Cell[BoxData[
    \("/tmp/dat.dat"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Union[Flatten@iVn[\([10]\)]] // ListPlot\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(\(ListDensityPlot[iVn[\([#]\)], DisplayFunction \[Rule] ani, 
            PlotRange \[Rule] {Min[iVn], Max[iVn]}, 
            Epilog \[Rule] {Green, \(Point[# + 0.5] &\) /@ 
                  irreg[\([#, All, {4, 5}]\)]}] &\) /@ idxs;\)\)], "Input"],

Cell[BoxData[
    \(PlotRange \[Rule] {{0, 32} + 160, {0, 32} + 160, All}\)], "Input"],

Cell[BoxData[
    \(\(\(ListContourPlot[#, Contours \[Rule] {0}, 
            ContourShading \[Rule] None, ImageSize \[Rule] 800, 
            ContourStyle \[Rule] Thickness[ .01], 
            DisplayFunction \[Rule] ani] &\) /@ ls;\)\)], "Input"],

Cell[BoxData[
    \(ListContourPlot[ls[\([1]\)], Contours \[Rule] {0}, 
      ContourShading \[Rule] None, DisplayFunction \[Rule] ani]\)], "Input"],

Cell[BoxData[
    \(\(\(ListDensityPlot[#, , DisplayFunction \[Rule] ani] &\) /@ 
        Vn;\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(Count[Flatten@#, _?\((0 < # < 50 &)\)] &\) /@ ls\)], "Input"],

Cell[BoxData[
    \({500, 484, 472, 440, 432, 432, 416, 408, 408, 392, 384, 376, 384, 384, 
      376, 368, 376, 364, 356, 360}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(a = \(Get["\<a.\>" <> ToString@#] &\) /@ Range[0, IDX];\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(Get::"noopen"\), \(\(:\)\(\ \)\), "\<\"Cannot open \
\\!\\(\\\"a.1\\\"\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::noopen\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Get::"noopen"\), \(\(:\)\(\ \)\), "\<\"Cannot open \
\\!\\(\\\"a.2\\\"\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::noopen\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Get::"noopen"\), \(\(:\)\(\ \)\), "\<\"Cannot open \
\\!\\(\\\"a.3\\\"\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::noopen\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Get :: \\\"noopen\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[BoxData[
    \(Length /@ a // ListPlot\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[ls[\([\(-1\)]\)], 
      Epilog \[Rule] {\(Point[# +  .5] &\) /@ a[\([\(-1\)]\)]}]\)], "Input"],

Cell[BoxData[
    \(\(ls[\([\(-1\), #[\([1]\)] + 1, #[\([2]\)] + 1]\)] &\) /@ 
        a[\([\(-1\)]\)] // ListPlot[#, PlotRange \[Rule] All] &\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(z = Table[0. , {d1}, {d1}];\)\), "\[IndentingNewLine]", 
    \(\(\((\(z[\([#[\([1]\)] + 1, #[\([2]\)] + 1]\)]++\) &)\) /@ 
        a[\([\(-1\)]\)];\)\), "\[IndentingNewLine]", 
    \(ListDensityPlot[z, 
      Epilog \[Rule] {Green, \(Point[# + 0.5] &\) /@ 
            irreg[\([\(-1\), All, {4, 5}]\)]}]\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(a \[LeftDoubleBracket] \\(\\(-1\\)\\) \[RightDoubleBracket]\\) is \
longer than depth of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(a \[LeftDoubleBracket] 1 \[RightDoubleBracket]\\) is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(a \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\) is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Part :: \\\"partd\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(1 + \\(\\(a \[LeftDoubleBracket] 1 \[RightDoubleBracket]\\)\\)\\) is \
neither an integer nor a list of integers. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Set::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(1 + \\(\\(a \[LeftDoubleBracket] 1 \[RightDoubleBracket]\\)\\)\\) is \
neither an integer nor a list of integers. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(1 + \\(\\(\\(\\((\\(-1\\))\\)\\) \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\)\\)\\) is neither an integer nor a list of integers. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Set::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(1 + \\(\\(\\(\\((\\(-1\\))\\)\\) \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\)\\)\\) is neither an integer nor a list of integers. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(\\(\\({\\(\\({0.`, 0.`, 0.`, 0.`, 0.`, 0.`, 0.`, 0.`, 0.`, 0.`, \\(\\(\
\[LeftSkeleton] 54 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 54 \
\[RightSkeleton]\\)\\)}\\)\\) \[LeftDoubleBracket] \\(\\(\\(\\(1 + \
\\(\\(\\(\\((\\(-1\\))\\)\\) \[LeftDoubleBracket] 1 \
\[RightDoubleBracket]\\)\\)\\)\\), \\(\\(1 + \\(\\(\\(\\((\\(-1\\))\\)\\) \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\)\\)\\)\\)\\)\\) \
\[RightDoubleBracket]\\) is neither an integer nor a list of integers. \\!\\(\
\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Part :: \\\"pspec\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Union[Flatten[z]]\)], "Input"],

Cell[BoxData[
    \({0.`, 1.`}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(d1 = 64;\)\), "\[IndentingNewLine]", 
    \(\(a = \(Get["\<a.\>" <> ToString@#] &\)[
          0];\)\), "\[IndentingNewLine]", 
    \(\(ls = \(Import["\<ls.0\>" <> "\<.Real64\>", "\<Real64\>"] // 
            Partition[#, d1] &\) // 
          Partition[#, d1] &;\)\), "\[IndentingNewLine]", 
    \(\(Vn = \(Import["\<Vn.1\>" <> "\<.Real64\>", "\<Real64\>"] // 
            Partition[#, d1] &\) // Partition[#, d1] &;\)\)}], "Input"],

Cell[BoxData[
    \(\(irreg = impNode[1];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Max[ls]\), "\[IndentingNewLine]", 
    \(Min[ls]\), "\[IndentingNewLine]", 
    \(Max[Vn]\), "\n", 
    \(Min[Vn]\)}], "Input"],

Cell[BoxData[
    \(9.9999999`*^7\)], "Output"],

Cell[BoxData[
    \(\(-9.9999999`*^7\)\)], "Output"],

Cell[BoxData[
    \(0.007639619702661542`\)], "Output"],

Cell[BoxData[
    \(\(-0.03104945454577978`\)\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Point[#[\([{1, 2}]\)] + 100.5] &\) /@ 
      Select[a, #[\([3]\)] \[Equal] \((I - 1)\) &]\)], "Input"],

Cell[BoxData[
    \(\(Point[#[\([{1, 2}]\)] + 0.5] &\) /@ 
      Select[irreg[\([All, {1, 2, 6}]\)], 
        Abs[#[\([3]\)] - \((I - 1)\)] <  .01 &]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(Function[
        I, \[IndentingNewLine]ListDensityPlot[Vn[\([I]\)], 
          Epilog \[Rule] {Green, \(Point[#[\([{1, 2}]\)] + 0.5] &\) /@ 
                Select[irreg[\([All, {1, 2, 6}]\)], 
                  Abs[#[\([3]\)] - \((I - 1)\)] <  .01 &]}, 
          PlotRange \[Rule] All, DisplayFunction \[Rule] ani]] /@ 
      Range[Round[d1/2] - 5, Round[d1/2] + 5]\)}], "Input"],

Cell[BoxData[
    \({Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Range[Round[d1/2] - 2, Round[d1/2] + 2]\)], "Input"],

Cell[BoxData[
    \({62, 63, 64, 65, 66}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Select[Flatten[ls], Abs[#] < 10 &] // Min\), "\[IndentingNewLine]", 
    \(Select[Flatten[ls], Abs[#] < 10 &] // Max\)}], "Input"],

Cell[BoxData[
    \(\(-3.9860942851741665`\)\)], "Output"],

Cell[BoxData[
    \(3.9886197684264184`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ls[\([#[\([3]\)], #[\([2]\)], #[\([1]\)]]\)] &\) /@ \((a + 1)\) // 
      ListPlot\)], "Input"],

Cell[BoxData[
    \(ListPlot[a[\([All, {1, 2}]\)]]\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[ls[\([128]\)]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Select[Flatten[ls[\([128]\)]], Abs[#] < 10 &] // 
      Min\), "\[IndentingNewLine]", 
    \(Select[Flatten[ls[\([128]\)]], Abs[#] < 10 &] // Max\)}], "Input"],

Cell[BoxData[
    \(\(-3.9698386532489254`\)\)], "Output"],

Cell[BoxData[
    \(3.842077073589848`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot3D[ls[\([128]\)], Mesh \[Rule] False, ClipFill \[Rule] None, 
      PlotRange \[Rule] {\(-3\), 3}]\)], "Input"],

Cell[BoxData[
    \(Show@Graphics3D[Point /@ irreg[\([All, {1, 2, 6}]\)]]\)], "Input"],

Cell[BoxData[{
    \(\(d1 = 64;\)\), "\[IndentingNewLine]", 
    \(\(ls = 
        Function[
            t, \((\(Import["\<ls.\>" <> 
                        ToString[t] <> "\<.Real64\>", "\<Real64\>"] // 
                    Partition[#, d1] &\) // 
                  Partition[#, d1] &)\)[\([32]\)]\[IndentingNewLine]] /@ 
          Range[9];\)\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[#, DisplayFunction \[Rule] ani, 
          PlotRange \[Rule] {\(-5\), 5}] &\) /@ ls\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListContourPlot[#, DisplayFunction \[Rule] ani, Contours \[Rule] {0}, 
          ContourShading \[Rule] None] &\) /@ ls\)}], "Input"],

Cell[BoxData[
    \(\(gtab = \(ListContourPlot[#, DisplayFunction \[Rule] Identity, 
              Contours \[Rule] {0}, ContourShading \[Rule] None] &\) /@ 
          ls;\)\)], "Input"],

Cell[BoxData[
    \(Show[gtab, DisplayFunction \[Rule] ani]\)], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Nei", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"irregNode.10000.array", "ls.10000.Real64", "ls.10000.Real64.info", 
      ".svn"}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(coor = 
        Module[{s, nodeSize = 380, idx, op, 
            coor = {}}, \[IndentingNewLine]s = 
            OpenRead["\<irregNode.10000.array\>", 
              BinaryFormat \[Rule] True]; \[IndentingNewLine]While[
            True, \[IndentingNewLine]idx = 
              BinaryRead[
                s, {"\<Integer32\>", "\<Integer32\>", "\<Integer32\>"}]; \
\[IndentingNewLine]If[idx[\([1]\)] == EndOfFile, 
              Break[]]; \[IndentingNewLine]op = 
              BinaryRead[
                s, {"\<Real64\>", "\<Real64\>", "\<Real64\>"}]; \
\[IndentingNewLine]Skip[s, "\<Byte\>", 
              nodeSize - 3*\((4 + 8)\)]; \[IndentingNewLine]AppendTo[
              coor, {idx, idx + op}]; \[IndentingNewLine]If[
              Length[coor] \[Equal] 1000, 
              Break[]];\[IndentingNewLine]]; \[IndentingNewLine]Close[
            s]; \[IndentingNewLine]coor\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(p = coor[\([1, 1, {1, 2}]\)]\)], "Input"],

Cell[BoxData[
    \({24, 12}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot[coor[\([All, 1, {1, 2}]\)], 
      Epilog \[Rule] {Circle[p,  .7], Blue, 
          Point /@ coor[\([All, 2, {1, 2}]\)], 
          Green, \(Circle[#, 1] &\) /@ {{23, 13}, {25, 13}, {23, 14}, {26, 
                14}, {23, 15}, {27, 15}, {23, 16}, {23, 17}}}, 
      AspectRatio \[Rule] 1]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(MX = 64;\)\), "\[IndentingNewLine]", 
    \(\(ls = ImportVec2[MX, 1, "\<ls.10000.Real64\>"];\)\)}], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[ls, PlotRange \[Rule] {\(-10\), 10}];\)\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Curvature", "Section"],

Cell[CellGroupData[{

Cell["Least Squares", "Subsection"],

Cell[BoxData[{
    \(\(n = 2;\)\), "\[IndentingNewLine]", 
    \(\(XX = 
        Table[{\((i\ dx)\)\^2, \((j\ dy)\)\^2, i\ j\ dx\ dy, i\ dx, j\ dy, 
              1}, {i, \(-n\), n}, {j, \(-n\), n}] // 
          Flatten[#, 1] &;\)\), "\[IndentingNewLine]", 
    \(\(iXX = Inverse[XX\[Transpose]  . XX] . XX\[Transpose] ;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(iXX // Dimensions\)], "Input"],

Cell[BoxData[
    \({6, 25}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(MatrixForm@Partition[#, 2  n + 1] &\) /@ iXX\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(pval = 
        Table[p[\([j + J, i + I]\)], {I, \(-n\), n}, {J, \(-n\), n}] // 
          Flatten;\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(\\(\\(-2\\)\\) + j\\) is neither an integer nor a list of integers. \\!\
\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(\\(\\(-1\\)\\) + j\\) is neither an integer nor a list of integers. \\!\
\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(j\\) is neither an integer nor a list of integers. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Part :: \\\"pspec\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(MatrixForm@Partition[iXX[\([\(-2\)]\)]\ pval, 2  n + 1]\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {\(-\(p\[LeftDoubleBracket]\(-2\) + j, \(-2\) + 
                        i\[RightDoubleBracket]\/\(25\ dy\)\)\), \(-\(p\
\[LeftDoubleBracket]\(-1\) + j, \(-2\) + 
                        i\[RightDoubleBracket]\/\(50\ dy\)\)\), 
              "0", \(p\[LeftDoubleBracket]1 + j, \(-2\) + 
                      i\[RightDoubleBracket]\/\(50\ dy\)\), \(p\
\[LeftDoubleBracket]2 + j, \(-2\) + i\[RightDoubleBracket]\/\(25\ dy\)\)},
            {\(-\(p\[LeftDoubleBracket]\(-2\) + j, \(-1\) + 
                        i\[RightDoubleBracket]\/\(25\ dy\)\)\), \(-\(p\
\[LeftDoubleBracket]\(-1\) + j, \(-1\) + 
                        i\[RightDoubleBracket]\/\(50\ dy\)\)\), 
              "0", \(p\[LeftDoubleBracket]1 + j, \(-1\) + 
                      i\[RightDoubleBracket]\/\(50\ dy\)\), \(p\
\[LeftDoubleBracket]2 + j, \(-1\) + i\[RightDoubleBracket]\/\(25\ dy\)\)},
            {\(-\(p\[LeftDoubleBracket]\(-2\) + j, 
                      i\[RightDoubleBracket]\/\(25\ dy\)\)\), \(-\(p\
\[LeftDoubleBracket]\(-1\) + j, i\[RightDoubleBracket]\/\(50\ dy\)\)\), 
              "0", \(p\[LeftDoubleBracket]1 + j, 
                    i\[RightDoubleBracket]\/\(50\ dy\)\), \(p\
\[LeftDoubleBracket]2 + j, i\[RightDoubleBracket]\/\(25\ dy\)\)},
            {\(-\(p\[LeftDoubleBracket]\(-2\) + j, 
                      1 + i\[RightDoubleBracket]\/\(25\ dy\)\)\), \(-\(p\
\[LeftDoubleBracket]\(-1\) + j, 1 + i\[RightDoubleBracket]\/\(50\ dy\)\)\), 
              "0", \(p\[LeftDoubleBracket]1 + j, 
                    1 + i\[RightDoubleBracket]\/\(50\ dy\)\), \(p\
\[LeftDoubleBracket]2 + j, 1 + i\[RightDoubleBracket]\/\(25\ dy\)\)},
            {\(-\(p\[LeftDoubleBracket]\(-2\) + j, 
                      2 + i\[RightDoubleBracket]\/\(25\ dy\)\)\), \(-\(p\
\[LeftDoubleBracket]\(-1\) + j, 2 + i\[RightDoubleBracket]\/\(50\ dy\)\)\), 
              "0", \(p\[LeftDoubleBracket]1 + j, 
                    2 + i\[RightDoubleBracket]\/\(50\ dy\)\), \(p\
\[LeftDoubleBracket]2 + j, 2 + i\[RightDoubleBracket]\/\(25\ dy\)\)}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(code = \(ToString[CForm@#] &\) /@ \((iXX . 
              pval)\);\)\), "\[IndentingNewLine]", 
    \(\(code = 
        StringReplace[
          code, {"\<dx\>" \[Rule] "\<d.x\>", "\<dy\>" \[Rule] "\<d.y\>", \
"\<Power(dx,2)\>" -> "\<d2.x\>", "\<Power(dy,2)\>" -> "\<d2.y\>"}];\)\), "\
\[IndentingNewLine]", 
    \(\(code = 
        MapThread["\<  \>" <> #1 <> "\< = \>" <> #2 <> "\<;\n\n\>" &, \
{{"\<pxx\>", "\<pyy\>", "\<pxy\>", "\<px\>", "\<py\>", "\<ppp\>"}, 
            code}];\)\), "\[IndentingNewLine]", 
    \(MatrixForm[code]\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", 
        TagBox[GridBox[{
              {\("  pxx = p[-2 + j][-2 + i]/(35.*d2.x) - p[-2 + j][-1 + \
i]/(70.*d2.x) - p[-2 + j][i]/(35.*d2.x) - p[-2 + j][1 + i]/(70.*d2.x) + p[-2 \
+ j][2 + i]/(35.*d2.x) + p[-1 + j][-2 + i]/(35.*d2.x) - p[-1 + j][-1 + \
i]/(70.*d2.x) - p[-1 + j][i]/(35.*d2.x) - p[-1 + j][1 + i]/(70.*d2.x) + p[-1 \
+ j][2 + i]/(35.*d2.x) + p[j][-2 + i]/(35.*d2.x) - p[j][-1 + i]/(70.*d2.x) - \
p[j][i]/(35.*d2.x) - p[j][1 + i]/(70.*d2.x) + p[j][2 + i]/(35.*d2.x) + p[1 + \
j][-2 + i]/(35.*d2.x) - p[1 + j][-1 + i]/(70.*d2.x) - p[1 + j][i]/(35.*d2.x) \
- p[1 + j][1 + i]/(70.*d2.x) + p[1 + j][2 + i]/(35.*d2.x) + p[2 + j][-2 + \
i]/(35.*d2.x) - p[2 + j][-1 + i]/(70.*d2.x) - p[2 + j][i]/(35.*d2.x) - p[2 + \
j][1 + i]/(70.*d2.x) + p[2 + j][2 + i]/(35.*d2.x);\n\n"\)},
              {\("  pyy = p[-2 + j][-2 + i]/(35.*d2.y) + p[-2 + j][-1 + \
i]/(35.*d2.y) + p[-2 + j][i]/(35.*d2.y) + p[-2 + j][1 + i]/(35.*d2.y) + p[-2 \
+ j][2 + i]/(35.*d2.y) - p[-1 + j][-2 + i]/(70.*d2.y) - p[-1 + j][-1 + \
i]/(70.*d2.y) - p[-1 + j][i]/(70.*d2.y) - p[-1 + j][1 + i]/(70.*d2.y) - p[-1 \
+ j][2 + i]/(70.*d2.y) - p[j][-2 + i]/(35.*d2.y) - p[j][-1 + i]/(35.*d2.y) - \
p[j][i]/(35.*d2.y) - p[j][1 + i]/(35.*d2.y) - p[j][2 + i]/(35.*d2.y) - p[1 + \
j][-2 + i]/(70.*d2.y) - p[1 + j][-1 + i]/(70.*d2.y) - p[1 + j][i]/(70.*d2.y) \
- p[1 + j][1 + i]/(70.*d2.y) - p[1 + j][2 + i]/(70.*d2.y) + p[2 + j][-2 + \
i]/(35.*d2.y) + p[2 + j][-1 + i]/(35.*d2.y) + p[2 + j][i]/(35.*d2.y) + p[2 + \
j][1 + i]/(35.*d2.y) + p[2 + j][2 + i]/(35.*d2.y);\n\n"\)},
              {\("  pxy = p[-2 + j][-2 + i]/(25.*d.x*d.y) + p[-2 + j][-1 + \
i]/(50.*d.x*d.y) - p[-2 + j][1 + i]/(50.*d.x*d.y) - p[-2 + j][2 + \
i]/(25.*d.x*d.y) + p[-1 + j][-2 + i]/(50.*d.x*d.y) + p[-1 + j][-1 + \
i]/(100.*d.x*d.y) - p[-1 + j][1 + i]/(100.*d.x*d.y) - p[-1 + j][2 + \
i]/(50.*d.x*d.y) - p[1 + j][-2 + i]/(50.*d.x*d.y) - p[1 + j][-1 + \
i]/(100.*d.x*d.y) + p[1 + j][1 + i]/(100.*d.x*d.y) + p[1 + j][2 + \
i]/(50.*d.x*d.y) - p[2 + j][-2 + i]/(25.*d.x*d.y) - p[2 + j][-1 + \
i]/(50.*d.x*d.y) + p[2 + j][1 + i]/(50.*d.x*d.y) + p[2 + j][2 + \
i]/(25.*d.x*d.y);\n\n"\)},
              {\("  px = -p[-2 + j][-2 + i]/(25.*d.x) - p[-2 + j][-1 + \
i]/(50.*d.x) + p[-2 + j][1 + i]/(50.*d.x) + p[-2 + j][2 + i]/(25.*d.x) - p[-1 \
+ j][-2 + i]/(25.*d.x) - p[-1 + j][-1 + i]/(50.*d.x) + p[-1 + j][1 + \
i]/(50.*d.x) + p[-1 + j][2 + i]/(25.*d.x) - p[j][-2 + i]/(25.*d.x) - p[j][-1 \
+ i]/(50.*d.x) + p[j][1 + i]/(50.*d.x) + p[j][2 + i]/(25.*d.x) - p[1 + j][-2 \
+ i]/(25.*d.x) - p[1 + j][-1 + i]/(50.*d.x) + p[1 + j][1 + i]/(50.*d.x) + p[1 \
+ j][2 + i]/(25.*d.x) - p[2 + j][-2 + i]/(25.*d.x) - p[2 + j][-1 + \
i]/(50.*d.x) + p[2 + j][1 + i]/(50.*d.x) + p[2 + j][2 + i]/(25.*d.x);\n\n\
"\)},
              {\("  py = -p[-2 + j][-2 + i]/(25.*d.y) - p[-2 + j][-1 + \
i]/(25.*d.y) - p[-2 + j][i]/(25.*d.y) - p[-2 + j][1 + i]/(25.*d.y) - p[-2 + \
j][2 + i]/(25.*d.y) - p[-1 + j][-2 + i]/(50.*d.y) - p[-1 + j][-1 + \
i]/(50.*d.y) - p[-1 + j][i]/(50.*d.y) - p[-1 + j][1 + i]/(50.*d.y) - p[-1 + \
j][2 + i]/(50.*d.y) + p[1 + j][-2 + i]/(50.*d.y) + p[1 + j][-1 + i]/(50.*d.y) \
+ p[1 + j][i]/(50.*d.y) + p[1 + j][1 + i]/(50.*d.y) + p[1 + j][2 + \
i]/(50.*d.y) + p[2 + j][-2 + i]/(25.*d.y) + p[2 + j][-1 + i]/(25.*d.y) + p[2 \
+ j][i]/(25.*d.y) + p[2 + j][1 + i]/(25.*d.y) + p[2 + j][2 + i]/(25.*d.y);\n\n\
"\)},
              {\("  ppp = (-13*p[-2 + j][-2 + i])/175. + (2*p[-2 + j][-1 + \
i])/175. + p[-2 + j][i]/25. + (2*p[-2 + j][1 + i])/175. - (13*p[-2 + j][2 + \
i])/175. + (2*p[-1 + j][-2 + i])/175. + (17*p[-1 + j][-1 + i])/175. + \
(22*p[-1 + j][i])/175. + (17*p[-1 + j][1 + i])/175. + (2*p[-1 + j][2 + \
i])/175. + p[j][-2 + i]/25. + (22*p[j][-1 + i])/175. + (27*p[j][i])/175. + \
(22*p[j][1 + i])/175. + p[j][2 + i]/25. + (2*p[1 + j][-2 + i])/175. + (17*p[1 \
+ j][-1 + i])/175. + (22*p[1 + j][i])/175. + (17*p[1 + j][1 + i])/175. + \
(2*p[1 + j][2 + i])/175. - (13*p[2 + j][-2 + i])/175. + (2*p[2 + j][-1 + \
i])/175. + p[2 + j][i]/25. + (2*p[2 + j][1 + i])/175. - (13*p[2 + j][2 + \
i])/175.;\n\n"\)}
              },
            RowSpacings->1,
            ColumnAlignments->{Left}],
          Column], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(StringJoin[Flatten[code]]\)], "Input"],

Cell[BoxData[
    \("  pxx = p[-2 + j][-2 + i]/(35.*d2.x) - p[-2 + j][-1 + i]/(70.*d2.x) - \
p[-2 + j][i]/(35.*d2.x) - p[-2 + j][1 + i]/(70.*d2.x) + p[-2 + j][2 + \
i]/(35.*d2.x) + p[-1 + j][-2 + i]/(35.*d2.x) - p[-1 + j][-1 + i]/(70.*d2.x) - \
p[-1 + j][i]/(35.*d2.x) - p[-1 + j][1 + i]/(70.*d2.x) + p[-1 + j][2 + \
i]/(35.*d2.x) + p[j][-2 + i]/(35.*d2.x) - p[j][-1 + i]/(70.*d2.x) - \
p[j][i]/(35.*d2.x) - p[j][1 + i]/(70.*d2.x) + p[j][2 + i]/(35.*d2.x) + p[1 + \
j][-2 + i]/(35.*d2.x) - p[1 + j][-1 + i]/(70.*d2.x) - p[1 + j][i]/(35.*d2.x) \
- p[1 + j][1 + i]/(70.*d2.x) + p[1 + j][2 + i]/(35.*d2.x) + p[2 + j][-2 + \
i]/(35.*d2.x) - p[2 + j][-1 + i]/(70.*d2.x) - p[2 + j][i]/(35.*d2.x) - p[2 + \
j][1 + i]/(70.*d2.x) + p[2 + j][2 + i]/(35.*d2.x);\n\n  pyy = p[-2 + j][-2 + \
i]/(35.*d2.y) + p[-2 + j][-1 + i]/(35.*d2.y) + p[-2 + j][i]/(35.*d2.y) + p[-2 \
+ j][1 + i]/(35.*d2.y) + p[-2 + j][2 + i]/(35.*d2.y) - p[-1 + j][-2 + \
i]/(70.*d2.y) - p[-1 + j][-1 + i]/(70.*d2.y) - p[-1 + j][i]/(70.*d2.y) - p[-1 \
+ j][1 + i]/(70.*d2.y) - p[-1 + j][2 + i]/(70.*d2.y) - p[j][-2 + \
i]/(35.*d2.y) - p[j][-1 + i]/(35.*d2.y) - p[j][i]/(35.*d2.y) - p[j][1 + \
i]/(35.*d2.y) - p[j][2 + i]/(35.*d2.y) - p[1 + j][-2 + i]/(70.*d2.y) - p[1 + \
j][-1 + i]/(70.*d2.y) - p[1 + j][i]/(70.*d2.y) - p[1 + j][1 + i]/(70.*d2.y) - \
p[1 + j][2 + i]/(70.*d2.y) + p[2 + j][-2 + i]/(35.*d2.y) + p[2 + j][-1 + \
i]/(35.*d2.y) + p[2 + j][i]/(35.*d2.y) + p[2 + j][1 + i]/(35.*d2.y) + p[2 + \
j][2 + i]/(35.*d2.y);\n\n  pxy = p[-2 + j][-2 + i]/(25.*d.x*d.y) + p[-2 + \
j][-1 + i]/(50.*d.x*d.y) - p[-2 + j][1 + i]/(50.*d.x*d.y) - p[-2 + j][2 + \
i]/(25.*d.x*d.y) + p[-1 + j][-2 + i]/(50.*d.x*d.y) + p[-1 + j][-1 + \
i]/(100.*d.x*d.y) - p[-1 + j][1 + i]/(100.*d.x*d.y) - p[-1 + j][2 + \
i]/(50.*d.x*d.y) - p[1 + j][-2 + i]/(50.*d.x*d.y) - p[1 + j][-1 + \
i]/(100.*d.x*d.y) + p[1 + j][1 + i]/(100.*d.x*d.y) + p[1 + j][2 + \
i]/(50.*d.x*d.y) - p[2 + j][-2 + i]/(25.*d.x*d.y) - p[2 + j][-1 + \
i]/(50.*d.x*d.y) + p[2 + j][1 + i]/(50.*d.x*d.y) + p[2 + j][2 + \
i]/(25.*d.x*d.y);\n\n  px = -p[-2 + j][-2 + i]/(25.*d.x) - p[-2 + j][-1 + \
i]/(50.*d.x) + p[-2 + j][1 + i]/(50.*d.x) + p[-2 + j][2 + i]/(25.*d.x) - p[-1 \
+ j][-2 + i]/(25.*d.x) - p[-1 + j][-1 + i]/(50.*d.x) + p[-1 + j][1 + \
i]/(50.*d.x) + p[-1 + j][2 + i]/(25.*d.x) - p[j][-2 + i]/(25.*d.x) - p[j][-1 \
+ i]/(50.*d.x) + p[j][1 + i]/(50.*d.x) + p[j][2 + i]/(25.*d.x) - p[1 + j][-2 \
+ i]/(25.*d.x) - p[1 + j][-1 + i]/(50.*d.x) + p[1 + j][1 + i]/(50.*d.x) + p[1 \
+ j][2 + i]/(25.*d.x) - p[2 + j][-2 + i]/(25.*d.x) - p[2 + j][-1 + \
i]/(50.*d.x) + p[2 + j][1 + i]/(50.*d.x) + p[2 + j][2 + i]/(25.*d.x);\n\n  py \
= -p[-2 + j][-2 + i]/(25.*d.y) - p[-2 + j][-1 + i]/(25.*d.y) - p[-2 + \
j][i]/(25.*d.y) - p[-2 + j][1 + i]/(25.*d.y) - p[-2 + j][2 + i]/(25.*d.y) - \
p[-1 + j][-2 + i]/(50.*d.y) - p[-1 + j][-1 + i]/(50.*d.y) - p[-1 + \
j][i]/(50.*d.y) - p[-1 + j][1 + i]/(50.*d.y) - p[-1 + j][2 + i]/(50.*d.y) + \
p[1 + j][-2 + i]/(50.*d.y) + p[1 + j][-1 + i]/(50.*d.y) + p[1 + \
j][i]/(50.*d.y) + p[1 + j][1 + i]/(50.*d.y) + p[1 + j][2 + i]/(50.*d.y) + p[2 \
+ j][-2 + i]/(25.*d.y) + p[2 + j][-1 + i]/(25.*d.y) + p[2 + j][i]/(25.*d.y) + \
p[2 + j][1 + i]/(25.*d.y) + p[2 + j][2 + i]/(25.*d.y);\n\n  ppp = (-13*p[-2 + \
j][-2 + i])/175. + (2*p[-2 + j][-1 + i])/175. + p[-2 + j][i]/25. + (2*p[-2 + \
j][1 + i])/175. - (13*p[-2 + j][2 + i])/175. + (2*p[-1 + j][-2 + i])/175. + \
(17*p[-1 + j][-1 + i])/175. + (22*p[-1 + j][i])/175. + (17*p[-1 + j][1 + \
i])/175. + (2*p[-1 + j][2 + i])/175. + p[j][-2 + i]/25. + (22*p[j][-1 + \
i])/175. + (27*p[j][i])/175. + (22*p[j][1 + i])/175. + p[j][2 + i]/25. + \
(2*p[1 + j][-2 + i])/175. + (17*p[1 + j][-1 + i])/175. + (22*p[1 + \
j][i])/175. + (17*p[1 + j][1 + i])/175. + (2*p[1 + j][2 + i])/175. - (13*p[2 \
+ j][-2 + i])/175. + (2*p[2 + j][-1 + i])/175. + p[2 + j][i]/25. + (2*p[2 + \
j][1 + i])/175. - (13*p[2 + j][2 + i])/175.;\n\n"\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"curv.10000.Real64", "irregNode.10000.array", "ls.10000.Real64", 
      ".svn"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(MX = 64;\)\), "\[IndentingNewLine]", 
    \(\(ls = 
        ImportVec2[MX, 
          1, "\<ls.10000.Real64\>"];\)\), "\[IndentingNewLine]", 
    \(\(curv = 
        ImportVec2[MX, 
          1, "\<curv.10000.Real64\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions /@ {ls, curv}\)}], "Input"],

Cell[BoxData[
    \({{64, 64}, {64, 64}}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ListDensityPlot[ls, PlotRange \[Rule] {\(-4\), 4}];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Table[
        ls[\([i - 1, j]\)] - 2  ls[\([i, j]\)] + ls[\([i + 1, j]\)], {i, 2, 
          Length[ls] - 1}, {j, 2, Length[ls[\([1]\)]] - 1}] // 
      ListDensityPlot[#, PlotRange \[Rule] {0, 356}] &\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(rng = Quantile[Flatten@curv, {0, 1}]\)], "Input"],

Cell[BoxData[
    \({\(-1.`\), 356.52815812695746`}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListPlot3D[curv, PlotRange \[Rule] All, 
        Mesh \[Rule] False];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[curv, PlotRange \[Rule] All];\)\)}], "Input"],

Cell[BoxData[
    \(\(Histogram[Flatten@curv];\)\)], "Input"],

Cell[BoxData[
    \(\(Histogram[Select[Flatten[curv], # >  .01 &]];\)\)], "Input"],

Cell[BoxData[{
    \(Dx[p_, i_, j_] := \((p[\([i + 1, j]\)] - p[\([i - 1, j]\)])\)/
        2\), "\[IndentingNewLine]", 
    \(Dy[p_, i_, j_] := \((p[\([i, j + 1]\)] - p[\([i, j - 1]\)])\)/
        2\), "\[IndentingNewLine]", 
    \(Dxx[p_, i_, j_] := 
      p[\([i + 1, j]\)] - 2  p[\([i, j]\)] + 
        p[\([i - 1, j]\)]\), "\[IndentingNewLine]", 
    \(Dyy[p_, i_, j_] := 
      p[\([i, j + 1]\)] - 2  p[\([i, j]\)] + 
        p[\([i, j - 1]\)]\), "\[IndentingNewLine]", 
    \(Dxy[p_, i_, 
        j_] := \((p[\([i + 1, j + 1]\)] + p[\([i - 1, j - 1]\)] - 
            p[\([i + 1, j - 1]\)] - p[\([i - 1, j + 1]\)])\)/4\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(m = 50;\)\), "\[IndentingNewLine]", 
    \(\(dat = 
        Table[Abs[i] + Abs[j], {i, \(-m\), m}, {j, \(-m\), 
            m}];\)\), "\[IndentingNewLine]", 
    \(\(dat = 
        Table[i\^2 + j\^2, {i, \(-m\), m}, {j, \(-m\), 
            m}];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[dat];\)\)}], "Input"],

Cell[BoxData[
    \(\(Table[\[IndentingNewLine]Dxy[dat, i, j], \[IndentingNewLine]{i, 2, 
            2  m}, {j, 2, 2  m}] // ListPlot3D;\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(Table[\[IndentingNewLine]\((\(Dx[dat, i, j]\^2\) 
                  Dyy[dat, i, j] + \(Dy[dat, i, j]\^2\) Dxx[dat, i, j] - 
                2*Dx[dat, i, j] Dy[dat, i, j] 
                  Dxy[dat, i, 
                    j])\)/\((Dx[dat, i, j]\^2 + Dy[dat, i, j]\^2)\)\^\(3/2\), \
\[IndentingNewLine]{i, 2, 2  m}, {j, 2, 2  m}] // 
        ListDensityPlot[#, PlotRange \[Rule] {0,  .1}] &;\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(Power::"infy"\), \(\(:\)\(\ \)\), "\<\"Infinite expression \
\\!\\(1\\/0\\) encountered. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Power::infy\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(\[Infinity]::"indet"\), \(\(:\)\(\ \)\), "\<\"Indeterminate \
expression \\!\\(0\\\\ ComplexInfinity\\) encountered. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::indet\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(DensityGraphics::"zval"\), \(\(:\)\(\ \)\), "\<\"Non-numerical \
value \\!\\(Indeterminate\\) found at position \\!\\({50, 50}\\) in first \
argument. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::zval\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(\(NN = {D[p[x, y], x], D[p[x, y], y]}\/\@\(D[p[x, y], x]\^2 + D[p[x, \
y], y]\^2\);\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(k = D[NN[\([1]\)], x] + D[NN[\([2]\)], y]\)], "Input"],

Cell[BoxData[
    RowBox[{
      FractionBox[
        RowBox[{
          SuperscriptBox["p", 
            TagBox[\((0, 2)\),
              Derivative],
            MultilineFunction->None], "[", \(x, y\), "]"}], 
        SqrtBox[
          RowBox[{
            SuperscriptBox[
              RowBox[{
                SuperscriptBox["p", 
                  TagBox[\((0, 1)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], "2"], "+", 
            SuperscriptBox[
              RowBox[{
                SuperscriptBox["p", 
                  TagBox[\((1, 0)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], "2"]}]]], 
      "-", 
      FractionBox[
        RowBox[{
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((0, 1)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{"2", " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((0, 1)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((0, 2)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}]}], "+", 
              RowBox[{"2", " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((1, 0)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((1, 1)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}]}]}], 
            ")"}]}], 
        RowBox[{"2", " ", 
          SuperscriptBox[
            RowBox[{"(", 
              RowBox[{
                SuperscriptBox[
                  RowBox[{
                    SuperscriptBox["p", 
                      TagBox[\((0, 1)\),
                        Derivative],
                      MultilineFunction->None], "[", \(x, y\), "]"}], "2"], 
                "+", 
                SuperscriptBox[
                  RowBox[{
                    SuperscriptBox["p", 
                      TagBox[\((1, 0)\),
                        Derivative],
                      MultilineFunction->None], "[", \(x, y\), "]"}], "2"]}], 
              ")"}], \(3/2\)]}]], "+", 
      FractionBox[
        RowBox[{
          SuperscriptBox["p", 
            TagBox[\((2, 0)\),
              Derivative],
            MultilineFunction->None], "[", \(x, y\), "]"}], 
        SqrtBox[
          RowBox[{
            SuperscriptBox[
              RowBox[{
                SuperscriptBox["p", 
                  TagBox[\((0, 1)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], "2"], "+", 
            SuperscriptBox[
              RowBox[{
                SuperscriptBox["p", 
                  TagBox[\((1, 0)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], "2"]}]]], 
      "-", 
      FractionBox[
        RowBox[{
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((1, 0)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
          RowBox[{"(", 
            RowBox[{
              RowBox[{"2", " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((0, 1)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((1, 1)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}]}], "+", 
              RowBox[{"2", " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((1, 0)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
                RowBox[{
                  SuperscriptBox["p", 
                    TagBox[\((2, 0)\),
                      Derivative],
                    MultilineFunction->None], "[", \(x, y\), "]"}]}]}], 
            ")"}]}], 
        RowBox[{"2", " ", 
          SuperscriptBox[
            RowBox[{"(", 
              RowBox[{
                SuperscriptBox[
                  RowBox[{
                    SuperscriptBox["p", 
                      TagBox[\((0, 1)\),
                        Derivative],
                      MultilineFunction->None], "[", \(x, y\), "]"}], "2"], 
                "+", 
                SuperscriptBox[
                  RowBox[{
                    SuperscriptBox["p", 
                      TagBox[\((1, 0)\),
                        Derivative],
                      MultilineFunction->None], "[", \(x, y\), "]"}], "2"]}], 
              ")"}], \(3/2\)]}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(k = \(D[NN[\([1]\)], x] + D[NN[\([2]\)], y] // Expand\) // 
        Together\)], "Input"],

Cell[BoxData[
    FractionBox[
      RowBox[{
        RowBox[{
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((0, 2)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
          SuperscriptBox[
            RowBox[{
              SuperscriptBox["p", 
                TagBox[\((1, 0)\),
                  Derivative],
                MultilineFunction->None], "[", \(x, y\), "]"}], "2"]}], "-", 
        RowBox[{"2", " ", 
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((0, 1)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((1, 0)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}], " ", 
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((1, 1)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}]}], "+", 
        RowBox[{
          SuperscriptBox[
            RowBox[{
              SuperscriptBox["p", 
                TagBox[\((0, 1)\),
                  Derivative],
                MultilineFunction->None], "[", \(x, y\), "]"}], "2"], " ", 
          RowBox[{
            SuperscriptBox["p", 
              TagBox[\((2, 0)\),
                Derivative],
              MultilineFunction->None], "[", \(x, y\), "]"}]}]}], 
      SuperscriptBox[
        RowBox[{"(", 
          RowBox[{
            SuperscriptBox[
              RowBox[{
                SuperscriptBox["p", 
                  TagBox[\((0, 1)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], "2"], "+", 
            SuperscriptBox[
              RowBox[{
                SuperscriptBox["p", 
                  TagBox[\((1, 0)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], "2"]}], 
          ")"}], \(3/2\)]]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(f = x\^2 + y\^2;\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(kk = k /. p \[Rule] Function[{x, y}, x\^2 + y\^2]\)], "Input"],

Cell[BoxData[
    \(\(8\ x\^2 + 8\ y\^2\)\/\((4\ x\^2 + 4\ y\^2)\)\^\(3/2\)\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Plot3D[kk, {x, \(-5\), 5}, {y, \(-5\), 5}, 
      PlotRange \[Rule] {0, 3}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Plot3D[
      D[f, x, y] // Evaluate, {x, \(-m\), m}, {y, \(-m\), m}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  SurfaceGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(fx = D[f, x]\), "\[IndentingNewLine]", 
    \(fy = D[f, y]\), "\[IndentingNewLine]", 
    \(fxx = D[f, {x, 2}]\), "\[IndentingNewLine]", 
    \(fyy = D[f, {y, 2}]\), "\[IndentingNewLine]", 
    \(fxy = D[f, x, y]\)}], "Input"],

Cell[BoxData[
    \(2\ x\)], "Output"],

Cell[BoxData[
    \(2\ y\)], "Output"],

Cell[BoxData[
    \(2\)], "Output"],

Cell[BoxData[
    \(2\)], "Output"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(fx\^2\) fyy - 2  fx\ fy\ fxy + \(fy\^2\) fxx\)], "Input"],

Cell[BoxData[
    \(8\ x\^2 + 8\ y\^2\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\((fx\^2 + fy\^2)\)\^\(3/2\)\)], "Input"],

Cell[BoxData[
    \(\((4\ x\^2 + 4\ y\^2)\)\^\(3/2\)\)], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Particles", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"grid.10000.Real64", "grid.10000.Real64.info", "grid.pos", 
      "grid.size", "irregNode.10000.array", "irregNode.10000.array.info", 
      "lost+found", "particles.10000.array", "velgrid.10000.Real64", 
      "velgrid.10000.Real64.info", "velgrid.pos", "velgrid.size"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 360;\)\), "\[IndentingNewLine]", 
    \(\(vel = 
        ImportVec2[d1, 
          2, "\<velgrid.10000.Real64\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[vel]\)}], "Input"],

Cell[BoxData[
    \({2, 360, 360}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListDensityPlot[vel[\([2]\)]]\)], "Input"],

Cell[BoxData[
    RowBox[{\(DensityGraphics::"zval"\), \(\(:\)\(\ \)\), "\<\"Non-numerical \
value \\!\\(Indeterminate\\) found at position \\!\\({181, 181}\\) in first \
argument. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::zval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(ListPlot3D[vel[\([1]\)], Mesh \[Rule] False];\)\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  SurfaceGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(<< Graphics`PlotField`\)], "Input"],

Cell[BoxData[
    \(\(ListPlotVectorField[Transpose[vel, {3, 2, 1}]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Max[vel[\([1]\)]]\), "\[IndentingNewLine]", 
    \(Min[vel[\([1]\)]]\)}], "Input"],

Cell[BoxData[
    \(0.`\)], "Output"],

Cell[BoxData[
    \(0.`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[phi]\)}], "Input"],

Cell[BoxData[
    \({18}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot /@ phi;\)\)}], "Input"],

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[
          t, \[IndentingNewLine]ImportIrreg["\<irregNode.\>" <> 
              ToString[
                10000 + t - 
                  1] <> "\<.array\>"]; \[IndentingNewLine]ListDensityPlot[
            phi[\([t]\)], \[IndentingNewLine]Epilog \[Rule] {Green, 
                PointSize[0.008], \(Point[# + 0.5 - pos[\([t]\)]] &\) /@ 
                  ir`X}]\[IndentingNewLine]] /@ 
        Range[1, Length[phi], 50];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\n", 
    \(\(p = Take[phi[\([1]\)], {39, 45}, {20, 30}];\)\), "\n", 
    \(ListPlot3D[p]\), "\n", 
    \(MatrixForm[Reverse@p]\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  SurfaceGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"4.037409052528495`", "3.2762272847601035`", 
              "2.6027071656345515`", "2.0856553932883326`", 
              "2.2319116007910855`", "2.662704383095751`", 
              "3.229249837549347`", "3.8806523912082076`", 
              "4.589929818134971`", "5.3408962072806485`", 
              "6.123097462377414`"},
            {"3.388870451967985`", "2.5370583939556384`", 
              "1.7467530402787386`", "1.0856553932883324`", 
              "1.242664856158124`", "1.760253509798924`", "2.40521934779914`",
               "3.1219200846028343`", "3.8850003665923722`", 
              "4.680555778128005`", "5.500071623005528`"},
            {"2.8650229380626775`", "1.924345208240145`", 
              "0.9964531661325751`", "0.0856553932883324`", 
              "0.2550677578587517`", "0.9046239254446287`", 
              "1.641007945232625`", "2.4245392317935246`", 
              "3.238696658387968`", "4.074674942339012`", 
              "4.9270150987475105`"},
            {"2.5257215843725893`", "1.551496233193354`", 
              "0.5836003873094612`", \(-0.22284990265056795`\), \
\(-0.46909284930550005`\), "0.14431031570773317`", "0.9644441452840378`", 
              "1.8031868977830854`", "2.658052460344869`", 
              "3.5259124174138243`", "4.404027280750248`"},
            {"2.3001446238475944`", "1.3001446238475944`", 
              "0.3001446238475945`", \(-0.5361832273341469`\), \
\(-1.0346230744380343`\), \(-0.37755893504173577`\), "0.39227240394713364`", 
              "1.2586590333626129`", "2.1392028964576806`", 
              "3.029103505540994`", "3.925577401674442`"},
            {"2.315320053532167`", "1.3154352069953825`", 
              "0.31555211479559936`", \(-0.5787858211246882`\), \
\(-1.3855978658577006`\), \(-0.9231613619315193`\), \(-0.08511721525905515`\),
               "0.7592852170985991`", "1.6652382298783928`", 
              "2.572949029564766`", "3.4824808506256675`"},
            {"2.4169695998260807`", "1.422149329758044`", 
              "0.42785958526552637`", \(-0.5038960166634067`\), \
\(-1.495249587678145`\), \(-1.4011683193114042`\), \(-0.5278653571963484`\), 
              "0.3353835130944319`", "1.2418599845288996`", 
              "2.1533526709858055`", "3.066846556470766`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ListDensityPlot[
      Sign@phi[\([\(-1\)]\)], \[IndentingNewLine]Epilog \[Rule] {Green, 
          PointSize[0.008], \(Point[# + 0.5 - pos[\([\(-1\)]\)]] &\) /@ 
            ir`X}]\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(xp = 0;\)\), "\[IndentingNewLine]", 
    \(\(rp = 2;\)\), "\[IndentingNewLine]", 
    \(\(sp = \(-1\);\)\), "\[IndentingNewLine]", 
    \(Plot[sp \((rp - Abs[x - xp])\), {x, \(-4\) rp, 4  rp}]\)}], "Input"],

Cell[BoxData[
    \(\(dat = 
        BinaryReadList[
          file, {"\<Real64\>", "\<Real64\>", "\<Real64\>", \
"\<Real64\>"}];\)\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ImportParticles = 
        Function[
          t, \[IndentingNewLine]file = "\<particles.\>" <> 
              ToString[t + 10000] <> "\<.array\>"; \[IndentingNewLine]dat = 
            Import[file, "\<Real64\>"]; \[IndentingNewLine]dat = 
            Partition[dat, 4]; \[IndentingNewLine]dat = 
            Transpose[Most@dat]; \[IndentingNewLine]X = 
            dat[\([{1, 2}]\)] // Transpose; \[IndentingNewLine]radius = 
            dat[\([4]\)];\[IndentingNewLine]];\)\)}], "Input"],

Cell[BoxData[
    \(MapThread[{If[Sign[#2] \[Equal] 1, Red, Green], 
          Circle[#1, Abs[#2]]} &, {X, radius}]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ImportParticles[13]\), "\[IndentingNewLine]", 
    \(\(ListPlot[X, AspectRatio \[Rule] 1, 
        PlotStyle \[Rule] PointSize[ .002], ImageSize \[Rule] 1100, 
        PlotRange \[Rule] 10 {{\(-1\), 1}, {\(-1\), 1}}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(txt = Import["\</tmp/out\>", "\<Text\>"];\)\), "\n", 
    \(\(out = 
        ToExpression[\(StringCases[txt, 
              RegularExpression["\<({.*}),\>"] -> \
"\<{$1}\>"]\)[\([1]\)]];\)\), "\n", 
    \(cell = out[\([224]\)]\), "\[IndentingNewLine]", 
    \(Length[cell[\([2]\)]] - 1\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Count[Floor[X + 0.5], cell[\([1]\)]]\)], "Input"],

Cell[BoxData[
    \(18\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ImportParticles[3]\), "\[IndentingNewLine]", 
    \(\(ListPlot[X, AspectRatio \[Rule] 1, 
        PlotStyle \[Rule] PointSize[ .002], ImageSize \[Rule] 1100, 
        PlotRange \[Rule] 10 {{\(-1\), 1}, {\(-1\), 1}}, 
        Prolog \[Rule] {Blue, \(Function[
                p, \[IndentingNewLine]Rectangle[{p[\([1]\)] - 0.5, 
                    p[\([2]\)] - 0.5}, {p[\([1]\)] + 0.5, 
                    p[\([2]\)] + 0.5}]\[IndentingNewLine]]\)[cell[\([1]\)]], 
            PointSize[0.008], Orange, 
            Point /@ \((Pick[
                  X, \(# \[Equal] cell[\([1]\)] &\) /@ Floor[X + 0.5]])\), 
            PointSize[0.005], Green, Point /@ cell[\([2]\)], 
            Black}];\)\)}], "Input"],

Cell[BoxData[
    \(\(\(,\)\(Epilog -> 
      MapThread[{If[Sign[#2] \[Equal] 1, Red, Green], 
            Circle[#1, Abs[#2]]} &, {X, radius}]\)\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(MapThread[{If[#2 < 0, Red, Green], #1} &, {X, radius}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(MapThread::"mptd"\), \(\(:\)\(\ \)\), "\<\"Object \
\\!\\(Transpose[\\(\\(\\(\\(Transpose[\\(\\(Most[$Failed]\\)\\)]\\)\\) \
\[LeftDoubleBracket] \\(\\({1, 2}\\)\\) \[RightDoubleBracket]\\)\\)]\\) at \
position {2, \\!\\(1\\)} in \
\\!\\(MapThread[\\(\\(\\(\\(\\(\\({\\(\\(If[\\(\\(\\(\\(#2 < 0\\)\\), Red, \
Green\\)\\)]\\)\\), #1}\\)\\) &\\)\\), \
\\(\\({\\(\\(Transpose[\\(\\(\\(\\(Transpose[\\(\\(Most[$Failed]\\)\\)]\\)\\) \
\[LeftDoubleBracket] \\(\\({1, 2}\\)\\) \[RightDoubleBracket]\\)\\)]\\)\\), \
\\(\\(\\(\\(Transpose[\\(\\(Most[$Failed]\\)\\)]\\)\\) \[LeftDoubleBracket] 4 \
\[RightDoubleBracket]\\)\\)}\\)\\)\\)\\)]\\) has only \\!\\(0\\) of required \
\\!\\(1\\) dimensions. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"MapThread::mptd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    \(MapThread[{If[#2 < 0, Red, 
            Green], #1} &, {Transpose[\(Transpose[
              Most[$Failed]]\)\[LeftDoubleBracket]{1, 
              2}\[RightDoubleBracket]], \(Transpose[
            Most[$Failed]]\)\[LeftDoubleBracket]4\[RightDoubleBracket]}]\)], \
"Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Graphics[
        MapThread[{If[#2 < 0, Red, Green], Point[#1]} &, {X, radius}]] // 
      Show\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(\((\[IndentingNewLine]ImportParticles[#]; \
\[IndentingNewLine]ListPlot[X, AspectRatio \[Rule] 1, 
              PlotStyle \[Rule] PointSize[ .002], ImageSize \[Rule] 1100, 
              PlotRange \[Rule] 
                30 {{\(-1\), 1}, {\(-1\), 1}}];\[IndentingNewLine])\) &\) /@ 
        Range[0, 2];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(ListPlot::"list"\), \(\(:\)\(\ \)\), "\<\"List expected at \
position \\!\\(1\\) in \\!\\(ListPlot[\\(\\(X, \\(\\(AspectRatio \[Rule] 1\\)\
\\), \\(\\(PlotStyle \[Rule] \\(\\(PointSize[0.002`]\\)\\)\\)\\), \
\\(\\(ImageSize \[Rule] 1100\\)\\), \\(\\(PlotRange \[Rule] \\(\\({\\(\\({\\(\
\\(-30\\)\\), 30}\\)\\), \\(\\({\\(\\(-30\\)\\), \
30}\\)\\)}\\)\\)\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::list\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ListPlot::"list"\), \(\(:\)\(\ \)\), "\<\"List expected at \
position \\!\\(1\\) in \\!\\(ListPlot[\\(\\(X, \\(\\(AspectRatio \[Rule] 1\\)\
\\), \\(\\(PlotStyle \[Rule] \\(\\(PointSize[0.002`]\\)\\)\\)\\), \
\\(\\(ImageSize \[Rule] 1100\\)\\), \\(\\(PlotRange \[Rule] \\(\\({\\(\\({\\(\
\\(-30\\)\\), 30}\\)\\), \\(\\({\\(\\(-30\\)\\), \
30}\\)\\)}\\)\\)\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::list\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ListPlot::"list"\), \(\(:\)\(\ \)\), "\<\"List expected at \
position \\!\\(1\\) in \\!\\(ListPlot[\\(\\(X, \\(\\(AspectRatio \[Rule] 1\\)\
\\), \\(\\(PlotStyle \[Rule] \\(\\(PointSize[0.002`]\\)\\)\\)\\), \
\\(\\(ImageSize \[Rule] 1100\\)\\), \\(\\(PlotRange \[Rule] \\(\\({\\(\\({\\(\
\\(-30\\)\\), 30}\\)\\), \\(\\({\\(\\(-30\\)\\), \
30}\\)\\)}\\)\\)\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::list\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(ListPlot :: \\\"list\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(\(\((\[IndentingNewLine]ImportParticles[#]; \[IndentingNewLine]Length[
                X]\[IndentingNewLine])\) &\) /@ Range[0, 89] // ListPlot\) // 
      AbsoluteTiming\)], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{\(0.764638`6.3350008707262315\ Second\), ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
          False,
          Editable->False]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\((\[IndentingNewLine]ImportParticles[#]; \[IndentingNewLine]ListPlot[
            X, AspectRatio \[Rule] 1, PlotStyle \[Rule] PointSize[ .002], 
            ImageSize \[Rule] 1100, 
            PlotRange \[Rule] 30 {{\(-1\), 1}, {\(-1\), 1}}, 
            Epilog \[Rule] {MapThread[{If[#2 > 0, Green, Red], 
                      Circle[#1, Abs@#2]} &, 
                  Take[{X, radius}\[Transpose] , {1, \(-1\), 
                        20}]\[Transpose] ]}];\[IndentingNewLine])\) &\) /@ 
      Range[0, 89]\)}], "Input"],

Cell[BoxData[
    \({Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null, Null, Null}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot[X]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Show[
        Graphics[MapThread[{Hue[#1/6 + 0.5], Point[#2]} &, {phigoal, X}]], 
        AspectRatio \[Rule] 1];\)\)], "Input"],

Cell[BoxData[
    \(\(Show[
        Graphics[
          MapThread[{Hue[Abs[\((#2 + 1)\)/4]], Point[#1]} &, {X, sign}]], 
        AspectRatio \[Rule] 1];\)\)], "Input"],

Cell[BoxData[
    \(\(Show[
        Graphics[
          MapThread[{GrayLevel[1 - Abs[#2/5]], Point[#1]} &, {X, Abs@dphi}]], 
        AspectRatio \[Rule] 1];\)\)], "Input"],

Cell[BoxData[
    \(Select[{X, radius, sign}\[Transpose] , #[\([2]\)] < 4 &]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(g = 
        Function[
            t, \[IndentingNewLine]ImportParticles[
              t]; \[IndentingNewLine]ImportIrreg["\<irregNode.\>" <> 
                ToString[
                  10000 + 
                    t] <> "\<.array\>"]; \[IndentingNewLine]circles = {X, 
                  radius, sign}\[Transpose] ; \[IndentingNewLine]circles = 
              Select[circles, 
                0.1 < #[\([2]\)] < 0.5 &]; \[IndentingNewLine]circles = 
              Take[circles, {1, \(-1\), 1}]; \[IndentingNewLine]ListPlot[
              ir`X, PlotStyle \[Rule] PointSize[0.01], ImageSize \[Rule] 800, 
              Frame \[Rule] False, 
              Epilog \[Rule] {Blue, 
                  Disk[circles[\([1, 1]\)], 
                    1], \[IndentingNewLine]MapThread[{If[#3 \[Equal] 1, 
                          Green, Red], Circle[#1, #2]} &, 
                    circles\[Transpose] ]}, AspectRatio \[Rule] 1, 
              PlotRange \[Rule] 
                1.5 {{\(-20\), 20}, {\(-20\), 20}}]\[IndentingNewLine]] /@ 
          Range[0, 200, 20];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Graphics::"gptn"\), \(\(:\)\(\ \)\), "\<\"Coordinate \
\\!\\(Indeterminate\\) in \
\\!\\({6.653039617871498105845`8.129235452729244*^-316, Indeterminate}\\) is \
not a floating-point number. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Graphics::gptn\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Graphics::"gptn"\), \(\(:\)\(\ \)\), "\<\"Coordinate \
\\!\\(Indeterminate\\) in \
\\!\\({6.653039617871498105845`8.129235452729244*^-316, Indeterminate}\\) is \
not a floating-point number. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Graphics::gptn\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Graphics::"gptn"\), \(\(:\)\(\ \)\), "\<\"Coordinate \
\\!\\(Indeterminate\\) in \
\\!\\({6.653039617871498105845`8.129235452729244*^-316, Indeterminate}\\) is \
not a floating-point number. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Graphics::gptn\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Graphics :: \\\"gptn\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[BoxData[
    \(iphi = 
      ListInterpolation[
        phi[\([1]\)]\[Transpose] , {pos[\([1]\)], 
            Dimensions[phi[\([1]\)]] + pos[\([1]\)]}\[Transpose] , 
        InterpolationOrder \[Rule] 1]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ContourPlot[iphi[x, y], {x, \(-30\), 30}, {y, \(-30\), 30}, 
        Contours \[Rule] {\(-2\), 0, 2}, PlotPoints \[Rule] 100, 
        ImageSize \[Rule] 3000, 
        Epilog \[Rule] {Blue, PointSize[0.01], \(Point[# + 0.5] &\) /@ ir`X, 
            MapThread[{If[#3 \[Equal] 1, Green, Red], 
                  Circle[#1 + 0.5, #2]} &, 
              circles\[Transpose] ]}];\)\)}], "Input"],

Cell[BoxData[
    \(Function[
          f, {f, Mean[\(iphi[#[\([1]\)], #[\([2]\)]] &\) /@ \((ir`X + 
                    f)\)]}] /@ Range[\(-0.3\), 0,  .01] // 
      ListPlot\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Max[Abs@dist]\)], "Input"],

Cell[BoxData[
    \(0.7538918177125005`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(MapThread[#2 - Abs@iphi[#[\([1]\)], #[\([2]\)]] &, 
        circles\[Transpose] ];\)\)], "Input"],

Cell[BoxData[
    \(Export["\<g.\>" <> ToString[10000 + t] <> "\<.png\>", g]\)], "Input"],

Cell[BoxData[
    \(\(Function[
          t, \[IndentingNewLine]ImportIrreg["\<irregNode.\>" <> 
              ToString[
                10000 + t - 1] <> "\<.array\>"]; \[IndentingNewLine]img = 
            DisplayTogether[g[\([t]\)], 
              Graphics[{Gray, PointSize[0.02], 
                  Point /@ ir`X}]]; \[IndentingNewLine]Export["\<g.\>" <> 
              ToString[10000 + t] <> "\<.png\>", img]\[IndentingNewLine]] /@ 
        Range[Length[g]];\)\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Resizing", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell["Irregular Nodes", "Subsection"],

Cell[BoxData[
    \(irregfiles = FileNames["\<irreg*\>"]\)], "Input"],

Cell[BoxData[
    \(\(X = Map[\((ImportIrreg[#]; ir`X)\) &, irregfiles];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(rng = \(Quantile[#, {0, 1}] &\) /@ Transpose@Flatten[X, 1]\)], "Input"],

Cell[BoxData[
    \({{\(-14.958151082267422`\), 
        29.446096408121598`}, {\(-14.958151082267422`\), 
        29.446096408121598`}}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(\(ListPlot[#, PlotRange \[Rule] rng, AspectRatio \[Rule] 1] &\) /@ 
        X;\)\)], "Input"],

Cell[BoxData[
    \(DisplayTogether[ListPlot[X[\([1]\)]], ListPlot[X[\([\(-1\)]\)]], 
      PlotRange \[Rule] rng, AspectRatio \[Rule] 1]\)], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["band", "Subsection"],

Cell[BoxData[
    \(bandfiles = FileNames["\<band.*\>"]\)], "Input"],

Cell[BoxData[
    \(\(bands = 
        Function[
            file, \[IndentingNewLine]band = 
              Import[file, "\<Integer32\>"]; \[IndentingNewLine]band = 
              Partition[band, 3]; \[IndentingNewLine]band = 
              band[\([All, {1, 
                    2}]\)]; \[IndentingNewLine]band\[IndentingNewLine]] /@ 
          FileNames["\<band.*\>"];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot[bands[\([1]\)]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(bandbox = 
      Function[p, 
        Line[\(p + # &\) /@ {{0, 0}, {0, 1}, {1, 1}, {1, 0}, {0, 
                0}}]]\)], "Input"],

Cell[BoxData[
    \(Function[p, 
      Line[\((p + #1 &)\) /@ {{0, 0}, {0, 1}, {1, 1}, {1, 0}, {0, 
              0}}]]\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(rng = \(Quantile[#, {0, 1}] &\) /@ 
        Transpose[Flatten[bands, 1]]\), "\n", 
    \(\(Show[Graphics[bandbox /@ #, PlotRange \[Rule] rng], 
          AspectRatio \[Rule] 1] &\) /@ bands\)}], "Input"],

Cell[BoxData[
    \({{\(-18\), 34}, {\(-18\), 34}}\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["grid", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames["\<grid.*\>"]\)], "Input"],

Cell[BoxData[
    \({"grid.10000.Real64", "grid.10001.Real64", "grid.10002.Real64", 
      "grid.10003.Real64", "grid.10004.Real64", "grid.10005.Real64", 
      "grid.10006.Real64", "grid.10007.Real64", "grid.10008.Real64", 
      "grid.10009.Real64", "grid.10010.Real64", "grid.10011.Real64", 
      "grid.10012.Real64", "grid.10013.Real64", "grid.10014.Real64", 
      "grid.10015.Real64", "grid.10016.Real64", "grid.10017.Real64", 
      "grid.10018.Real64", "grid.10019.Real64", "grid.10020.Real64", 
      "grid.10021.Real64", "grid.10022.Real64", "grid.10023.Real64", 
      "grid.10024.Real64", "grid.10025.Real64", "grid.10026.Real64", 
      "grid.10027.Real64", "grid.10028.Real64", "grid.10029.Real64", 
      "grid.10030.Real64", "grid.10031.Real64", "grid.10032.Real64", 
      "grid.10033.Real64", "grid.10034.Real64", "grid.10035.Real64", 
      "grid.10036.Real64", "grid.10037.Real64", "grid.10038.Real64", 
      "grid.10039.Real64", "grid.10040.Real64", "grid.10041.Real64", 
      "grid.10042.Real64", "grid.10043.Real64", "grid.10044.Real64", 
      "grid.10045.Real64", "grid.10046.Real64", "grid.10047.Real64", 
      "grid.10048.Real64", "grid.10049.Real64", "grid.pos", 
      "grid.size"}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(clear\), "\n", 
    \(\(ListDensityPlot /@ phi;\)\)}], "Input"],

Cell[BoxData[
    \(\(LevelSetColor = 
        If[# > 0, \[IndentingNewLine]If[# > 6, RGBColor[1, 0, 0], 
              RGBColor[1 - #/6, 0, 0]], \[IndentingNewLine]If[# < \(-6\), 
              RGBColor[0, 0, 1], RGBColor[0, 0, 1 + #/6]]] &;\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(Function[i, 
        ListDensityPlot[phi[\([i]\)], ColorFunction \[Rule] LevelSetColor, 
          ColorFunctionScaling \[Rule] False, Frame \[Rule] True, 
          Epilog \[Rule] {Green, 
              bandbox /@ 
                Transpose[bands[\([i]\)]\[Transpose]  - pos[\([i]\)]]}]] /@ 
      Range[Length[phi]]\)}], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            DensityGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Dimensions[phi]\)], "Input"],

Cell[BoxData[
    \({5}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(f = 
        Function[{phi, pos}, 
          Module[{dim = Dimensions[phi], qos, f}, \[IndentingNewLine]qos = 
              pos + dim; \[IndentingNewLine]Function[{x, y}, 
              If[Evaluate[
                  pos[\([1]\)] \[LessEqual] x \[LessEqual] qos[\([1]\)] && 
                    pos[\([2]\)] \[LessEqual] y \[LessEqual] 
                      qos[\([1]\)]], \(ListInterpolation[phi, 
                    Transpose@{pos, pos + dim}, 
                    InterpolationOrder \[Rule] 2]\)[x, y], 
                10. ]]\[IndentingNewLine]]];\)\), "\n", 
    \(\(iphi = MapThread[f, {phi, pos}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(f = 
        Function[{phi, pos}, 
          Module[{dim = Dimensions[phi], qos = pos + dim, 
              f}, \[IndentingNewLine]f = 
              ListInterpolation[phi, Transpose@{pos, pos + dim}, 
                InterpolationOrder \[Rule] 
                  1]; \[IndentingNewLine]f\[IndentingNewLine]]];\)\), "\n", 
    \(\(iphi = MapThread[f, {phi, pos}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(g = \(DensityPlot[
              Clip[Abs[#[x, y]] - 1.1, {\(-1.1\), 0}], {x, \(-18\), 
                64}, {y, \(-18\), 64}, PlotPoints \[Rule] 128, 
              Frame \[Rule] False, ImageSize \[Rule] 800] &\) /@ 
          iphi;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\</tmp/test.png\>", g]\)], "Input"],

Cell[BoxData[
    \("/tmp/test.png"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(140\ 4\ 10\)], "Input"],

Cell[BoxData[
    \(5600\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(72*6*10\)], "Input"],

Cell[BoxData[
    \(4320\)], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["DrawContour", "Section"],

Cell[BoxData[{
    \(\(p = \(-3\);\)\), "\[IndentingNewLine]", 
    \(\(q = 8;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(g = Range[p, q]\)], "Input"],

Cell[BoxData[
    \({\(-3\), \(-2\), \(-1\), 0, 1, 2, 3, 4, 5, 6, 7, 8}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d =  .1;\)\), "\[IndentingNewLine]", 
    \(s = \(q - p\)\/d\)}], "Input"],

Cell[BoxData[
    \(110.`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(d*Range[0, s - 1] + p\)], "Input"],

Cell[BoxData[
    \(img = Range[p, q,  .1]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(2^10\)], "Input"],

Cell[BoxData[
    \(1024\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["irreg", "Section"],

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ImportIrreg["\<irregNode.10000.array\>"];\)\), "\[IndentingNewLine]", \

    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\n", 
    \(\(ir`X\  = \(\((# - pos[\([1]\)] + 0.5)\) &\) /@ 
          ir`X;\)\), "\[IndentingNewLine]", 
    \(\(ir`x\  = \(\((# - pos[\([1]\)] + 0.5)\) &\) /@ 
          ir`x;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([1]\)], Mesh \[Rule] True, 
        Epilog \[Rule] {PointSize[0.005], Green, Point /@ ir`X, Red, 
            MapThread[Line[{#1, #2}] &, {ir`X, ir`x}]}, 
        ImageSize \[Rule] 1400];\)\)}], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[Sign@phi[\([1]\)], Epilog \[Rule] {Point /@ ir`X}, 
        PlotRange \[Rule] {{13, 16}, {17, 20}, All}];\)\)], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[Sign@Take[phi[\([1]\)], {18, 20\ }, {14, 16}], 
        Mesh \[Rule] True];\)\)], "Input"],

Cell[BoxData[{
    \(\(p = 
        Take[phi[\([\)\(1\)\(]\)], {18, 20\ }, {14, 
            16}];\)\), "\[IndentingNewLine]", 
    \(\(f = ListInterpolation[p, InterpolationOrder \[Rule] 1];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(DensityPlot[Sign@f[x, y], {y, 1, 3}, {x, 1, 3}, PlotPoints \[Rule] 200, 
      Epilog \[Rule] {PointSize[0.005], 
          Green, \(Point[# - {14, 18} + 1.5] &\) /@ ir`X, Red, 
          MapThread[
            Line[{#1 - {14, 18} + 1.5, #2 - {14, 18} + 1.5}] &, {ir`X, 
              ir`x}]}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\({d1, d2} = Dimensions[phi[\([1]\)]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(f = 
        ListInterpolation[phi[\([\)\(1\)\(]\)], {{1, d1}, {1, d2}} - 0.5, 
          InterpolationOrder \[Rule] 1];\)\), "\n", 
    \(DensityPlot[Sign[f[x, y]], {y, 12, 38}, {x, 12, 38}, 
      PlotPoints \[Rule] 1200, 
      Epilog \[Rule] {PointSize[0.005], Green, Point /@ ir`X, Red, 
          MapThread[Line[{#1, #2}] &, {ir`X, ir`x}]}]\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot[phi[\([1, 23]\)]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["StarInit", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"FMM-err.10000.Real64", "FMM-err.10000.Real64.info", "FMM-err.pos", 
      "FMM-err.size", "irregNode.10000.array", 
      "irregNode.10000.array.info"}\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListDensityPlot[phi[\([1]\)]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ListDensityPlot /@ phi\)}], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
        False,
        Editable->False], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[BoxData[
    \(ImportIrreg["\<irregNode.10000.array\>"]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ImportIrreg["\<irregNode.10000.array\>"]\), "\n", 
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([1]\)], 
        Epilog \[Rule] {Red, 
            PointSize[0.01], \(Point[# - pos[\([1]\)] + 0.5] &\) /@ 
              ir`X}];\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ImportIrreg["\<irregNode.10000.array\>"]\), "\n", 
    \(\({phi, pos} = ImportGrid["\<FMM-err\>"];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([1]\)], 
        Epilog \[Rule] {Red, 
            PointSize[0.01], \(Point[# - pos[\([1]\)] + 0.5] &\) /@ 
              ir`X}];\)\)}], "Input"],

Cell[BoxData[
    \(\(center = \(# \[Equal] {0, 0} &\) /@ ir`shift;\)\)], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[phi[\([1]\)], 
        Epilog \[Rule] {Red, 
            PointSize[ .000001], \(Point[#1 - pos[\([1, 1]\)] + 0.5] &\)~
              MapThread~{Pick[ir`idx, center]}}];\)\)], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[phi[\([1]\)], 
        Epilog \[Rule] {Red, \(Line[{#1 - pos[\([1, 1]\)] + 0.5, # - 
                      pos[\([1, 1]\)] + 0.5 + #2}] &\)~
              MapThread~{Pick[ir`idx, center], 
                Pick[ir`op, center]}}];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(pos[\([1, 1]\)]\)], "Input"],

Cell[BoxData[
    \(\(-37\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Position[Norm /@ ir`op, 0. ]\)], "Input"],

Cell[BoxData[
    \({{601}, {2351}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ir`idx[\([601]\)] + 62\)], "Input"],

Cell[BoxData[
    \({62, 29}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\((9000^2)\)\^\(1/3. \)\)], "Input"],

Cell[BoxData[
    \(432.67487109222236`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(400\^3\)], "Input"],

Cell[BoxData[
    \(64000000\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(9000\^2\)], "Input"],

Cell[BoxData[
    \(81000000\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Init", "Subsection"],

Cell[BoxData[{
    \(\(dh = 1/25;\)\), "\[IndentingNewLine]", 
    \(\(center = {5, 5, 5};\)\), "\n", 
    \(\(radius = 3;\)\), "\[IndentingNewLine]", 
    \(\(amp = 0.4;\)\), "\[IndentingNewLine]", 
    \(\(numPetals = 8;\)\), "\[IndentingNewLine]", 
    \(\(thres = 6;\)\), "\[IndentingNewLine]", 
    \(\(BUF = 12;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(p = \((center - radius)\)/dh - BUF // Floor\), "\[IndentingNewLine]", 
    \(q = 
      2*\((\((radius)\)/dh + BUF)\) + p // Floor\), "\[IndentingNewLine]", 
    \(\(z = \(Mean[{q, p}]\)[\([1]\)];\)\), "\[IndentingNewLine]", 
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(img = 
        Table[\[IndentingNewLine]X = 
            x*dh - center[\([\)\(1\)\(]\)]; \[IndentingNewLine]Y = 
            y*dh - center[\([\)\(2\)\(]\)]; \[IndentingNewLine]A = \(radius + \
amp + amp*Cos[numPetals*ArcTan[Y, X]]\)\/radius; \[IndentingNewLine]phi = 
            A \@\( X\^2 + Y\^2\) - radius; \[IndentingNewLine]If[
            Not@NumericQ[phi], 
            phi = 0]; \[IndentingNewLine] (*Which[phi/dh > thres, 1, 
              phi/dh < \(-thres\), \(-1\), True, 
              0]*) \[IndentingNewLine]phi\[IndentingNewLine], \
\[IndentingNewLine]{x, p[\([\)\(1\)\(]\)], q[\([\)\(1\)\(]\)], 
            1}, \[IndentingNewLine]{y, p[\([\)\(2\)\(]\)], 
            q[\([\)\(2\)\(]\)], 1}];\)\), "\n", 
    \(\(ListContourPlot[img, Contours \[Rule] {0}];\)\)}], "Input"],

Cell[BoxData[
    \({38, 38, 38}\)], "Output"],

Cell[BoxData[
    \({212, 212, 212}\)], "Output"],

Cell[BoxData[
    RowBox[{\(ArcTan::"indet"\), \(\(:\)\(\ \)\), "\<\"Indeterminate \
expression \\!\\(ArcTan[\\(\\(0, 0\\)\\)]\\) encountered. \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"General::indet\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(p = \((center - radius)\)/dh - BUF // Floor\), "\[IndentingNewLine]", 
    \(q = 
      2*\((\((radius)\)/dh + BUF)\) + p // Floor\), "\[IndentingNewLine]", 
    \(\(z = \(Mean[{q, p}]\)[\([1]\)];\)\), "\[IndentingNewLine]", 
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(Table[\[IndentingNewLine]img = 
        Table[\[IndentingNewLine]X = 
            x*dh - center[\([\)\(1\)\(]\)]; \[IndentingNewLine]Y = 
            y*dh - center[\([\)\(2\)\(]\)]; \[IndentingNewLine]Z = 
            z*dh - center[\([\)\(3\)\(]\)]; \[IndentingNewLine]A = \(radius + \
amp + amp*Cos[numPetals*ArcTan[Y, X]]\)\/radius; \[IndentingNewLine]phi = \
\@\(X\^2\/A + Y\^2\/A + Z\^2\) - radius; \[IndentingNewLine]If[
            phi === Indeterminate, phi = 0]; \[IndentingNewLine]Which[
            phi/dh > thres, 1, phi/dh < \(-thres\), \(-1\), True, 
            0]; \[IndentingNewLine]phi\[IndentingNewLine], \
\[IndentingNewLine]{x, p[\([\)\(1\)\(]\)], q[\([\)\(1\)\(]\)], 
            1}, \[IndentingNewLine]{y, p[\([\)\(2\)\(]\)], 
            q[\([\)\(2\)\(]\)], 1}]; \n
      ListContourPlot[img, Contours \[Rule] {0}];\[IndentingNewLine], {z, 
        p[\([3]\)], q[\([3]\)], 1}]\)}], "Input"],

Cell[BoxData[
    \({38, 38, 38}\)], "Output"],

Cell[BoxData[
    \({212, 212, 212}\)], "Output"],

Cell[BoxData[
    RowBox[{\(ArcTan::"indet"\), \(\(:\)\(\ \)\), "\<\"Indeterminate \
expression \\!\\(ArcTan[\\(\\(0, 0\\)\\)]\\) encountered. \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"General::indet\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(ContourGraphics :: \\\"ctpnt\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ArcTan::"indet"\), \(\(:\)\(\ \)\), "\<\"Indeterminate \
expression \\!\\(ArcTan[\\(\\(0, 0\\)\\)]\\) encountered. \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"General::indet\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ArcTan::"indet"\), \(\(:\)\(\ \)\), "\<\"Indeterminate \
expression \\!\\(ArcTan[\\(\\(0, 0\\)\\)]\\) encountered. \\!\\(\\*ButtonBox[\
\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", \
ButtonFrame->None, ButtonData:>\\\"General::indet\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(ArcTan :: \\\"indet\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(numPetals = 8;\)\), "\[IndentingNewLine]", 
    \(\(Plot[\(radius + amp + amp*Cos[numPetals*a*\[Pi]]\)\/radius, {a, \
\(-1\), 1}];\)\)}], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["rect", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"grid.10000.Real64", "grid.10000.Real64.info", "grid.pos", 
      "grid.size", "irregNode.10000.array"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\n", 
    \(Dimensions[phi]\)}], "Input"],

Cell[BoxData[
    \({2}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([1]\)]];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([2]\)]];\)\)}], "Input"],

Cell[BoxData[
    \(ImportIrreg["\<irregNode.10000.array\>"]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Length[ir`X]\)], "Input"],

Cell[BoxData[
    \(874\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(shift = Total /@ ir`shift;\)\), "\n", 
    \(\(X = Pick[ir`X, Thread[shift \[Equal] 0]];\)\), "\n", 
    \(ListPlot[X]\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(ListDensityPlot[phi[\([1]\)], 
      Epilog \[Rule] {Green, \(Point[# - pos[\([1]\)] + 0.5] &\) /@ 
            X}]\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  DensityGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(DisplayTogether[\[IndentingNewLine]ListDensityPlot[
        phi[\([2]\)]], \[IndentingNewLine]ListContourPlot[
        phi[\([2]\)]]]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["AdvectSL RK2", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"irregNode.10000.array", "irregNode.10000.array.info", 
      "irregNode.10001.array", "irregNode.10001.array.info", 
      "irregNode.10002.array", "irregNode.10002.array.info", 
      "irregNode.10003.array", "irregNode.10003.array.info", 
      "irregNode.10004.array", "irregNode.10004.array.info", 
      "irregNode.10005.array", "irregNode.10005.array.info", 
      "irregNode.10006.array", "irregNode.10006.array.info", 
      "irregNode.10007.array", "irregNode.10007.array.info", 
      "irregNode.10008.array", "irregNode.10008.array.info", 
      "irregNode.10009.array", "irregNode.10009.array.info"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(X = 
        Map[Function[
            t, \[IndentingNewLine]ImportIrreg["\<irregNode.\>" <> 
                ToString[
                  t + 10000] <> "\<.array\>"]; \[IndentingNewLine]ir`X], 
          Range[0, 9]];\)\), "\[IndentingNewLine]", 
    \(Dimensions[X]\)}], "Input"],

Cell[BoxData[
    \({10}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListPlot[#, AspectRatio \[Rule] Automatic, 
            PlotRange \[Rule] {{\(-11\), 11}, {\(-11\), 11}}] &\) /@ 
        X;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Plot[Cos[2  \[Pi]\ t], {t, 0, 1}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Bicubic Interpolation", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Clear[x, y]\), "\[IndentingNewLine]", 
    \(X = Table[x\^m*y\^n, {n, 0, 3}, {m, 0, 3}] // Flatten\)}], "Input"],

Cell[BoxData[
    \({1, x, x\^2, x\^3, y, x\ y, x\^2\ y, x\^3\ y, y\^2, x\ y\^2, 
      x\^2\ y\^2, x\^3\ y\^2, y\^3, x\ y\^3, x\^2\ y\^3, 
      x\^3\ y\^3}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(coor = 
      Table[{x \[Rule] m, y \[Rule] n}, {n, 0, 1}, {m, 0, 1}] // 
        Flatten[#, 1] &\)], "Input"],

Cell[BoxData[
    \({{x \[Rule] 0, y \[Rule] 0}, {x \[Rule] 1, y \[Rule] 0}, {x \[Rule] 0, 
        y \[Rule] 1}, {x \[Rule] 1, y \[Rule] 1}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(mat = {X, D[X, x], D[X, y], D[X, x, y]} /. {x \[Rule] 0, 
            y \[Rule] 0};\)\), "\[IndentingNewLine]", 
    \(MatrixForm[Join[{X}, mat]]\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "x", \(x\^2\), \(x\^3\), 
              "y", \(x\ y\), \(x\^2\ y\), \(x\^3\ y\), \(y\^2\), \(x\ y\^2\), \
\(x\^2\ y\^2\), \(x\^3\ y\^2\), \(y\^3\), \(x\ y\^3\), \(x\^2\ y\^3\), \(x\^3\
\ y\^3\)},
            {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0"},
            {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0"},
            {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0"},
            {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(mat = \({X, D[X, x], D[X, y], D[X, x, y]} /. coor // Transpose\) // 
          Flatten[#, 1] &;\)\), "\[IndentingNewLine]", 
    \(\(matRows = \({XX, Dx, Dy, Dxy} /. coor // Transpose\) // 
          Flatten[#, 1] &;\)\), "\[IndentingNewLine]", 
    \(MatrixForm /@ {mat, matRows}\)}], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
                {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"1", "1", "1", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"1", "0", "0", "0", "1", "0", "0", "0", "1", "0", "0", "0", 
                  "1", "0", "0", "0"},
                {"1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", 
                  "1", "1", "1", "1"},
                {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "1", "2", "3", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "1", "0", "0", "0", "1", "0", "0", "0", "1", "0", "0", 
                  "0", "1", "0", "0"},
                {"0", "1", "2", "3", "0", "1", "2", "3", "0", "1", "2", "3", 
                  "0", "1", "2", "3"},
                {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "1", "1", "1", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "0", "0", "0", "2", "0", "0", "0", 
                  "3", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "1", "1", "1", "2", "2", "2", "2", 
                  "3", "3", "3", "3"},
                {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "1", "2", "3", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "1", "0", "0", "0", "2", "0", "0", 
                  "0", "3", "0", "0"},
                {"0", "0", "0", "0", "0", "1", "2", "3", "0", "2", "4", "6", 
                  "0", "3", "6", "9"}
                },
              RowSpacings->1,
              ColumnSpacings->1,
              ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]], ",", 
        TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[GridBox[{
                  {"XX"},
                  {"XX"},
                  {"XX"},
                  {"XX"},
                  {"Dx"},
                  {"Dx"},
                  {"Dx"},
                  {"Dx"},
                  {"Dy"},
                  {"Dy"},
                  {"Dy"},
                  {"Dy"},
                  {"Dxy"},
                  {"Dxy"},
                  {"Dxy"},
                  {"Dxy"}
                  },
                RowSpacings->1,
                ColumnAlignments->{Left}],
              Column], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(imat = Inverse[mat];\)\), "\[IndentingNewLine]", 
    \(imat // MatrixForm\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0"},
            {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0"},
            {\(-3\), "3", "0", "0", \(-2\), \(-1\), "0", "0", "0", "0", "0", 
              "0", "0", "0", "0", "0"},
            {"2", \(-2\), "0", "0", "1", "1", "0", "0", "0", "0", "0", "0", 
              "0", "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", "0", 
              "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "1", 
              "0", "0", "0"},
            {"0", "0", "0", "0", "0", "0", "0", "0", \(-3\), "3", "0", 
              "0", \(-2\), \(-1\), "0", "0"},
            {"0", "0", "0", "0", "0", "0", "0", "0", "2", \(-2\), "0", "0", 
              "1", "1", "0", "0"},
            {\(-3\), "0", "3", "0", "0", "0", "0", "0", \(-2\), "0", \(-1\), 
              "0", "0", "0", "0", "0"},
            {"0", "0", "0", "0", \(-3\), "0", "3", "0", "0", "0", "0", 
              "0", \(-2\), "0", \(-1\), "0"},
            {"9", \(-9\), \(-9\), "9", "6", "3", \(-6\), \(-3\), "6", \(-6\), 
              "3", \(-3\), "4", "2", "2", "1"},
            {\(-6\), "6", "6", \(-6\), \(-3\), \(-3\), "3", "3", \(-4\), 
              "4", \(-2\), "2", \(-2\), \(-2\), \(-1\), \(-1\)},
            {"2", "0", \(-2\), "0", "0", "0", "0", "0", "1", "0", "1", "0", 
              "0", "0", "0", "0"},
            {"0", "0", "0", "0", "2", "0", \(-2\), "0", "0", "0", "0", "0", 
              "1", "0", "1", "0"},
            {\(-6\), "6", "6", \(-6\), \(-4\), \(-2\), "4", "2", \(-3\), 
              "3", \(-3\), "3", \(-2\), \(-1\), \(-2\), \(-1\)},
            {"4", \(-4\), \(-4\), "4", "2", "2", \(-2\), \(-2\), "2", \(-2\), 
              "2", \(-2\), "1", "1", "1", "1"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\[Phi] =. \), "\n", 
    \(\(D\[Phi]x := \(\[Phi][x + 1, y] - \[Phi][x - 1, y]\)\/2;\)\), "\n", 
    \(\(D\[Phi]y := \(\[Phi][x, y + 1] - \[Phi][x, y - 1]\)\/2;\)\), "\n", 
    \(\(D\[Phi]xy := \(\[Phi][x + 1, y + 1] + \[Phi][x - 1, y - 1] - \[Phi][x \
+ 1, y - 1] - \[Phi][x - 1, y + 1]\)\/4;\)\), "\n", 
    \(\(rhs = \({\[Phi][x, y], D\[Phi]x, D\[Phi]y, D\[Phi]xy} /. coor // 
            Transpose\) // Flatten[#, 1] &;\)\), "\n", 
    \(MatrixForm /@ {mat, matRows, N@rhs}\)}], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
                {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"1", "1", "1", "1", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"1", "0", "0", "0", "1", "0", "0", "0", "1", "0", "0", "0", 
                  "1", "0", "0", "0"},
                {"1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", 
                  "1", "1", "1", "1"},
                {"0", "1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "1", "2", "3", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "1", "0", "0", "0", "1", "0", "0", "0", "1", "0", "0", 
                  "0", "1", "0", "0"},
                {"0", "1", "2", "3", "0", "1", "2", "3", "0", "1", "2", "3", 
                  "0", "1", "2", "3"},
                {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "1", "1", "1", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "0", "0", "0", "2", "0", "0", "0", 
                  "3", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "1", "1", "1", "2", "2", "2", "2", 
                  "3", "3", "3", "3"},
                {"0", "0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "1", "2", "3", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "1", "0", "0", "0", "2", "0", "0", 
                  "0", "3", "0", "0"},
                {"0", "0", "0", "0", "0", "1", "2", "3", "0", "2", "4", "6", 
                  "0", "3", "6", "9"}
                },
              RowSpacings->1,
              ColumnSpacings->1,
              ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]], ",", 
        TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[GridBox[{
                  {"XX"},
                  {"XX"},
                  {"XX"},
                  {"XX"},
                  {"Dx"},
                  {"Dx"},
                  {"Dx"},
                  {"Dx"},
                  {"Dy"},
                  {"Dy"},
                  {"Dy"},
                  {"Dy"},
                  {"Dxy"},
                  {"Dxy"},
                  {"Dxy"},
                  {"Dxy"}
                  },
                RowSpacings->1,
                ColumnAlignments->{Left}],
              Column], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]], ",", 
        TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[GridBox[{
                  {\(\[Phi][0.`, 0.`]\)},
                  {\(\[Phi][1.`, 0.`]\)},
                  {\(\[Phi][0.`, 1.`]\)},
                  {\(\[Phi][1.`, 1.`]\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][\(-1.`\), 0.`] + \[Phi][1.`, 
                            0.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][0.`, 0.`] + \[Phi][2.`, 
                            0.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][\(-1.`\), 1.`] + \[Phi][1.`, 
                            1.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][0.`, 1.`] + \[Phi][2.`, 
                            1.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][0.`, \(-1.`\)] + \[Phi][0.`, 
                            1.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][1.`, \(-1.`\)] + \[Phi][1.`, 
                            1.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][0.`, 0.`] + \[Phi][0.`, 
                            2.`])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ \[Phi][1.`, 0.`] + \[Phi][1.`, 
                            2.`])\)\)},
                  {\(0.25`\ \((\[Phi][\(-1.`\), \(-1.`\)] - 
                          1.`\ \[Phi][\(-1.`\), 1.`] - 
                          1.`\ \[Phi][1.`, \(-1.`\)] + \[Phi][1.`, 
                            1.`])\)\)},
                  {\(0.25`\ \((\[Phi][0.`, \(-1.`\)] - 
                          1.`\ \[Phi][0.`, 1.`] - 
                          1.`\ \[Phi][2.`, \(-1.`\)] + \[Phi][2.`, 
                            1.`])\)\)},
                  {\(0.25`\ \((\[Phi][\(-1.`\), 0.`] - 
                          1.`\ \[Phi][\(-1.`\), 2.`] - 
                          1.`\ \[Phi][1.`, 0.`] + \[Phi][1.`, 2.`])\)\)},
                  {\(0.25`\ \((\[Phi][0.`, 0.`] - 1.`\ \[Phi][0.`, 2.`] - 
                          1.`\ \[Phi][2.`, 0.`] + \[Phi][2.`, 2.`])\)\)}
                  },
                RowSpacings->1,
                ColumnAlignments->{Left}],
              Column], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(coor16 = 
      Table[{x \[Rule] m, y \[Rule] n}, {n, \(-1\), 2}, {m, \(-1\), 
          2}]\)], "Input"],

Cell[BoxData[
    \({{{x \[Rule] \(-1\), y \[Rule] \(-1\)}, {x \[Rule] 0, 
          y \[Rule] \(-1\)}, {x \[Rule] 1, y \[Rule] \(-1\)}, {x \[Rule] 2, 
          y \[Rule] \(-1\)}}, {{x \[Rule] \(-1\), y \[Rule] 0}, {x \[Rule] 0, 
          y \[Rule] 0}, {x \[Rule] 1, y \[Rule] 0}, {x \[Rule] 2, 
          y \[Rule] 0}}, {{x \[Rule] \(-1\), y \[Rule] 1}, {x \[Rule] 0, 
          y \[Rule] 1}, {x \[Rule] 1, y \[Rule] 1}, {x \[Rule] 2, 
          y \[Rule] 1}}, {{x \[Rule] \(-1\), y \[Rule] 2}, {x \[Rule] 0, 
          y \[Rule] 2}, {x \[Rule] 1, y \[Rule] 2}, {x \[Rule] 2, 
          y \[Rule] 2}}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(a = Table[Random[], {16}];\)\), "\[IndentingNewLine]", 
    \(\(a = {0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 
            0}\ a;\)\), "\[IndentingNewLine]", 
    \(Length[a]\)}], "Input"],

Cell[BoxData[
    \(16\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(\[Phi] = 
        Function[{i, j}, 
          a . X /. {x \[Rule] i, y \[Rule] j}];\)\), "\[IndentingNewLine]", 
    \(\(sol = imat . rhs;\)\), "\[IndentingNewLine]", 
    \(TableForm[{matRows, rhs}]\), "\[IndentingNewLine]", 
    \(TableForm[{X, a, sol}]\)}], "Input"],

Cell[BoxData[
    TagBox[GridBox[{
          {"XX", "XX", "XX", "XX", "Dx", "Dx", "Dx", "Dx", "Dy", "Dy", "Dy", 
            "Dy", "Dxy", "Dxy", "Dxy", "Dxy"},
          {"0", "1.0872210613887354`", "0.7847719409261649`", 
            "3.1436680463834463`", "0.34700759661493413`", 
            "1.8274345261625369`", "1.1408159750288527`", 
            "3.576976235885711`", "0.3221061162653994`", 
            "0.5233564816393619`", "1.2474377655869304`", "3.58953748835006`",
             "0.015509615486343886`", "0.3869911152615815`", 
            "1.5721071413414933`", "3.1120923041847663`"}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      Function[ BoxForm`e$, 
        TableForm[ BoxForm`e$]]]], "Output"],

Cell[BoxData[
    TagBox[GridBox[{
          {"1", "x", \(x\^2\), \(x\^3\), 
            "y", \(x\ y\), \(x\^2\ y\), \(x\^3\ y\), \(y\^2\), \(x\ y\^2\), \
\(x\^2\ y\^2\), \(x\^3\ y\^2\), \(y\^3\), \(x\ y\^3\), \(x\^2\ y\^3\), \(x\^3\
\ y\^3\)},
          {"0", "0.3470075966149342`", "0.7402134647738013`", "0", 
            "0.3221061162653994`", "0.0155096154863439`", 
            "0.1857407498876186`", "0", "0.46266582466076545`", 
            "0.7782987629275748`", "0.29212591576700897`", "0", "0", "0", "0",
             "0"},
          {"0.`", "0.34700759661493413`", "0.7402134647738011`", 
            "1.6653345369377348`*^-16", "0.3221061162653994`", 
            "0.015509615486343886`", "0.18574074988761813`", 
            "4.440892098500626`*^-16", "0.46266582466076533`", 
            "0.7782987629275746`", "0.2921259157670085`", 
            "6.106226635438361`*^-16", "1.1102230246251565`*^-16", 
            "1.1102230246251565`*^-16", 
            "1.1102230246251565`*^-16", \(-3.3306690738754696`*^-16\)}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      Function[ BoxForm`e$, 
        TableForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code Generation", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(phi =. ;\)\), "\[IndentingNewLine]", 
    \(\(D\[Phi]x := \(phi[\([j + y, i + x + 1]\)] - phi[\([j + y, i + x - \
1]\)]\)\/2;\)\), "\[IndentingNewLine]", 
    \(\(D\[Phi]y := \(phi[\([j + y + 1, i + x]\)] - phi[\([j + y - 1, i + \
x]\)]\)\/2;\)\), "\[IndentingNewLine]", 
    \(\(\(D\[Phi]xy := \(phi[\([j + y + 1, i + x + 1]\)] + phi[\([j + y - 1, \
i + x - 1]\)] - phi[\([j + y - 1, i + x + 1]\)] - phi[\([j + y + 1, i + x - \
1]\)]\)\/4;\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(\(coor = 
      Table[{x \[Rule] m, y \[Rule] n}, {n, 1, 2}, {m, 1, 2}] // 
        Flatten[#, 1] &\)\(\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(rhs = \({phi[\([j + y, i + x]\)], D\[Phi]x, D\[Phi]y, D\[Phi]xy} /. 
              coor // Transpose\) // Flatten[#, 1] &;\)\), "\n", 
    \(MatrixForm /@ {imat, matRows, N@rhs}\)}], "Input"],

Cell[BoxData[
    \({{x \[Rule] 1, y \[Rule] 1}, {x \[Rule] 2, y \[Rule] 1}, {x \[Rule] 1, 
        y \[Rule] 2}, {x \[Rule] 2, y \[Rule] 2}}\)], "Output"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(j + y\\) is neither an integer nor a list of integers. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(j + y\\) is neither an integer nor a list of integers. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(Part::"pspec"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(j + y\\) is neither an integer nor a list of integers. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::pspec\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Part :: \\\"pspec\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
                {"1", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "1", "0", "0", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {\(-3\), "3", "0", "0", \(-2\), \(-1\), "0", "0", "0", "0", 
                  "0", "0", "0", "0", "0", "0"},
                {"2", \(-2\), "0", "0", "1", "1", "0", "0", "0", "0", "0", 
                  "0", "0", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "0", "0", "0", "1", "0", "0", "0", 
                  "0", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", "0", 
                  "1", "0", "0", "0"},
                {"0", "0", "0", "0", "0", "0", "0", "0", \(-3\), "3", "0", 
                  "0", \(-2\), \(-1\), "0", "0"},
                {"0", "0", "0", "0", "0", "0", "0", "0", "2", \(-2\), "0", 
                  "0", "1", "1", "0", "0"},
                {\(-3\), "0", "3", "0", "0", "0", "0", "0", \(-2\), 
                  "0", \(-1\), "0", "0", "0", "0", "0"},
                {"0", "0", "0", "0", \(-3\), "0", "3", "0", "0", "0", "0", 
                  "0", \(-2\), "0", \(-1\), "0"},
                {"9", \(-9\), \(-9\), "9", "6", "3", \(-6\), \(-3\), 
                  "6", \(-6\), "3", \(-3\), "4", "2", "2", "1"},
                {\(-6\), "6", "6", \(-6\), \(-3\), \(-3\), "3", "3", \(-4\), 
                  "4", \(-2\), "2", \(-2\), \(-2\), \(-1\), \(-1\)},
                {"2", "0", \(-2\), "0", "0", "0", "0", "0", "1", "0", "1", 
                  "0", "0", "0", "0", "0"},
                {"0", "0", "0", "0", "2", "0", \(-2\), "0", "0", "0", "0", 
                  "0", "1", "0", "1", "0"},
                {\(-6\), "6", "6", \(-6\), \(-4\), \(-2\), "4", "2", \(-3\), 
                  "3", \(-3\), "3", \(-2\), \(-1\), \(-2\), \(-1\)},
                {"4", \(-4\), \(-4\), "4", "2", "2", \(-2\), \(-2\), 
                  "2", \(-2\), "2", \(-2\), "1", "1", "1", "1"}
                },
              RowSpacings->1,
              ColumnSpacings->1,
              ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]], ",", 
        TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[GridBox[{
                  {"XX"},
                  {"XX"},
                  {"XX"},
                  {"XX"},
                  {"Dx"},
                  {"Dx"},
                  {"Dx"},
                  {"Dx"},
                  {"Dy"},
                  {"Dy"},
                  {"Dy"},
                  {"Dy"},
                  {"Dxy"},
                  {"Dxy"},
                  {"Dxy"},
                  {"Dxy"}
                  },
                RowSpacings->1,
                ColumnAlignments->{Left}],
              Column], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]], ",", 
        TagBox[
          RowBox[{"(", "\[NoBreak]", 
            TagBox[GridBox[{
                  {\(phi\[LeftDoubleBracket]1 + j, 
                      1 + i\[RightDoubleBracket]\)},
                  {\(phi\[LeftDoubleBracket]1 + j, 
                      2 + i\[RightDoubleBracket]\)},
                  {\(phi\[LeftDoubleBracket]2 + j, 
                      1 + i\[RightDoubleBracket]\)},
                  {\(phi\[LeftDoubleBracket]2 + j, 
                      2 + i\[RightDoubleBracket]\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]1 + j, 
                              i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]1 + j, 
                            2 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]1 + j, 
                              1 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]1 + j, 
                            3 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]2 + j, 
                              i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]2 + j, 
                            2 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]2 + j, 
                              1 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]2 + j, 
                            3 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]j, 
                              1 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]2 + j, 
                            1 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]j, 
                              2 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]2 + j, 
                            2 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]1 + j, 
                              1 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]3 + j, 
                            1 + i\[RightDoubleBracket])\)\)},
                  {\(0.5`\ \((\(-1.`\)\ phi\[LeftDoubleBracket]1 + j, 
                              2 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]3 + j, 
                            2 + i\[RightDoubleBracket])\)\)},
                  {\(0.25`\ \((phi\[LeftDoubleBracket]j, 
                            i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]j, 
                              2 + i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]2 + j, 
                              i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]2 + j, 
                            2 + i\[RightDoubleBracket])\)\)},
                  {\(0.25`\ \((phi\[LeftDoubleBracket]j, 
                            1 + i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]j, 
                              3 + i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]2 + j, 
                              1 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]2 + j, 
                            3 + i\[RightDoubleBracket])\)\)},
                  {\(0.25`\ \((phi\[LeftDoubleBracket]1 + j, 
                            i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]1 + j, 
                              2 + i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]3 + j, 
                              i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]3 + j, 
                            2 + i\[RightDoubleBracket])\)\)},
                  {\(0.25`\ \((phi\[LeftDoubleBracket]1 + j, 
                            1 + i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]1 + j, 
                              3 + i\[RightDoubleBracket] - 
                          1.`\ phi\[LeftDoubleBracket]3 + j, 
                              1 + i\[RightDoubleBracket] + 
                          phi\[LeftDoubleBracket]3 + j, 
                            3 + i\[RightDoubleBracket])\)\)}
                  },
                RowSpacings->1,
                ColumnAlignments->{Left}],
              Column], "\[NoBreak]", ")"}],
          Function[ BoxForm`e$, 
            MatrixForm[ BoxForm`e$]]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(code = \(ToString[CForm[#]] &\) /@ \((imat . 
              rhs)\);\)\), "\[IndentingNewLine]", 
    \(\(code = 
        StringReplace[
          code, "\<Symbol\>" \[Rule] "\<phi[j][i]\>"];\)\), "\
\[IndentingNewLine]", 
    \(TableForm[code]\)}], "Input"],

Cell[BoxData[
    InterpretationBox[GridBox[{
          {"\<\"phi[1 + j][1 + i]\"\>"},
          {"\<\"(-phi[1 + j][i] + phi[1 + j][2 + i])/2.\"\>"},
          {"\<\"phi[1 + j][i] - 3*phi[1 + j][1 + i] + 2*phi[1 + j][2 + i] + \
(phi[1 + j][1 + i] - phi[1 + j][3 + i])/2.\"\>"},
          {"\<\"2*phi[1 + j][1 + i] - 2*phi[1 + j][2 + i] + (-phi[1 + j][i] + \
phi[1 + j][2 + i])/2. + (-phi[1 + j][1 + i] + phi[1 + j][3 + i])/2.\"\>"},
          {"\<\"(-phi[j][1 + i] + phi[2 + j][1 + i])/2.\"\>"},
          {"\<\"(phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + \
i])/4.\"\>"},
          {"\<\"(-3*(-phi[j][1 + i] + phi[2 + j][1 + i]))/2. + (-phi[j][i] + \
phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. + (3*(-phi[j][2 + i] + \
phi[2 + j][2 + i]))/2. + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] \
- phi[2 + j][3 + i])/4.\"\>"},
          {"\<\"-phi[j][1 + i] + phi[j][2 + i] + phi[2 + j][1 + i] - phi[2 + \
j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + \
i])/4. + (phi[j][1 + i] - phi[j][3 + i] - phi[2 + j][1 + i] + phi[2 + j][3 + \
i])/4.\"\>"},
          {"\<\"phi[j][1 + i] - 3*phi[1 + j][1 + i] + 2*phi[2 + j][1 + i] + \
(phi[1 + j][1 + i] - phi[3 + j][1 + i])/2.\"\>"},
          {"\<\"(-3*(-phi[1 + j][i] + phi[1 + j][2 + i]))/2. + (-phi[j][i] + \
phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. + (3*(-phi[2 + j][i] + \
phi[2 + j][2 + i]))/2. + (-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] \
- phi[3 + j][2 + i])/4.\"\>"},
          {"\<\"phi[j][i] - phi[j][2 + i] + 9*phi[1 + j][1 + i] - 9*phi[1 + \
j][2 + i] + 3*(-phi[1 + j][i] + phi[1 + j][2 + i]) + (3*(-phi[1 + j][1 + i] + \
phi[1 + j][3 + i]))/2. - phi[2 + j][i] - 9*phi[2 + j][1 + i] + 3*(-phi[j][1 + \
i] + phi[2 + j][1 + i]) + 10*phi[2 + j][2 + i] - 3*(-phi[j][2 + i] + phi[2 + \
j][2 + i]) - 3*(-phi[2 + j][i] + phi[2 + j][2 + i]) - (3*(-phi[2 + j][1 + i] \
+ phi[2 + j][3 + i]))/2. + (phi[j][1 + i] - phi[j][3 + i] - phi[2 + j][1 + i] \
+ phi[2 + j][3 + i])/2. + (3*(-phi[1 + j][1 + i] + phi[3 + j][1 + i]))/2. - \
(3*(-phi[1 + j][2 + i] + phi[3 + j][2 + i]))/2. + (phi[1 + j][i] - phi[1 + \
j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + i])/2. + (phi[1 + j][1 + i] - \
phi[1 + j][3 + i] - phi[3 + j][1 + i] + phi[3 + j][3 + i])/4.\"\>"},
          {"\<\"-5*phi[1 + j][1 + i] + 5*phi[1 + j][2 + i] - (3*(-phi[1 + \
j][i] + phi[1 + j][2 + i]))/2. - (3*(-phi[1 + j][1 + i] + phi[1 + j][3 + \
i]))/2. + 6*phi[2 + j][1 + i] - 2*(-phi[j][1 + i] + phi[2 + j][1 + i]) + \
(-phi[j][i] + phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. - 6*phi[2 \
+ j][2 + i] + 2*(-phi[j][2 + i] + phi[2 + j][2 + i]) + (3*(-phi[2 + j][i] + \
phi[2 + j][2 + i]))/2. + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] \
- phi[2 + j][3 + i])/2. + (3*(-phi[2 + j][1 + i] + phi[2 + j][3 + i]))/2. - \
phi[3 + j][1 + i] + (-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] - \
phi[3 + j][2 + i])/4. + phi[3 + j][2 + i] + (-phi[1 + j][1 + i] + phi[1 + \
j][3 + i] + phi[3 + j][1 + i] - phi[3 + j][3 + i])/4.\"\>"},
          {"\<\"2*phi[1 + j][1 + i] - 2*phi[2 + j][1 + i] + (-phi[j][1 + i] + \
phi[2 + j][1 + i])/2. + (-phi[1 + j][1 + i] + phi[3 + j][1 + i])/2.\"\>"},
          {"\<\"-phi[1 + j][i] + phi[1 + j][2 + i] + phi[2 + j][i] - phi[2 + \
j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + \
i])/4. + (phi[1 + j][i] - phi[1 + j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + \
i])/4.\"\>"},
          {"\<\"-5*phi[1 + j][1 + i] + 6*phi[1 + j][2 + i] - 2*(-phi[1 + \
j][i] + phi[1 + j][2 + i]) - phi[1 + j][3 + i] + 5*phi[2 + j][1 + i] - \
(3*(-phi[j][1 + i] + phi[2 + j][1 + i]))/2. + (-phi[j][i] + phi[j][2 + i] + \
phi[2 + j][i] - phi[2 + j][2 + i])/2. - 6*phi[2 + j][2 + i] + (3*(-phi[j][2 + \
i] + phi[2 + j][2 + i]))/2. + 2*(-phi[2 + j][i] + phi[2 + j][2 + i]) + \
(-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] - phi[2 + j][3 + i])/4. + \
phi[2 + j][3 + i] - (3*(-phi[1 + j][1 + i] + phi[3 + j][1 + i]))/2. + (-phi[1 \
+ j][i] + phi[1 + j][2 + i] + phi[3 + j][i] - phi[3 + j][2 + i])/2. + \
(3*(-phi[1 + j][2 + i] + phi[3 + j][2 + i]))/2. + (-phi[1 + j][1 + i] + phi[1 \
+ j][3 + i] + phi[3 + j][1 + i] - phi[3 + j][3 + i])/4.\"\>"},
          {"\<\"-phi[j][1 + i] + phi[j][2 + i] - phi[1 + j][i] + 2*phi[1 + \
j][1 + i] - 2*phi[1 + j][2 + i] + phi[1 + j][3 + i] + phi[2 + j][i] - 2*phi[2 \
+ j][1 + i] + 2*phi[2 + j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + \
j][i] + phi[2 + j][2 + i])/4. - phi[2 + j][3 + i] + (phi[j][1 + i] - phi[j][3 \
+ i] - phi[2 + j][1 + i] + phi[2 + j][3 + i])/4. + phi[3 + j][1 + i] - phi[3 \
+ j][2 + i] + (phi[1 + j][i] - phi[1 + j][2 + i] - phi[3 + j][i] + phi[3 + \
j][2 + i])/4. + (phi[1 + j][1 + i] - phi[1 + j][3 + i] - phi[3 + j][1 + i] + \
phi[3 + j][3 + i])/4.\"\>"}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      TableForm[ {"phi[1 + j][1 + i]", 
        "(-phi[1 + j][i] + phi[1 + j][2 + i])/2.", 
        "phi[1 + j][i] - 3*phi[1 + j][1 + i] + 2*phi[1 + j][2 + i] + (phi[1 + \
j][1 + i] - phi[1 + j][3 + i])/2.", 
        "2*phi[1 + j][1 + i] - 2*phi[1 + j][2 + i] + (-phi[1 + j][i] + phi[1 \
+ j][2 + i])/2. + (-phi[1 + j][1 + i] + phi[1 + j][3 + i])/2.", 
        "(-phi[j][1 + i] + phi[2 + j][1 + i])/2.", 
        "(phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + i])/4.", 
        "(-3*(-phi[j][1 + i] + phi[2 + j][1 + i]))/2. + (-phi[j][i] + \
phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. + (3*(-phi[j][2 + i] + \
phi[2 + j][2 + i]))/2. + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] \
- phi[2 + j][3 + i])/4.", 
        "-phi[j][1 + i] + phi[j][2 + i] + phi[2 + j][1 + i] - phi[2 + j][2 + \
i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + i])/4. + \
(phi[j][1 + i] - phi[j][3 + i] - phi[2 + j][1 + i] + phi[2 + j][3 + i])/4.", 
        "phi[j][1 + i] - 3*phi[1 + j][1 + i] + 2*phi[2 + j][1 + i] + (phi[1 + \
j][1 + i] - phi[3 + j][1 + i])/2.", 
        "(-3*(-phi[1 + j][i] + phi[1 + j][2 + i]))/2. + (-phi[j][i] + \
phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. + (3*(-phi[2 + j][i] + \
phi[2 + j][2 + i]))/2. + (-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] \
- phi[3 + j][2 + i])/4.", 
        "phi[j][i] - phi[j][2 + i] + 9*phi[1 + j][1 + i] - 9*phi[1 + j][2 + \
i] + 3*(-phi[1 + j][i] + phi[1 + j][2 + i]) + (3*(-phi[1 + j][1 + i] + phi[1 \
+ j][3 + i]))/2. - phi[2 + j][i] - 9*phi[2 + j][1 + i] + 3*(-phi[j][1 + i] + \
phi[2 + j][1 + i]) + 10*phi[2 + j][2 + i] - 3*(-phi[j][2 + i] + phi[2 + j][2 \
+ i]) - 3*(-phi[2 + j][i] + phi[2 + j][2 + i]) - (3*(-phi[2 + j][1 + i] + \
phi[2 + j][3 + i]))/2. + (phi[j][1 + i] - phi[j][3 + i] - phi[2 + j][1 + i] + \
phi[2 + j][3 + i])/2. + (3*(-phi[1 + j][1 + i] + phi[3 + j][1 + i]))/2. - \
(3*(-phi[1 + j][2 + i] + phi[3 + j][2 + i]))/2. + (phi[1 + j][i] - phi[1 + \
j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + i])/2. + (phi[1 + j][1 + i] - \
phi[1 + j][3 + i] - phi[3 + j][1 + i] + phi[3 + j][3 + i])/4.", 
        "-5*phi[1 + j][1 + i] + 5*phi[1 + j][2 + i] - (3*(-phi[1 + j][i] + \
phi[1 + j][2 + i]))/2. - (3*(-phi[1 + j][1 + i] + phi[1 + j][3 + i]))/2. + \
6*phi[2 + j][1 + i] - 2*(-phi[j][1 + i] + phi[2 + j][1 + i]) + (-phi[j][i] + \
phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. - 6*phi[2 + j][2 + i] + \
2*(-phi[j][2 + i] + phi[2 + j][2 + i]) + (3*(-phi[2 + j][i] + phi[2 + j][2 + \
i]))/2. + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] - phi[2 + j][3 \
+ i])/2. + (3*(-phi[2 + j][1 + i] + phi[2 + j][3 + i]))/2. - phi[3 + j][1 + \
i] + (-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] - phi[3 + j][2 + \
i])/4. + phi[3 + j][2 + i] + (-phi[1 + j][1 + i] + phi[1 + j][3 + i] + phi[3 \
+ j][1 + i] - phi[3 + j][3 + i])/4.", 
        "2*phi[1 + j][1 + i] - 2*phi[2 + j][1 + i] + (-phi[j][1 + i] + phi[2 \
+ j][1 + i])/2. + (-phi[1 + j][1 + i] + phi[3 + j][1 + i])/2.", 
        "-phi[1 + j][i] + phi[1 + j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + \
i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + i])/4. + \
(phi[1 + j][i] - phi[1 + j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + i])/4.", 
        "-5*phi[1 + j][1 + i] + 6*phi[1 + j][2 + i] - 2*(-phi[1 + j][i] + \
phi[1 + j][2 + i]) - phi[1 + j][3 + i] + 5*phi[2 + j][1 + i] - (3*(-phi[j][1 \
+ i] + phi[2 + j][1 + i]))/2. + (-phi[j][i] + phi[j][2 + i] + phi[2 + j][i] - \
phi[2 + j][2 + i])/2. - 6*phi[2 + j][2 + i] + (3*(-phi[j][2 + i] + phi[2 + \
j][2 + i]))/2. + 2*(-phi[2 + j][i] + phi[2 + j][2 + i]) + (-phi[j][1 + i] + \
phi[j][3 + i] + phi[2 + j][1 + i] - phi[2 + j][3 + i])/4. + phi[2 + j][3 + i] \
- (3*(-phi[1 + j][1 + i] + phi[3 + j][1 + i]))/2. + (-phi[1 + j][i] + phi[1 + \
j][2 + i] + phi[3 + j][i] - phi[3 + j][2 + i])/2. + (3*(-phi[1 + j][2 + i] + \
phi[3 + j][2 + i]))/2. + (-phi[1 + j][1 + i] + phi[1 + j][3 + i] + phi[3 + \
j][1 + i] - phi[3 + j][3 + i])/4.", 
        "-phi[j][1 + i] + phi[j][2 + i] - phi[1 + j][i] + 2*phi[1 + j][1 + i] \
- 2*phi[1 + j][2 + i] + phi[1 + j][3 + i] + phi[2 + j][i] - 2*phi[2 + j][1 + \
i] + 2*phi[2 + j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 \
+ j][2 + i])/4. - phi[2 + j][3 + i] + (phi[j][1 + i] - phi[j][3 + i] - phi[2 \
+ j][1 + i] + phi[2 + j][3 + i])/4. + phi[3 + j][1 + i] - phi[3 + j][2 + i] + \
(phi[1 + j][i] - phi[1 + j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + i])/4. + \
(phi[1 + j][1 + i] - phi[1 + j][3 + i] - phi[3 + j][1 + i] + phi[3 + j][3 + \
i])/4."}]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(powers = 
      StringReplace[#, {"\<Symbol\>" -> "\<a[0]\>", "\<Power(x,2)\>" -> "\<x2\
\>", "\<Power(x,3)\>" -> "\<x3\>", "\<Power(y,2)\>" -> "\<y2\>", \
"\<Power(y,3)\>" -> "\<y3\>"}] &\)], "Input"],

Cell[BoxData[
    \(StringReplace[#1, {"Symbol" \[Rule] "a[0]", "Power(x,2)" \[Rule] "x2", 
          "Power(x,3)" \[Rule] "x3", "Power(y,2)" \[Rule] "y2", 
          "Power(y,3)" \[Rule] "y3"}] &\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(A = Table[a[\([i]\)], {i, 0, 15}]\), "\[IndentingNewLine]", 
    \(Astr = \(powers[ToString[CForm[#]]] &\) /@ A\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(a \[LeftDoubleBracket] 1 \[RightDoubleBracket]\\) is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(a \[LeftDoubleBracket] 2 \[RightDoubleBracket]\\) is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(a \[LeftDoubleBracket] 3 \[RightDoubleBracket]\\) is longer than depth \
of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Part :: \\\"partd\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({Symbol, a\[LeftDoubleBracket]1\[RightDoubleBracket], 
      a\[LeftDoubleBracket]2\[RightDoubleBracket], 
      a\[LeftDoubleBracket]3\[RightDoubleBracket], 
      a\[LeftDoubleBracket]4\[RightDoubleBracket], 
      a\[LeftDoubleBracket]5\[RightDoubleBracket], 
      a\[LeftDoubleBracket]6\[RightDoubleBracket], 
      a\[LeftDoubleBracket]7\[RightDoubleBracket], 
      a\[LeftDoubleBracket]8\[RightDoubleBracket], 
      a\[LeftDoubleBracket]9\[RightDoubleBracket], 
      a\[LeftDoubleBracket]10\[RightDoubleBracket], 
      a\[LeftDoubleBracket]11\[RightDoubleBracket], 
      a\[LeftDoubleBracket]12\[RightDoubleBracket], 
      a\[LeftDoubleBracket]13\[RightDoubleBracket], 
      a\[LeftDoubleBracket]14\[RightDoubleBracket], 
      a\[LeftDoubleBracket]15\[RightDoubleBracket]}\)], "Output"],

Cell[BoxData[
    \({"a[0]", "a[1]", "a[2]", "a[3]", "a[4]", "a[5]", "a[6]", "a[7]", 
      "a[8]", "a[9]", "a[10]", "a[11]", "a[12]", "a[13]", "a[14]", 
      "a[15]"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(code = 
      StringJoin[\(# <> "\<;\n\>" &\) /@ 
          MapThread[
            StringJoin[#1, "\< = \>", #2] &, {Astr, code}]]\)], "Input"],

Cell[BoxData[
    \("a[0] = phi[1 + j][1 + i];\na[1] = (-phi[1 + j][i] + phi[1 + j][2 + \
i])/2.;\na[2] = phi[1 + j][i] - 3*phi[1 + j][1 + i] + 2*phi[1 + j][2 + i] + \
(phi[1 + j][1 + i] - phi[1 + j][3 + i])/2.;\na[3] = 2*phi[1 + j][1 + i] - \
2*phi[1 + j][2 + i] + (-phi[1 + j][i] + phi[1 + j][2 + i])/2. + (-phi[1 + \
j][1 + i] + phi[1 + j][3 + i])/2.;\na[4] = (-phi[j][1 + i] + phi[2 + j][1 + \
i])/2.;\na[5] = (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + j][2 + \
i])/4.;\na[6] = (-3*(-phi[j][1 + i] + phi[2 + j][1 + i]))/2. + (-phi[j][i] + \
phi[j][2 + i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. + (3*(-phi[j][2 + i] + \
phi[2 + j][2 + i]))/2. + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] \
- phi[2 + j][3 + i])/4.;\na[7] = -phi[j][1 + i] + phi[j][2 + i] + phi[2 + \
j][1 + i] - phi[2 + j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + \
phi[2 + j][2 + i])/4. + (phi[j][1 + i] - phi[j][3 + i] - phi[2 + j][1 + i] + \
phi[2 + j][3 + i])/4.;\na[8] = phi[j][1 + i] - 3*phi[1 + j][1 + i] + 2*phi[2 \
+ j][1 + i] + (phi[1 + j][1 + i] - phi[3 + j][1 + i])/2.;\na[9] = (-3*(-phi[1 \
+ j][i] + phi[1 + j][2 + i]))/2. + (-phi[j][i] + phi[j][2 + i] + phi[2 + \
j][i] - phi[2 + j][2 + i])/2. + (3*(-phi[2 + j][i] + phi[2 + j][2 + i]))/2. + \
(-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] - phi[3 + j][2 + i])/4.;\n\
a[10] = phi[j][i] - phi[j][2 + i] + 9*phi[1 + j][1 + i] - 9*phi[1 + j][2 + i] \
+ 3*(-phi[1 + j][i] + phi[1 + j][2 + i]) + (3*(-phi[1 + j][1 + i] + phi[1 + \
j][3 + i]))/2. - phi[2 + j][i] - 9*phi[2 + j][1 + i] + 3*(-phi[j][1 + i] + \
phi[2 + j][1 + i]) + 10*phi[2 + j][2 + i] - 3*(-phi[j][2 + i] + phi[2 + j][2 \
+ i]) - 3*(-phi[2 + j][i] + phi[2 + j][2 + i]) - (3*(-phi[2 + j][1 + i] + \
phi[2 + j][3 + i]))/2. + (phi[j][1 + i] - phi[j][3 + i] - phi[2 + j][1 + i] + \
phi[2 + j][3 + i])/2. + (3*(-phi[1 + j][1 + i] + phi[3 + j][1 + i]))/2. - \
(3*(-phi[1 + j][2 + i] + phi[3 + j][2 + i]))/2. + (phi[1 + j][i] - phi[1 + \
j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + i])/2. + (phi[1 + j][1 + i] - \
phi[1 + j][3 + i] - phi[3 + j][1 + i] + phi[3 + j][3 + i])/4.;\na[11] = \
-5*phi[1 + j][1 + i] + 5*phi[1 + j][2 + i] - (3*(-phi[1 + j][i] + phi[1 + \
j][2 + i]))/2. - (3*(-phi[1 + j][1 + i] + phi[1 + j][3 + i]))/2. + 6*phi[2 + \
j][1 + i] - 2*(-phi[j][1 + i] + phi[2 + j][1 + i]) + (-phi[j][i] + phi[j][2 + \
i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. - 6*phi[2 + j][2 + i] + \
2*(-phi[j][2 + i] + phi[2 + j][2 + i]) + (3*(-phi[2 + j][i] + phi[2 + j][2 + \
i]))/2. + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] - phi[2 + j][3 \
+ i])/2. + (3*(-phi[2 + j][1 + i] + phi[2 + j][3 + i]))/2. - phi[3 + j][1 + \
i] + (-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] - phi[3 + j][2 + \
i])/4. + phi[3 + j][2 + i] + (-phi[1 + j][1 + i] + phi[1 + j][3 + i] + phi[3 \
+ j][1 + i] - phi[3 + j][3 + i])/4.;\na[12] = 2*phi[1 + j][1 + i] - 2*phi[2 + \
j][1 + i] + (-phi[j][1 + i] + phi[2 + j][1 + i])/2. + (-phi[1 + j][1 + i] + \
phi[3 + j][1 + i])/2.;\na[13] = -phi[1 + j][i] + phi[1 + j][2 + i] + phi[2 + \
j][i] - phi[2 + j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + \
phi[2 + j][2 + i])/4. + (phi[1 + j][i] - phi[1 + j][2 + i] - phi[3 + j][i] + \
phi[3 + j][2 + i])/4.;\na[14] = -5*phi[1 + j][1 + i] + 6*phi[1 + j][2 + i] - \
2*(-phi[1 + j][i] + phi[1 + j][2 + i]) - phi[1 + j][3 + i] + 5*phi[2 + j][1 + \
i] - (3*(-phi[j][1 + i] + phi[2 + j][1 + i]))/2. + (-phi[j][i] + phi[j][2 + \
i] + phi[2 + j][i] - phi[2 + j][2 + i])/2. - 6*phi[2 + j][2 + i] + \
(3*(-phi[j][2 + i] + phi[2 + j][2 + i]))/2. + 2*(-phi[2 + j][i] + phi[2 + \
j][2 + i]) + (-phi[j][1 + i] + phi[j][3 + i] + phi[2 + j][1 + i] - phi[2 + \
j][3 + i])/4. + phi[2 + j][3 + i] - (3*(-phi[1 + j][1 + i] + phi[3 + j][1 + \
i]))/2. + (-phi[1 + j][i] + phi[1 + j][2 + i] + phi[3 + j][i] - phi[3 + j][2 \
+ i])/2. + (3*(-phi[1 + j][2 + i] + phi[3 + j][2 + i]))/2. + (-phi[1 + j][1 + \
i] + phi[1 + j][3 + i] + phi[3 + j][1 + i] - phi[3 + j][3 + i])/4.;\na[15] = \
-phi[j][1 + i] + phi[j][2 + i] - phi[1 + j][i] + 2*phi[1 + j][1 + i] - \
2*phi[1 + j][2 + i] + phi[1 + j][3 + i] + phi[2 + j][i] - 2*phi[2 + j][1 + i] \
+ 2*phi[2 + j][2 + i] + (phi[j][i] - phi[j][2 + i] - phi[2 + j][i] + phi[2 + \
j][2 + i])/4. - phi[2 + j][3 + i] + (phi[j][1 + i] - phi[j][3 + i] - phi[2 + \
j][1 + i] + phi[2 + j][3 + i])/4. + phi[3 + j][1 + i] - phi[3 + j][2 + i] + \
(phi[1 + j][i] - phi[1 + j][2 + i] - phi[3 + j][i] + phi[3 + j][2 + i])/4. + \
(phi[1 + j][1 + i] - phi[1 + j][3 + i] - phi[3 + j][1 + i] + phi[3 + j][3 + \
i])/4.;\n"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\</tmp/code.txt\>", code]\)], "Input"],

Cell[BoxData[
    \("/tmp/code.txt"\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(P = "\<p = \>" <> 
          powers@\(ToString@
              CForm[A . X]\) <> "\<;\n\>";\)\), "\[IndentingNewLine]", 
    \(\(Px = "\<px = \>" <> 
          powers@\(ToString@
              CForm[D[A . X, x]]\) <> "\<;\n\>";\)\), "\[IndentingNewLine]", 
    \(\(Py = "\<py = \>" <> 
          powers@\(ToString@
              CForm[D[A . X, y]]\) <> "\<;\n\>";\)\), "\[IndentingNewLine]", 
    \(StringJoin[P, Px, Py]\)}], "Input"],

Cell[BoxData[
    \("p = a[0] + x*a[1] + x2*a[2] + x3*a[3] + y*a[4] + x*y*a[5] + x2*y*a[6] \
+ x3*y*a[7] + y2*a[8] + x*y2*a[9] + x2*y2*a[10] + x3*y2*a[11] + y3*a[12] + \
x*y3*a[13] + x2*y3*a[14] + x3*y3*a[15];\npx = a[1] + 2*x*a[2] + 3*x2*a[3] + \
y*a[5] + 2*x*y*a[6] + 3*x2*y*a[7] + y2*a[9] + 2*x*y2*a[10] + 3*x2*y2*a[11] + \
y3*a[13] + 2*x*y3*a[14] + 3*x2*y3*a[15];\npy = a[4] + x*a[5] + x2*a[6] + \
x3*a[7] + 2*y*a[8] + 2*x*y*a[9] + 2*x2*y*a[10] + 2*x3*y*a[11] + 3*y2*a[12] + \
3*x*y2*a[13] + 3*x2*y2*a[14] + 3*x3*y2*a[15];\n"\)], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Bicubic Debugging", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(phi = {{0.104468, 0.075467, 0.083496, 0.128948, 0.208817}, {0.089900, 
            0.031826, 0.010765, 0.029407, 0.087204}, {0.099992, 
            0.012663, \(-0.039503\), \(-0.051429\), \(-0.020813\)}, \
{0.134924, 0.019875, \(-0.063943\), \(-0.109206\), \(-0.110560\)}, {0.192962, 
            0.053858, \(-0.060083\), \(-0.139754\), \(-0.176865\)}};\)\), "\
\[IndentingNewLine]", 
    \(MatrixForm[phi]\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.104468`", "0.075467`", "0.083496`", "0.128948`", 
              "0.208817`"},
            {"0.0899`", "0.031826`", "0.010765`", "0.029407`", "0.087204`"},
            {"0.099992`", 
              "0.012663`", \(-0.039503`\), \(-0.051429`\), \(-0.020813`\)},
            {"0.134924`", 
              "0.019875`", \(-0.063943`\), \(-0.109206`\), \(-0.11056`\)},
            {"0.192962`", 
              "0.053858`", \(-0.060083`\), \(-0.139754`\), \(-0.176865`\)}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi];\)\), "\n", 
    \(\(ListContourPlot[phi];\)\)}], "Input"],

Cell[BoxData[{
    \(\(X = 
        Table[x\^m*y\^n, {n, 0, 3}, {m, 0, 3}] // 
          Flatten;\)\), "\[IndentingNewLine]", 
    \(\(A = \n{\(-0.039503\), \(-0.032046\), 0.018970, 
          0.001151, \(-0.037354\), \(-0.031665\), \(-0.001763\), 0.001476, 
          0.011679, \(-0.001771\), \(-0.000593\), 0.000130, 0.001235, 
          0.000942, \(-0.000014\), \(-0.000080\)};\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(mat . A\)], "Input"],

Cell[BoxData[
    \({\(-0.039503`\), \(-0.051428`\), \(-0.06394300000000001`\), \
\(-0.109206`\), \(-0.032046`\), 
      0.009347000000000003`, \(-0.06454`\), \(-0.023309`\), \(-0.037354`\), \
\(-0.06930599999999999`\), \(-0.010290999999999998`\), \(-0.044167`\), \
\(-0.031665`\), \(-0.030763`\), \(-0.032381`\), \
\(-0.033874999999999995`\)}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ContourPlot[A . X, \ {x, \(-1\), 3}, {y, \(-1\), 3}, 
        Contours \[Rule] {0}, ContourShading \[Rule] None];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Plot3D[A . X, \ {x, \(-1\), 3}, {y, \(-1\), 3}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  SurfaceGraphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(pts = {{1.000000, 1.000000}, {1.152058, 1.480921}, {1.309417, 
            1.505955}, {1.214232, 1.593382}, {1.345662, 1.528590}, {1.182345, 
            1.602410}, {1.365044, 1.496694}, {1.146537, 1.595237}, {1.369599, 
            1.465660}, {1.132185, 1.586795}, {1.367006, 1.455569}, {1.132479, 
            1.584799}, {1.366012, 1.456619}, {1.133831, 1.585284}, {1.366128, 
            1.457680}, {1.133975, 1.585527}, {1.366234, 1.457719}, {1.133869, 
            1.585514}, {1.366237, 1.457626}, {1.133842, 1.585490}, {1.366228, 
            1.457610}};\)\[IndentingNewLine]\), "\n", 
    \(\(ContourPlot[A . X, {x, \(-1\), 2}, {y, \(-1\), 2}, 
        Contours \[Rule] {0}, ContourShading \[Rule] None, 
        Epilog \[Rule] {Point /@ pts, Line[pts]}, 
        ImageSize \[Rule] 1000];\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\({pts1, pts2, pts3, 
          pts4} = {\[IndentingNewLine]\[IndentingNewLine]};\)\), "\
\[IndentingNewLine]", 
    \(\(DisplayTogether[\[IndentingNewLine]ContourPlot[
          A . X, \ {x, \(-1\), 1}, {y, \(-1\), 1}, Contours \[Rule] {0}, 
          ContourShading \[Rule] None, 
          PlotRange \[Rule] 
            All], \[IndentingNewLine]\(ListPlot[Most@#, 
              PlotJoined \[Rule] True, 
              PlotStyle \[Rule] Hue[Random[]]] &\) /@ {pts1, pts2, pts3, 
            pts4}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(x =. \), "\[IndentingNewLine]", 
    \(y =. \), "\[IndentingNewLine]", 
    \(p = A . X\), "\[IndentingNewLine]", 
    \(dp = D[A . X, {{x, y}}]\)}], "Input"],

Cell[BoxData[
    \(\(\(0.031336`\)\(\[InvisibleSpace]\)\) - 0.027199`\ x + 
      0.033491`\ x\^2 + 0.000123`\ x\^3 - 0.042238`\ y - 0.027867`\ x\ y - 
      0.001132`\ x\^2\ y + 0.001831`\ x\^3\ y + 0.005275`\ y\^2 - 
      0.001292`\ x\ y\^2 - 0.000422`\ x\^2\ y\^2 + 0.000193`\ x\^3\ y\^2 + 
      0.000744`\ y\^3 + 0.000294`\ x\ y\^3 - 0.000162`\ x\^2\ y\^3 + 
      0.000015`\ x\^3\ y\^3\)], "Output"],

Cell[BoxData[
    \({\(-0.027199`\) + 0.066982`\ x + 0.000369`\ x\^2 - 0.027867`\ y - 
        0.002264`\ x\ y + 0.005493`\ x\^2\ y - 0.001292`\ y\^2 - 
        0.000844`\ x\ y\^2 + 0.000579`\ x\^2\ y\^2 + 0.000294`\ y\^3 - 
        0.000324`\ x\ y\^3 + 0.000045`\ x\^2\ y\^3, \(-0.042238`\) - 
        0.027867`\ x - 0.001132`\ x\^2 + 0.001831`\ x\^3 + 0.01055`\ y - 
        0.002584`\ x\ y - 0.000844`\ x\^2\ y + 0.000386`\ x\^3\ y + 
        0.002232`\ y\^2 + 0.000882`\ x\ y\^2 - 0.000486`\ x\^2\ y\^2 + 
        0.000045`\ x\^3\ y\^2}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(x0 = N@{0, 0};\)\), "\[IndentingNewLine]", 
    \(\({x, y} = x0;\)\), "\[IndentingNewLine]", 
    \(\(pts = 
        NestList[\((\[IndentingNewLine]d1 = \(-\(p\/dp . dp\)\) 
                  dp; \[IndentingNewLine]d2 = \((x0 - {x, 
                        y})\) - \(\((x0 - {x, y})\) . dp\/dp . dp\) 
                    dp; \[IndentingNewLine]{x, y} = {x, y} + d1 + 
                  0.9*d2\[IndentingNewLine])\) &, x0, 
          100];\)\), "\[IndentingNewLine]", 
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(DisplayTogether[\[IndentingNewLine]ContourPlot[
          A . X, \ {x, \(-1\), 1}, {y, \(-1\), 1}, Contours \[Rule] {0}, 
          ContourShading \[Rule] None, 
          PlotRange \[Rule] All], \[IndentingNewLine]ListPlot[pts, 
          PlotJoined \[Rule] True, PlotStyle \[Rule] Hue[0]], 
        ImageSize \[Rule] 1000, 
        Epilog \[Rule] {Line[{{x, y} - d1 - d2, {x, y} - d1 - d2 + dp}], 
            Point /@ pts}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(x =. \), "\[IndentingNewLine]", 
    \(y =. \), "\[IndentingNewLine]", 
    \(D[{f1[x, y], f2[x, y]}, {{x, y}, 1}] // MatrixForm\)}], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {
              RowBox[{
                SuperscriptBox["f1", 
                  TagBox[\((1, 0)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], 
              RowBox[{
                SuperscriptBox["f1", 
                  TagBox[\((0, 1)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}]},
            {
              RowBox[{
                SuperscriptBox["f2", 
                  TagBox[\((1, 0)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}], 
              RowBox[{
                SuperscriptBox["f2", 
                  TagBox[\((0, 1)\),
                    Derivative],
                  MultilineFunction->None], "[", \(x, y\), "]"}]}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[{\(x0 = 0;\), "\[IndentingNewLine]", \(y0 = 
        0;\), "\[IndentingNewLine]", \(x =. ;\), "\[IndentingNewLine]", \(y \
=. ;\), "\[IndentingNewLine]", \(f2 = 
        D[p, x]*\((x0 - x)\) - 
          D[p, y]*\((y0 - y)\);\), "\[IndentingNewLine]", \(f2x = 
        D[f2, x];\), "\[IndentingNewLine]", \(f2y = 
        D[f2, y];\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"mat", "=", 
        RowBox[{"(", GridBox[{
              {\(dp[\([\)\(1\)\(]\)]\), \(dp[\([\)\(2\)\(]\)]\)},
              {"f2x", "f2y"}
              }], ")"}]}], " ", ";"}], "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"F", "=", 
        RowBox[{"(", GridBox[{
              {"p"},
              {"f2"}
              }], ")"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{\(x = 0;\), "\[IndentingNewLine]", \(y = 
        0;\), "\[IndentingNewLine]", 
    RowBox[{"sol", "=", 
      RowBox[{"Solve", "[", 
        RowBox[{
          RowBox[{"mat", ".", 
            RowBox[{"(", GridBox[{
                  {"e1"},
                  {"e2"}
                  }], ")"}]}], "\[Equal]", \(-F\)}], 
        "]"}]}], "\[IndentingNewLine]", \({x, y} = {x, y} + {e1, e2} /. 
        sol[\([1]\)]\)}], "Input"],

Cell[BoxData[
    \({{e1 \[Rule] 0.5760505900952242`, 
        e2 \[Rule] 0.3709455940148682`}}\)], "Output"],

Cell[BoxData[
    \({0.5760505900952242`, 0.3709455940148682`}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{\(x = 0;\), "\n", \(y = 0;\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"pts", "=", 
        RowBox[{"NestList", "[", 
          RowBox[{
            RowBox[{
              RowBox[{"(", "\[IndentingNewLine]", 
                RowBox[{
                  RowBox[{"sol", "=", 
                    RowBox[{"Solve", "[", 
                      RowBox[{
                        RowBox[{"mat", ".", 
                          RowBox[{"(", GridBox[{
                                {"e1"},
                                {"e2"}
                                }], ")"}]}], "\[Equal]", \(-F\)}], "]"}]}], 
                  ";", "\[IndentingNewLine]", \({x, y} = {x, y} + {e1, e2} /. 
                      sol[\([1]\)]\), ";", 
                  "\[IndentingNewLine]", \({x, y}\)}], "\[IndentingNewLine]", 
                ")"}], "&"}], ",", \({x, y}\), ",", "10"}], "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(x =. \), "\n", \(y =. \), "\n", \(sol = 
      FindRoot[{p \[Equal] 0, f2 \[Equal] 0}, {x, x0}, {y, 
          y0}]\), "\[IndentingNewLine]", \(clear;\), "\n", \(DisplayTogether[\
\[IndentingNewLine]ContourPlot[A . X, \ {x, \(-1\), 1}, {y, \(-1\), 1}, 
          Contours \[Rule] {0,  .05}, ContourShading \[Rule] None, 
          PlotRange \[Rule] All, 
          Epilog -> {Point /@ pts, Green, PointSize[0.02], 
              Point[{x, y}] /. sol}], \[IndentingNewLine]ListPlot[pts, 
          PlotJoined \[Rule] True, PlotStyle \[Rule] Hue[0]], 
        ImageSize \[Rule] 1000];\)}], "Input"],

Cell[BoxData[
    RowBox[{\(FindRoot::"lstol"\), \(\(:\)\(\ \)\), "\<\"The line search \
decreased the step size to within tolerance specified by AccuracyGoal and \
PrecisionGoal but was unable to find a sufficient decrease in the merit \
function.  You may need more than \\!\\(MachinePrecision\\) digits of working \
precision to meet these tolerances. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"FindRoot::lstol\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \({x \[Rule] 0.2975934188251524`, 
      y \[Rule] 0.3821349207165298`}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(A . X /. sol\)], "Input"],

Cell[BoxData[
    \(0.007636533076345112`\)], "Output"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]]
}, Closed]]
},
FrontEndVersion->"5.2 for X",
ScreenRectangle->{{0, 2400}, {0, 1600}},
AutoGeneratedPackage->None,
WindowSize->{1200, 1525},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
ShowSelection->True
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 23, 0, 74, "Section"],

Cell[CellGroupData[{
Cell[1824, 57, 314, 5, 75, "Input",
  InitializationCell->True],
Cell[2141, 64, 49, 1, 70, "Output"]
}, Open  ]],
Cell[2205, 68, 600, 15, 91, "Input",
  InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{
Cell[2842, 88, 26, 0, 44, "Section"],
Cell[2871, 90, 62, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[2958, 95, 338, 5, 70, "Input"],
Cell[3299, 102, 77, 1, 70, "Output"]
}, Open  ]],
Cell[3391, 106, 425, 7, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[3853, 118, 30, 0, 44, "Section"],
Cell[3886, 120, 39, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[3950, 125, 167, 3, 70, "Input"],
Cell[4120, 130, 45, 1, 70, "Output"]
}, Open  ]],
Cell[4180, 134, 196, 3, 70, "Input"],

Cell[CellGroupData[{
Cell[4401, 141, 668, 12, 70, "Input"],
Cell[5072, 155, 130, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[5239, 163, 64, 1, 70, "Input"],
Cell[5306, 166, 50, 1, 70, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[5405, 173, 36, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[5466, 177, 44, 1, 27, "Input"],
Cell[5513, 180, 199, 3, 43, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[5749, 188, 322, 6, 91, "Input"],
Cell[6074, 196, 47, 1, 27, "Output"]
}, Open  ]],
Cell[6136, 200, 215, 4, 43, "Input"],
Cell[6354, 206, 140, 2, 27, "Input"],
Cell[6497, 210, 284, 6, 75, "Input"],
Cell[6784, 218, 261, 5, 59, "Input"],

Cell[CellGroupData[{
Cell[7070, 227, 71, 1, 27, "Input"],
Cell[7144, 230, 130, 3, 27, "Output"]
}, Open  ]],
Cell[7289, 236, 90, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[7404, 241, 38, 1, 31, "Input"],
Cell[7445, 244, 53, 1, 27, "Output"]
}, Open  ]],
Cell[7513, 248, 701, 16, 181, "Input"],

Cell[CellGroupData[{
Cell[8239, 268, 74, 1, 27, "Input"],
Cell[8316, 271, 130, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[8483, 279, 798, 15, 172, "Input"],
Cell[9284, 296, 53, 1, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[9386, 303, 38, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[9449, 307, 466, 8, 107, "Input"],
Cell[9918, 317, 43, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[9998, 323, 53, 1, 27, "Input"],
Cell[10054, 326, 41, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10132, 332, 119, 3, 27, "Input"],
Cell[10254, 337, 165, 3, 29, "Output"]
}, Open  ]],
Cell[10434, 343, 466, 9, 91, "Input"],

Cell[CellGroupData[{
Cell[10925, 356, 65, 1, 27, "Input"],
Cell[10993, 359, 51, 1, 27, "Output"]
}, Open  ]],
Cell[11059, 363, 112, 2, 27, "Input"],
Cell[11174, 367, 115, 2, 27, "Input"],
Cell[11292, 371, 39, 1, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[11368, 377, 25, 0, 44, "Section"],
Cell[11396, 379, 39, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[11460, 384, 44, 1, 27, "Input"],
Cell[11507, 387, 221, 3, 41, "Output"]
}, Open  ]],
Cell[11743, 393, 446, 7, 107, "Input"],
Cell[12192, 402, 188, 3, 43, "Input"],
Cell[12383, 407, 186, 3, 43, "Input"],
Cell[12572, 412, 339, 7, 91, "Input"],
Cell[12914, 421, 194, 3, 27, "Input"],
Cell[13111, 426, 243, 4, 43, "Input"],
Cell[13357, 432, 209, 3, 43, "Input"],
Cell[13569, 437, 181, 3, 43, "Input"],

Cell[CellGroupData[{
Cell[13775, 444, 71, 1, 27, "Input"],
Cell[13849, 447, 103, 2, 27, "Output"]
}, Open  ]],
Cell[13967, 452, 436, 10, 75, "Input"],
Cell[14406, 464, 307, 6, 43, "Input"],
Cell[14716, 472, 596, 13, 75, "Input"],

Cell[CellGroupData[{
Cell[15337, 489, 62, 1, 27, "Input"],
Cell[15402, 492, 137, 3, 26, "Output"]
}, Open  ]],
Cell[15554, 498, 211, 4, 43, "Input"],

Cell[CellGroupData[{
Cell[15790, 506, 904, 17, 171, "Input"],
Cell[16697, 525, 197, 3, 26, "Output"],
Cell[16897, 530, 499, 13, 55, "Output"]
}, Open  ]],
Cell[17411, 546, 249, 5, 43, "Input"],

Cell[CellGroupData[{
Cell[17685, 555, 295, 6, 53, "Input"],
Cell[17983, 563, 819, 20, 189, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[18839, 588, 54, 1, 27, "Input"],
Cell[18896, 591, 56, 1, 26, "Output"]
}, Open  ]],
Cell[18967, 595, 62, 1, 27, "Input"],
Cell[19032, 598, 150, 3, 43, "Input"],

Cell[CellGroupData[{
Cell[19207, 605, 92, 1, 27, "Input"],
Cell[19302, 608, 542, 13, 55, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[19881, 626, 445, 10, 57, "Input"],
Cell[20329, 638, 249, 4, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20615, 647, 90, 1, 27, "Input"],
Cell[20708, 650, 130, 3, 26, "Output"]
}, Open  ]],
Cell[20853, 656, 205, 4, 33, "Input"],

Cell[CellGroupData[{
Cell[21083, 664, 57, 1, 27, "Input"],
Cell[21143, 667, 47, 1, 26, "Output"]
}, Open  ]],
Cell[21205, 671, 131, 2, 27, "Input"],
Cell[21339, 675, 293, 5, 59, "Input"],
Cell[21635, 682, 79, 1, 27, "Input"],
Cell[21717, 685, 319, 6, 43, "Input"],
Cell[22039, 693, 340, 6, 59, "Input"],
Cell[22382, 701, 164, 3, 27, "Input"],
Cell[22549, 706, 70, 1, 27, "Input"],
Cell[22622, 709, 179, 3, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[22838, 717, 25, 0, 44, "Section"],
Cell[22866, 719, 39, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[22930, 724, 44, 1, 27, "Input"],
Cell[22977, 727, 199, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[23213, 735, 475, 9, 123, "Input"],
Cell[23691, 746, 46, 1, 26, "Output"],
Cell[23740, 749, 66, 1, 26, "Output"]
}, Open  ]],
Cell[23821, 753, 154, 3, 43, "Input"],
Cell[23978, 758, 174, 3, 43, "Input"],
Cell[24155, 763, 161, 3, 43, "Input"],

Cell[CellGroupData[{
Cell[24341, 770, 237, 4, 27, "Input"],
Cell[24581, 776, 137, 3, 26, "Output"]
}, Open  ]],
Cell[24733, 782, 134, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[24892, 788, 151, 2, 27, "Input"],
Cell[25046, 792, 137, 3, 26, "Output"]
}, Open  ]],
Cell[25198, 798, 137, 2, 43, "Input"],
Cell[25338, 802, 56, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[25419, 807, 229, 5, 75, "Input"],
Cell[25651, 814, 37, 1, 26, "Output"]
}, Open  ]],
Cell[25703, 818, 402, 7, 59, "Input"],

Cell[CellGroupData[{
Cell[26130, 829, 168, 3, 60, "Input"],
Cell[26301, 834, 76, 1, 26, "Output"]
}, Open  ]],
Cell[26392, 838, 55, 1, 27, "Input"],
Cell[26450, 841, 44, 1, 27, "Input"],
Cell[26497, 844, 57, 1, 27, "Input"],
Cell[26557, 847, 75, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[26657, 852, 45, 1, 27, "Input"],
Cell[26705, 855, 39, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[26781, 861, 467, 9, 91, "Input"],
Cell[27251, 872, 44, 1, 26, "Output"],
Cell[27298, 875, 43, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[27378, 881, 309, 5, 91, "Input"],
Cell[27690, 888, 37, 1, 26, "Output"]
}, Open  ]],
Cell[27742, 892, 491, 9, 107, "Input"],
Cell[28236, 903, 232, 5, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[28505, 913, 26, 0, 44, "Section"],
Cell[28534, 915, 39, 1, 27, "Input"],
Cell[28576, 918, 44, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[28645, 923, 272, 5, 91, "Input"],
Cell[28920, 930, 47, 1, 26, "Output"]
}, Open  ]],
Cell[28982, 934, 122, 2, 43, "Input"],
Cell[29107, 938, 243, 5, 27, "Input"],
Cell[29353, 945, 142, 3, 27, "Input"],
Cell[29498, 950, 106, 2, 27, "Input"],
Cell[29607, 954, 46, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[29678, 959, 403, 7, 91, "Input"],
Cell[30084, 968, 1142, 23, 115, "Output"]
}, Open  ]],
Cell[31241, 994, 369, 7, 75, "Input"],
Cell[31613, 1003, 317, 6, 59, "Input"],

Cell[CellGroupData[{
Cell[31955, 1013, 81, 1, 31, "Input"],
Cell[32039, 1016, 90, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[32166, 1022, 265, 4, 79, "Input"],
Cell[32434, 1028, 264, 4, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[32735, 1037, 42, 1, 27, "Input"],
Cell[32780, 1040, 39, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[32856, 1046, 82, 1, 28, "Input"],
Cell[32941, 1049, 102, 2, 27, "Output"]
}, Open  ]],
Cell[33058, 1054, 107, 2, 31, "Input"],

Cell[CellGroupData[{
Cell[33190, 1060, 452, 7, 112, "Input"],
Cell[33645, 1069, 223, 3, 26, "Output"],
Cell[33871, 1074, 114, 2, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[34022, 1081, 67, 1, 31, "Input"],
Cell[34092, 1084, 117, 2, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[34246, 1091, 67, 1, 31, "Input"],
Cell[34316, 1094, 92, 1, 27, "Output"]
}, Open  ]],
Cell[34423, 1098, 256, 5, 79, "Input"],

Cell[CellGroupData[{
Cell[34704, 1107, 67, 1, 31, "Input"],
Cell[34774, 1110, 262, 4, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[35085, 1120, 31, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[35141, 1124, 56, 1, 70, "Input"],
Cell[35200, 1127, 56, 1, 70, "Output"]
}, Open  ]],
Cell[35271, 1131, 166, 4, 70, "Input"],
Cell[35440, 1137, 139, 2, 70, "Input"],

Cell[CellGroupData[{
Cell[35604, 1143, 43, 1, 70, "Input"],
Cell[35650, 1146, 38, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[35725, 1152, 159, 4, 70, "Input"],
Cell[35887, 1158, 132, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36056, 1166, 49, 1, 70, "Input"],
Cell[36108, 1169, 37, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36182, 1175, 233, 4, 70, "Input"],
Cell[36418, 1181, 355, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36810, 1191, 45, 1, 70, "Input"],
Cell[36858, 1194, 38, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36933, 1200, 187, 4, 70, "Input"],
Cell[37123, 1206, 132, 3, 70, "Output"]
}, Open  ]],
Cell[37270, 1212, 55, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[37350, 1217, 64, 1, 70, "Input"],
Cell[37417, 1220, 359, 5, 70, "Message"],
Cell[37779, 1227, 227, 5, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[38043, 1237, 323, 5, 70, "Input"],
Cell[38369, 1244, 130, 3, 70, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[38548, 1253, 28, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[38601, 1257, 260, 6, 70, "Input"],
Cell[38864, 1265, 354, 5, 70, "Message"],
Cell[39221, 1272, 52, 1, 70, "Output"],
Cell[39276, 1275, 354, 5, 70, "Message"],
Cell[39633, 1282, 58, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[39728, 1288, 315, 5, 70, "Input"],
Cell[40046, 1295, 107, 2, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[40190, 1302, 57, 1, 70, "Input"],
Cell[40250, 1305, 43, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[40330, 1311, 164, 3, 70, "Input"],
Cell[40497, 1316, 107, 2, 70, "Output"]
}, Open  ]],
Cell[40619, 1321, 155, 2, 70, "Input"],
Cell[40777, 1325, 135, 2, 70, "Input"],
Cell[40915, 1329, 68, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[41008, 1334, 185, 3, 70, "Input"],
Cell[41196, 1339, 40, 1, 70, "Output"]
}, Open  ]],
Cell[41251, 1343, 39, 1, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[41327, 1349, 28, 0, 44, "Section"],
Cell[41358, 1351, 336, 8, 70, "Input"],
Cell[41697, 1361, 254, 4, 70, "Input"],
Cell[41954, 1367, 78, 1, 70, "Input"],
Cell[42035, 1370, 48, 1, 70, "Input"],
Cell[42086, 1373, 701, 10, 70, "Input"],
Cell[42790, 1385, 142, 3, 70, "Input"],
Cell[42935, 1390, 69, 1, 70, "Input"],
Cell[43007, 1393, 151, 2, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[43195, 1400, 27, 0, 44, "Section"],
Cell[43225, 1402, 39, 1, 70, "Input"],
Cell[43267, 1405, 44, 1, 70, "Input"],
Cell[43314, 1408, 580, 11, 70, "Input"],

Cell[CellGroupData[{
Cell[43919, 1423, 329, 5, 70, "Input"],
Cell[44251, 1430, 76, 1, 70, "Output"]
}, Open  ]],
Cell[44342, 1434, 214, 4, 70, "Input"],

Cell[CellGroupData[{
Cell[44581, 1442, 654, 12, 70, "Input"],
Cell[45238, 1456, 1554, 26, 70, "Message"],
Cell[46795, 1484, 308, 4, 70, "Message"],
Cell[47106, 1490, 1554, 26, 70, "Message"],
Cell[48663, 1518, 308, 4, 70, "Message"],
Cell[48974, 1524, 1554, 26, 70, "Message"],
Cell[50531, 1552, 333, 5, 70, "Message"],
Cell[50867, 1559, 308, 4, 70, "Message"],
Cell[51178, 1565, 339, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[51554, 1575, 85, 1, 70, "Input"],
Cell[51642, 1578, 48, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[51727, 1584, 137, 2, 70, "Input"],
Cell[51867, 1588, 784, 11, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[52688, 1604, 61, 1, 70, "Input"],
Cell[52752, 1607, 81, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[52870, 1613, 151, 3, 70, "Input"],
Cell[53024, 1618, 135, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[53196, 1626, 314, 6, 70, "Input"],
Cell[53513, 1634, 347, 5, 70, "Message"],
Cell[53863, 1641, 347, 5, 70, "Message"],
Cell[54213, 1648, 347, 5, 70, "Message"],
Cell[54563, 1655, 333, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[54933, 1665, 24, 0, 70, "Subsection"],

Cell[CellGroupData[{
Cell[54982, 1669, 250, 5, 70, "Input"],
Cell[55235, 1676, 77, 1, 70, "Output"],
Cell[55315, 1679, 42, 1, 70, "Output"]
}, Open  ]],
Cell[55372, 1683, 72, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[55469, 1688, 84, 1, 70, "Input"],
Cell[55556, 1691, 48, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[55641, 1697, 73, 1, 70, "Input"],
Cell[55717, 1700, 130, 3, 70, "Output"]
}, Open  ]],
Cell[55862, 1706, 272, 4, 70, "Input"],
Cell[56137, 1712, 86, 1, 70, "Input"],
Cell[56226, 1715, 248, 4, 70, "Input"],
Cell[56477, 1721, 148, 2, 70, "Input"],
Cell[56628, 1725, 108, 2, 70, "Input"],

Cell[CellGroupData[{
Cell[56761, 1731, 83, 1, 70, "Input"],
Cell[56847, 1734, 141, 2, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[57025, 1741, 92, 1, 70, "Input"],
Cell[57120, 1744, 268, 4, 70, "Message"],
Cell[57391, 1750, 268, 4, 70, "Message"],
Cell[57662, 1756, 268, 4, 70, "Message"],
Cell[57933, 1762, 329, 5, 70, "Message"]
}, Open  ]],
Cell[58277, 1770, 56, 1, 70, "Input"],
Cell[58336, 1773, 131, 2, 70, "Input"],
Cell[58470, 1777, 155, 2, 70, "Input"],

Cell[CellGroupData[{
Cell[58650, 1783, 340, 6, 70, "Input"],
Cell[58993, 1791, 355, 5, 70, "Message"],
Cell[59351, 1798, 342, 5, 70, "Message"],
Cell[59696, 1805, 342, 5, 70, "Message"],
Cell[60041, 1812, 329, 5, 70, "Message"],
Cell[60373, 1819, 372, 5, 70, "Message"],
Cell[60748, 1826, 371, 5, 70, "Message"],
Cell[61122, 1833, 395, 6, 70, "Message"],
Cell[61520, 1841, 394, 6, 70, "Message"],
Cell[61917, 1849, 792, 11, 70, "Message"],
Cell[62712, 1862, 329, 5, 70, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[63078, 1872, 50, 1, 70, "Input"],
Cell[63131, 1875, 44, 1, 70, "Output"]
}, Open  ]],
Cell[63190, 1879, 456, 8, 70, "Input"],
Cell[63649, 1889, 56, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[63730, 1894, 148, 4, 70, "Input"],
Cell[63881, 1900, 47, 1, 70, "Output"],
Cell[63931, 1903, 52, 1, 70, "Output"],
Cell[63986, 1906, 55, 1, 70, "Output"],
Cell[64044, 1909, 59, 1, 70, "Output"]
}, Open  ]],
Cell[64118, 1913, 124, 2, 70, "Input"],
Cell[64245, 1917, 162, 3, 70, "Input"],

Cell[CellGroupData[{
Cell[64432, 1924, 447, 8, 70, "Input"],
Cell[64882, 1934, 107, 2, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[65026, 1941, 72, 1, 70, "Input"],
Cell[65101, 1944, 54, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[65192, 1950, 151, 2, 70, "Input"],
Cell[65346, 1954, 58, 1, 70, "Output"],
Cell[65407, 1957, 53, 1, 70, "Output"]
}, Open  ]],
Cell[65475, 1961, 117, 2, 70, "Input"],
Cell[65595, 1965, 63, 1, 70, "Input"],
Cell[65661, 1968, 63, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[65749, 1973, 180, 3, 70, "Input"],
Cell[65932, 1978, 58, 1, 70, "Output"],
Cell[65993, 1981, 52, 1, 70, "Output"]
}, Open  ]],
Cell[66060, 1985, 139, 2, 70, "Input"],
Cell[66202, 1989, 86, 1, 70, "Input"],
Cell[66291, 1992, 360, 8, 70, "Input"],
Cell[66654, 2002, 180, 3, 70, "Input"],
Cell[66837, 2007, 200, 3, 70, "Input"],
Cell[67040, 2012, 186, 3, 70, "Input"],
Cell[67229, 2017, 72, 1, 70, "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[67350, 2024, 22, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[67397, 2028, 44, 1, 70, "Input"],
Cell[67444, 2031, 117, 2, 70, "Output"]
}, Open  ]],
Cell[67576, 2036, 938, 18, 70, "Input"],

Cell[CellGroupData[{
Cell[68539, 2058, 61, 1, 70, "Input"],
Cell[68603, 2061, 42, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[68682, 2067, 332, 6, 70, "Input"],
Cell[69017, 2075, 130, 3, 70, "Output"]
}, Open  ]],
Cell[69162, 2081, 131, 2, 70, "Input"],
Cell[69296, 2085, 90, 1, 70, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[69423, 2091, 28, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[69476, 2095, 35, 0, 38, "Subsection"],
Cell[69514, 2097, 337, 6, 80, "Input"],

Cell[CellGroupData[{
Cell[69876, 2107, 50, 1, 27, "Input"],
Cell[69929, 2110, 41, 1, 27, "Output"]
}, Open  ]],
Cell[69985, 2114, 79, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[70089, 2119, 136, 3, 27, "Input"],
Cell[70228, 2124, 328, 5, 20, "Message"],
Cell[70559, 2131, 328, 5, 20, "Message"],
Cell[70890, 2138, 311, 5, 20, "Message"],
Cell[71204, 2145, 329, 5, 20, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[71570, 2155, 88, 1, 27, "Input"],
Cell[71661, 2158, 2302, 40, 149, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[74000, 2203, 573, 12, 75, "Input"],
Cell[74576, 2217, 4303, 66, 328, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[78916, 2288, 58, 1, 27, "Input"],
Cell[78977, 2291, 3913, 52, 555, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[82939, 2349, 22, 0, 38, "Subsection"],

Cell[CellGroupData[{
Cell[82986, 2353, 44, 1, 27, "Input"],
Cell[83033, 2356, 114, 2, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[83184, 2363, 317, 8, 75, "Input"],
Cell[83504, 2373, 54, 1, 27, "Output"]
}, Open  ]],
Cell[83573, 2377, 88, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[83686, 2382, 235, 4, 27, "Input"],
Cell[83924, 2388, 137, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[84098, 2396, 69, 1, 27, "Input"],
Cell[84170, 2399, 65, 1, 27, "Output"]
}, Open  ]],
Cell[84250, 2403, 230, 4, 59, "Input"],
Cell[84483, 2409, 61, 1, 27, "Input"],
Cell[84547, 2412, 82, 1, 27, "Input"],
Cell[84632, 2415, 639, 13, 91, "Input"],
Cell[85274, 2430, 382, 9, 96, "Input"],
Cell[85659, 2441, 152, 2, 59, "Input"],

Cell[CellGroupData[{
Cell[85836, 2447, 427, 7, 70, "Input"],
Cell[86266, 2456, 278, 4, 37, "Message"],
Cell[86547, 2462, 311, 5, 20, "Message"],
Cell[86861, 2469, 342, 5, 20, "Message"]
}, Open  ]],
Cell[87218, 2477, 118, 2, 50, "Input"],

Cell[CellGroupData[{
Cell[87361, 2483, 74, 1, 27, "Input"],
Cell[87438, 2486, 5195, 143, 108, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[92670, 2634, 109, 2, 27, "Input"],
Cell[92782, 2638, 2038, 58, 36, "Output"]
}, Open  ]],
Cell[94835, 2699, 53, 1, 29, "Input"],

Cell[CellGroupData[{
Cell[94913, 2704, 82, 1, 31, "Input"],
Cell[94998, 2707, 89, 1, 50, "Output"]
}, Open  ]],
Cell[95102, 2711, 108, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[95235, 2717, 102, 2, 27, "Input"],
Cell[95340, 2721, 137, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[95514, 2729, 247, 5, 91, "Input"],
Cell[95764, 2736, 38, 1, 27, "Output"],
Cell[95805, 2739, 38, 1, 27, "Output"],
Cell[95846, 2742, 35, 1, 27, "Output"],
Cell[95884, 2745, 35, 1, 27, "Output"],
Cell[95922, 2748, 35, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[95994, 2754, 79, 1, 29, "Input"],
Cell[96076, 2757, 51, 1, 29, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[96164, 2763, 61, 1, 32, "Input"],
Cell[96228, 2766, 66, 1, 30, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[96355, 2774, 28, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[96408, 2778, 44, 1, 27, "Input"],
Cell[96455, 2781, 305, 4, 43, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[96797, 2790, 207, 5, 59, "Input"],
Cell[97007, 2797, 47, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[97091, 2803, 62, 1, 27, "Input"],
Cell[97156, 2806, 344, 5, 20, "Message"],
Cell[97503, 2813, 137, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[97677, 2821, 82, 1, 27, "Input"],
Cell[97762, 2824, 137, 3, 27, "Output"]
}, Open  ]],
Cell[97914, 2830, 55, 1, 27, "Input"],
Cell[97972, 2833, 84, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[98081, 2838, 103, 2, 43, "Input"],
Cell[98187, 2842, 37, 1, 27, "Output"],
Cell[98227, 2845, 37, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[98301, 2851, 124, 2, 43, "Input"],
Cell[98428, 2855, 38, 1, 27, "Output"]
}, Open  ]],
Cell[98481, 2859, 101, 2, 43, "Input"],
Cell[98585, 2863, 581, 11, 123, "Input"],

Cell[CellGroupData[{
Cell[99191, 2878, 172, 4, 75, "Input"],
Cell[99366, 2884, 137, 3, 27, "Output"],
Cell[99506, 2889, 2558, 45, 135, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[102101, 2939, 255, 5, 59, "Input"],
Cell[102359, 2946, 137, 3, 27, "Output"]
}, Open  ]],
Cell[102511, 2952, 229, 4, 75, "Input"],
Cell[102743, 2958, 144, 4, 27, "Input"],
Cell[102890, 2964, 551, 10, 155, "Input"],
Cell[103444, 2976, 128, 2, 27, "Input"],
Cell[103575, 2980, 293, 5, 59, "Input"],
Cell[103871, 2987, 322, 7, 75, "Input"],

Cell[CellGroupData[{
Cell[104218, 2998, 69, 1, 27, "Input"],
Cell[104290, 3001, 36, 1, 27, "Output"]
}, Open  ]],
Cell[104341, 3005, 767, 14, 139, "Input"],
Cell[105111, 3021, 160, 3, 27, "Input"],

Cell[CellGroupData[{
Cell[105296, 3028, 87, 1, 27, "Input"],
Cell[105386, 3031, 883, 13, 33, "Message"],
Cell[106272, 3046, 295, 6, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[106604, 3057, 128, 3, 27, "Input"],
Cell[106735, 3062, 130, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[106902, 3070, 385, 7, 91, "Input"],
Cell[107290, 3079, 563, 8, 20, "Message"],
Cell[107856, 3089, 563, 8, 20, "Message"],
Cell[108422, 3099, 563, 8, 20, "Message"],
Cell[108988, 3109, 332, 5, 20, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[109357, 3119, 205, 3, 75, "Input"],
Cell[109565, 3124, 230, 5, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[109832, 3134, 587, 10, 107, "Input"],
Cell[110422, 3146, 623, 8, 75, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[111082, 3159, 44, 1, 27, "Input"],
Cell[111129, 3162, 130, 3, 27, "Output"]
}, Open  ]],
Cell[111274, 3168, 150, 3, 27, "Input"],
Cell[111427, 3173, 167, 4, 27, "Input"],
Cell[111597, 3179, 171, 4, 27, "Input"],
Cell[111771, 3185, 89, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[111885, 3190, 1138, 22, 171, "Input"],
Cell[113026, 3214, 383, 6, 25, "Message"],
Cell[113412, 3222, 383, 6, 25, "Message"],
Cell[113798, 3230, 383, 6, 25, "Message"],
Cell[114184, 3238, 332, 5, 20, "Message"]
}, Open  ]],
Cell[114531, 3246, 222, 5, 27, "Input"],
Cell[114756, 3253, 453, 8, 59, "Input"],
Cell[115212, 3263, 188, 4, 27, "Input"],

Cell[CellGroupData[{
Cell[115425, 3271, 46, 1, 27, "Input"],
Cell[115474, 3274, 53, 1, 27, "Output"]
}, Open  ]],
Cell[115542, 3278, 119, 2, 27, "Input"],
Cell[115664, 3282, 89, 1, 27, "Input"],
Cell[115756, 3285, 478, 9, 91, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[116271, 3299, 27, 0, 44, "Section"],
Cell[116301, 3301, 39, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[116365, 3306, 37, 0, 70, "Subsection"],
Cell[116405, 3308, 69, 1, 70, "Input"],
Cell[116477, 3311, 87, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[116589, 3316, 91, 1, 70, "Input"],
Cell[116683, 3319, 150, 3, 70, "Output"]
}, Open  ]],
Cell[116848, 3325, 115, 2, 70, "Input"],
Cell[116966, 3329, 150, 2, 70, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[117153, 3336, 26, 0, 70, "Subsection"],
Cell[117182, 3338, 68, 1, 70, "Input"],
Cell[117253, 3341, 384, 8, 70, "Input"],

Cell[CellGroupData[{
Cell[117662, 3353, 57, 1, 70, "Input"],
Cell[117722, 3356, 130, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[117889, 3364, 150, 4, 70, "Input"],
Cell[118042, 3370, 133, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[118212, 3378, 263, 5, 70, "Input"],
Cell[118478, 3385, 64, 1, 70, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[118591, 3392, 26, 0, 70, "Subsection"],

Cell[CellGroupData[{
Cell[118642, 3396, 56, 1, 70, "Input"],
Cell[118701, 3399, 1228, 18, 70, "Output"]
}, Open  ]],
Cell[119944, 3420, 158, 3, 70, "Input"],
Cell[120105, 3425, 257, 4, 70, "Input"],

Cell[CellGroupData[{
Cell[120387, 3433, 391, 8, 70, "Input"],
Cell[120781, 3443, 7260, 202, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[128078, 3650, 48, 1, 70, "Input"],
Cell[128129, 3653, 37, 1, 70, "Output"]
}, Open  ]],
Cell[128181, 3657, 646, 12, 70, "Input"],
Cell[128830, 3671, 402, 8, 70, "Input"],
Cell[129235, 3681, 316, 6, 70, "Input"],

Cell[CellGroupData[{
Cell[129576, 3691, 63, 1, 70, "Input"],
Cell[129642, 3694, 49, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[129728, 3700, 43, 1, 70, "Input"],
Cell[129774, 3703, 38, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[129849, 3709, 40, 1, 70, "Input"],
Cell[129892, 3712, 38, 1, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[129991, 3720, 30, 0, 44, "Section"],
Cell[130024, 3722, 94, 2, 70, "Input"],

Cell[CellGroupData[{
Cell[130143, 3728, 48, 1, 70, "Input"],
Cell[130194, 3731, 85, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[130316, 3737, 97, 2, 70, "Input"],
Cell[130416, 3741, 39, 1, 70, "Output"]
}, Open  ]],
Cell[130470, 3745, 54, 1, 70, "Input"],
Cell[130527, 3748, 55, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[130607, 3753, 37, 1, 70, "Input"],
Cell[130647, 3756, 38, 1, 70, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[130734, 3763, 24, 0, 44, "Section"],
Cell[130761, 3765, 44, 1, 27, "Input"],
Cell[130808, 3768, 627, 12, 139, "Input"],
Cell[131438, 3782, 158, 2, 43, "Input"],
Cell[131599, 3786, 128, 2, 27, "Input"],
Cell[131730, 3790, 207, 4, 43, "Input"],

Cell[CellGroupData[{
Cell[131962, 3798, 326, 6, 59, "Input"],
Cell[132291, 3806, 137, 3, 27, "Output"]
}, Open  ]],
Cell[132443, 3812, 73, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[132541, 3817, 383, 7, 75, "Input"],
Cell[132927, 3826, 137, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[133101, 3834, 59, 1, 27, "Input"],
Cell[133163, 3837, 130, 3, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[133342, 3846, 27, 0, 44, "Section"],
Cell[133372, 3848, 39, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[133436, 3853, 44, 1, 27, "Input"],
Cell[133483, 3856, 187, 3, 26, "Output"]
}, Open  ]],
Cell[133685, 3862, 26, 0, 27, "Input"],
Cell[133714, 3864, 114, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[133853, 3870, 62, 1, 27, "Input"],
Cell[133918, 3873, 137, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[134092, 3881, 96, 2, 43, "Input"],
Cell[134191, 3885, 168, 4, 26, "Output"]
}, Open  ]],
Cell[134374, 3892, 39, 1, 27, "Input"],
Cell[134416, 3895, 73, 1, 27, "Input"],
Cell[134492, 3898, 360, 7, 75, "Input"],
Cell[134855, 3907, 363, 7, 75, "Input"],
Cell[135221, 3916, 82, 1, 27, "Input"],
Cell[135306, 3919, 221, 4, 27, "Input"],
Cell[135530, 3925, 281, 5, 27, "Input"],

Cell[CellGroupData[{
Cell[135836, 3934, 48, 1, 27, "Input"],
Cell[135887, 3937, 41, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[135965, 3943, 61, 1, 27, "Input"],
Cell[136029, 3946, 49, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[136115, 3952, 55, 1, 27, "Input"],
Cell[136173, 3955, 42, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[136252, 3961, 56, 1, 28, "Input"],
Cell[136311, 3964, 53, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[136401, 3970, 39, 1, 28, "Input"],
Cell[136443, 3973, 42, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[136522, 3979, 40, 1, 28, "Input"],
Cell[136565, 3982, 42, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[136644, 3988, 26, 0, 40, "Subsection"],
Cell[136673, 3990, 333, 7, 123, "Input"],

Cell[CellGroupData[{
Cell[137031, 4001, 1089, 19, 306, "Input"],
Cell[138123, 4022, 46, 1, 26, "Output"],
Cell[138172, 4025, 49, 1, 26, "Output"],
Cell[138224, 4028, 307, 4, 20, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[138568, 4037, 1210, 20, 379, "Input"],
Cell[139781, 4059, 46, 1, 26, "Output"],
Cell[139830, 4062, 49, 1, 26, "Output"],
Cell[139882, 4065, 307, 4, 20, "Message"],
Cell[140192, 4071, 382, 5, 20, "Message"],
Cell[140577, 4078, 382, 5, 20, "Message"],
Cell[140962, 4085, 382, 5, 20, "Message"],
Cell[141347, 4092, 340, 5, 20, "Message"],
Cell[141690, 4099, 307, 4, 20, "Message"],
Cell[142000, 4105, 307, 4, 20, "Message"],
Cell[142310, 4111, 331, 5, 20, "Message"],
Cell[142644, 4118, 42, 1, 26, "Output"]
}, Open  ]],
Cell[142701, 4122, 169, 3, 60, "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[142919, 4131, 23, 0, 74, "Section"],

Cell[CellGroupData[{
Cell[142967, 4135, 44, 1, 70, "Input"],
Cell[143014, 4138, 138, 2, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[143189, 4145, 107, 2, 70, "Input"],
Cell[143299, 4149, 37, 1, 70, "Output"]
}, Open  ]],
Cell[143351, 4153, 176, 3, 70, "Input"],
Cell[143530, 4158, 73, 1, 70, "Input"],

Cell[CellGroupData[{
Cell[143628, 4163, 45, 1, 70, "Input"],
Cell[143676, 4166, 37, 1, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[143750, 4172, 155, 3, 70, "Input"],
Cell[143908, 4177, 130, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[144075, 4185, 189, 4, 70, "Input"],
Cell[144267, 4191, 137, 3, 70, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[144441, 4199, 166, 3, 70, "Input"],
Cell[144610, 4204, 130, 3, 70, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[144789, 4213, 31, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[144845, 4217, 44, 1, 27, "Input"],
Cell[144892, 4220, 647, 10, 75, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[145576, 4235, 303, 7, 75, "Input"],
Cell[145882, 4244, 38, 1, 27, "Output"]
}, Open  ]],
Cell[145935, 4248, 204, 4, 43, "Input"],

Cell[CellGroupData[{
Cell[146164, 4256, 66, 1, 27, "Input"],
Cell[146233, 4259, 130, 3, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[146412, 4268, 40, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[146477, 4272, 133, 2, 43, "Input"],
Cell[146613, 4276, 171, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[146821, 4284, 130, 3, 27, "Input"],
Cell[146954, 4289, 155, 2, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[147146, 4296, 182, 3, 43, "Input"],
Cell[147331, 4301, 920, 20, 87, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[148288, 4326, 317, 5, 59, "Input"],
Cell[148608, 4333, 2936, 67, 249, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[151581, 4405, 111, 2, 43, "Input"],
Cell[151695, 4409, 2158, 40, 249, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[153890, 4454, 512, 8, 162, "Input"],
Cell[154405, 4464, 5095, 109, 249, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[159537, 4578, 125, 3, 27, "Input"],
Cell[159665, 4583, 618, 9, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[160320, 4597, 215, 4, 59, "Input"],
Cell[160538, 4603, 36, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[160611, 4609, 292, 6, 75, "Input"],
Cell[160906, 4617, 804, 17, 39, "Output"],
Cell[161713, 4636, 1235, 25, 59, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[162985, 4666, 37, 0, 40, "Subsection"],

Cell[CellGroupData[{
Cell[163047, 4670, 872, 16, 210, "Input"],
Cell[163922, 4688, 155, 2, 26, "Output"],
Cell[164080, 4692, 315, 5, 20, "Message"],
Cell[164398, 4699, 315, 5, 20, "Message"],
Cell[164716, 4706, 315, 5, 20, "Message"],
Cell[165034, 4713, 329, 5, 20, "Message"],
Cell[165366, 4720, 7684, 148, 249, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[173087, 4873, 280, 7, 59, "Input"],
Cell[173370, 4882, 9441, 137, 249, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[182848, 5024, 221, 4, 27, "Input"],
Cell[183072, 5030, 210, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[183319, 5038, 146, 2, 43, "Input"],
Cell[183468, 5042, 342, 5, 20, "Message"],
Cell[183813, 5049, 342, 5, 20, "Message"],
Cell[184158, 5056, 342, 5, 20, "Message"],
Cell[184503, 5063, 329, 5, 20, "Message"],
Cell[184835, 5070, 821, 15, 26, "Output"],
Cell[185659, 5087, 182, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[185878, 5095, 163, 4, 27, "Input"],
Cell[186044, 5101, 4544, 59, 551, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[190625, 5165, 66, 1, 27, "Input"],
Cell[190694, 5168, 49, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[190780, 5174, 456, 10, 75, "Input"],
Cell[191239, 5186, 543, 7, 101, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[191843, 5200, 36, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[191904, 5204, 443, 7, 75, "Input"],
Cell[192350, 5213, 749, 17, 85, "Output"]
}, Open  ]],
Cell[193114, 5233, 141, 3, 59, "Input"],
Cell[193258, 5238, 396, 7, 75, "Input"],

Cell[CellGroupData[{
Cell[193679, 5249, 40, 1, 27, "Input"],
Cell[193722, 5252, 357, 6, 41, "Output"]
}, Open  ]],
Cell[194094, 5261, 150, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[194269, 5267, 80, 1, 27, "Input"],
Cell[194352, 5270, 137, 3, 26, "Output"]
}, Open  ]],
Cell[194504, 5276, 834, 12, 107, "Input"],
Cell[195341, 5290, 578, 12, 123, "Input"],

Cell[CellGroupData[{
Cell[195944, 5306, 179, 4, 75, "Input"],
Cell[196126, 5312, 407, 6, 43, "Output"],
Cell[196536, 5320, 554, 8, 59, "Output"]
}, Open  ]],
Cell[197105, 5331, 987, 18, 263, "Input"],

Cell[CellGroupData[{
Cell[198117, 5353, 163, 3, 59, "Input"],
Cell[198283, 5358, 1090, 30, 43, "Output"]
}, Open  ]],
Cell[199388, 5391, 756, 18, 187, "Input"],

Cell[CellGroupData[{
Cell[200169, 5413, 443, 11, 91, "Input"],
Cell[200615, 5426, 109, 2, 26, "Output"],
Cell[200727, 5430, 76, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[200840, 5436, 1527, 29, 287, "Input"],
Cell[202370, 5467, 522, 8, 33, "Message"],
Cell[202895, 5477, 103, 2, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[203035, 5484, 45, 1, 27, "Input"],
Cell[203083, 5487, 55, 1, 26, "Output"],
Cell[203141, 5490, 42, 1, 26, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

