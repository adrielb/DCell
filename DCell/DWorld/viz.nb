(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     40859,       1180]*)
(*NotebookOutlinePosition[     41538,       1204]*)
(*  CellTagsIndexPosition[     41494,       1200]*)
(*WindowFrame->Normal*)



Notebook[{
Cell[BoxData[
    \(<< Graphics`Graphics3D`\)], "Input"],

Cell[BoxData[{
    \(Get[Environment["\<ALT_DISP\>"]]\), "\n", 
    \(Get["\</home/abergman/Research/DCell/PetscImport.m\>"]\)}], "Input",
  InitializationCell->True],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell["", "Section"],

Cell[BoxData[
    \(\($IMAGESIZE = 500;\)\)], "Input"],

Cell[BoxData[{
    \(\(dof = 2;\)\), "\[IndentingNewLine]", 
    \(\(m = \(n = 100\);\)\), "\[IndentingNewLine]", 
    \(\(p = 3;\)\)}], "Input"],

Cell[BoxData[
    \(ff[num_] := 
      Module[{dat}, \[IndentingNewLine]dat = 
          Rest@Import["\<vec.\>" <> 
                ToString[
                  num] <> "\<.dat\>", "\<Real64\>"]; \[IndentingNewLine]dat = 
          Partition[dat, dof] // 
            Transpose; \[IndentingNewLine]dat = \(Partition[#, n] &\) /@ 
            dat\[IndentingNewLine]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ff[1] // Dimensions\)], "Input"],

Cell[BoxData[
    \({2, 150, 50}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[\(ff[50]\)[\([2]\)], ImageSize \[Rule] 300]\)], "Input"],

Cell[BoxData[
    \(temp = \(\(Total\)\([\)\(\(Flatten\)\([\)\(\(\(ff[#]\)[\([All, 13, 
                    13]\)] &\) /@ Range[0, 15] // Transpose\)\)\)\)], "Input"],

Cell[BoxData[{
    \(\(temp = \(\(ff[#]\)[\([All, 13, 13]\)] &\) /@ Range[0, 15] // 
          Transpose;\)\), "\n", 
    \(DisplayTogether[\[IndentingNewLine]MapIndexed[\[IndentingNewLine]\
ListPlot[#1\ , PlotJoined \[Rule] True, 
            PlotStyle \[Rule] {Hue[#2[\([1]\)]/
                    10. ]}] &, \
\[IndentingNewLine]temp]\[IndentingNewLine]]\)}], "Input"],

Cell[BoxData[
    \(\(plot = 
        Function[
          r, \[IndentingNewLine]ListDensityPlot[\(ff[
                r]\)[\([2]\)], \[IndentingNewLine]PlotRange \[Rule] {0, 1}, 
            Frame \[Rule] None, ImageSize \[Rule] 300, 
            DisplayFunction \[Rule] ani]\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(plot /@ Range[0, 15]\)], "Input"],

Cell[BoxData[
    \({Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, Null, 
      Null, Null, Null, Null, Null}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(\(ff[15]\)[\([\(-1\)]\)] // ListDensityPlot\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Max[\(\(ff[#]\)[\([2]\)] &\) /@ Range[0, 100, 10]]\)], "Input"],

Cell[BoxData[
    \(0.5633033341238352`\)], "Output"],

Cell[BoxData[
    \(0.5370882372244298`\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(\(\((g = 
            ListPlot3D[\(Partition[\(ff[#]\)[\([2]\)], n]\)[\([1]\)], 
              PlotRange \[Rule] {0,  .6}, DisplayFunction \[Rule] Identity, 
              ImageSize \[Rule] 800, 
              BoxRatios \[Rule] {1, 
                  1,  .1}]; \[IndentingNewLine]Export["\<img.\>" <> 
              ToString[#] <> "\<.jpg\>", g];\[IndentingNewLine])\) &\) /@ 
      Range[9160, 10000, 10]\)], "Input"],

Cell[BoxData[
    \(\(ListDensityPlot[\(ff[#]\)[\([1]\)], PlotRange \[Rule] {0,  .5}, 
          DisplayFunction \[Rule] ani] &\) /@ Range[0, 5000, 100]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Dimensions[dat]\)], "Input"],

Cell[BoxData[
    \({}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(\(\(ListDensityPlot[\(ff[#]\)[\([1]\)], ImageSize \[Rule] 600, 
            PlotRange \[Rule] All] &\) /@ Range[0, 0];\)\)], "Input"],

Cell[BoxData[
    \(\(Total[Flatten@\(ff[#]\)[\([1]\)]] &\) /@ Range[0, 99] // 
      ListPlot\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[\(ff[99]\)[\([2]\)]]\)], "Input"],

Cell[BoxData[{
    \(\(m = \(n = 25\);\)\), "\[IndentingNewLine]", 
    \(\(dat = 
        Rest@Import["\<init.dat\>", "\<Real64\>"];\)\), \
"\[IndentingNewLine]", 
    \(\(dat = Partition[dat, dof] // Transpose;\)\), "\[IndentingNewLine]", 
    \(\(dat = \(Partition[#, n] &\) /@ dat;\)\), "\[IndentingNewLine]", 
    \(ListDensityPlot[dat[\([2]\)]]\)}], "Input"],

Cell[BoxData[
    \(0.25\ 0.75\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["", "Section"],

Cell[BoxData[
    \(\(imp[
          file_] := \(Import[file <> "\<.Real64\>", "\<Real64\>"] // 
            Partition[#, d3] &\) // Partition[#, d2] &;\)\)], "Input",
  InitializationCell->True],

Cell[BoxData[{
    \(\(d3 = \(d2 = 64\);\)\), "\[IndentingNewLine]", 
    \(\(ls = imp["\<ls.0\>"];\)\), "\[IndentingNewLine]", 
    \(\(diag = imp["\<diag.0\>"];\)\), "\[IndentingNewLine]", 
    \(\(chem = imp["\<chem.0\>"];\)\), "\[IndentingNewLine]", 
    \(\(irreg = impNode[0];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2, 3}]\)] +  .5;\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5, 6}]\)] +  .5;\)\)}], "Input"],

Cell[BoxData[
    \(\(chem = \(imp["\<chem.\>" <> ToString[#]] &\) /@ 
          Range[333, 333, 333];\)\)], "Input"],

Cell[BoxData[{
    \(\(mid = d3/2 + 1 // Round;\)\), "\n", 
    \(chem[\([All, mid, mid, mid]\)] // ListPlot\)}], "Input"],

Cell[BoxData[
    \(\(Plus @@ Flatten[#] &\) /@ chem // ListPlot\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(ListDensityPlot[\(imp["\<chem.\>" <> ToString[#]]\)[\([Round[d3/2] + 
                1]\)], DisplayFunction \[Rule] ani, 
          PlotRange \[Rule] All] &\) /@ Range[0, 3, 1]\)], "Input"],

Cell[BoxData[
    \({Null, Null, Null, Null}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(Flatten[chem] // 
      Histogram[#, HistogramRange \[Rule] {10,  .1  Max[chem]}] &\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(chem[\([1]\)] // Flatten\) // Union\)], "Input"],

Cell[BoxData[
    \({0.`, 262144.`}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[chem[\([1, mid, mid]\)] // Round, 
      PlotRange \[Rule] {\(-1\), 100}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(l = 12;\)\), "\[IndentingNewLine]", 
    \(\(d = ls[\([l]\)];\)\), "\[IndentingNewLine]", 
    \(ListDensityPlot[d, 
      Epilog \[Rule] {Hue[0], \(Point[Most@#] &\) /@ 
            Select[op, l > #[\([3]\)] > l - 1 &]}]\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Part::"partw"\), \(\(:\)\(\ \)\), "\<\"Part \\!\\(12\\) of \
\\!\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\) does not exist. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::partw\\\"]\\)\"\>"}]], \
"Message",
  GeneratedCell->False,
  CellAutoOverwrite->False],

Cell[BoxData[
    RowBox[{\(Part::"partd"\), \(\(:\)\(\ \)\), "\<\"Part specification \
\\!\\(0.5` \[LeftDoubleBracket] 3 \[RightDoubleBracket]\\) is longer than \
depth of object. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partd\\\"]\\)\"\>"}]], "Message",
  GeneratedCell->False,
  CellAutoOverwrite->False],

Cell[BoxData[
    RowBox[{\(DensityGraphics::"gmat"\), \(\(:\)\(\ \)\), \
"\<\"\\!\\(\\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\) \
\[LeftDoubleBracket] 12 \[RightDoubleBracket]\\) is not a rectangular array \
larger than 2 x 2. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"DensityGraphics::gmat\\\"]\\)\"\>"}]], "Message",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[Sign[ls[\([Round[d3/2]]\)]]]\)], "Input"],

Cell[BoxData[
    \(ListPlot[Most /@ ir, AspectRatio \[Rule] 1]\)], "Input"],

Cell[BoxData[
    \(ScatterPlot3D[Select[op, #[\([3]\)] > 22 &], 
      Epilog \[Rule] {Hue[0], Point[{30, 30}]}, ImageSize \[Rule] 1000, 
      ViewPoint -> {0.500, \ \(-0.482\), \ 2.599}]\)], "Input"],

Cell[BoxData[
    \(\(cop = 
        Cases[op, 
          Except[{Indeterminate, Indeterminate, 
              Indeterminate}]];\)\)], "Input"],

Cell[BoxData[{
    \(\(shade = \(Norm[{45, 45, 0} - #] &\) /@ cop // 
          Rescale;\)\), "\[IndentingNewLine]", 
    \(Histogram[shade]\)}], "Input"],

Cell[BoxData[{
    \(\(g = 
        Graphics3D[{\[IndentingNewLine]PointSize[ .03], 
            MapThread[{RGBColor[#2, #2, 1], 
                  Point@#1} &, \[IndentingNewLine]{cop, \(Norm[{45, 0, 
                            45} - #] &\) /@ cop // Rescale}]}, 
          DisplayFunction \[Rule] ani];\)\), "\[IndentingNewLine]", 
    \(Show[g, ImageSize \[Rule] 1000]\)}], "Input"],

Cell[BoxData[
    \(<< Graphics`Animation`\)], "Input"],

Cell[BoxData[
    \(SpinShow[g, Frames \[Rule] 10, 
      SpinRange \[Rule] {0\ Degree, 10  Degree}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Dimensions[d]\)], "Input"],

Cell[BoxData[
    \({45, 45}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 90;\)\), "\[IndentingNewLine]", 
    \(\(a = 
        Table[\[IndentingNewLine]Sign@ls[\([i, j, k]\)] \[NotEqual] 
              Sign@ls[\([i, j, k + 1]\)] || 
            Sign@ls[\([i, j, k]\)] \[NotEqual] Sign@ls[\([i, j, k - 1]\)] || 
            Sign@ls[\([i, j, k]\)] \[NotEqual] Sign@ls[\([i, j + 1, k]\)] || 
            Sign@ls[\([i, j, k]\)] \[NotEqual] Sign@ls[\([i, j - 1, k]\)] || 
            Sign@ls[\([i, j, k]\)] \[NotEqual] Sign@ls[\([i + 1, j, k]\)] || 
            Sign@ls[\([i, j, k]\)] \[NotEqual] 
              Sign@ls[\([i - 1, j, k]\)], \[IndentingNewLine]{i, 2, 
            d1 - 1}, {j, 2, d2 - 1}, {k, 2, 
            d3 - 1}];\)\), "\[IndentingNewLine]", 
    \(\(pts = Position[a, True];\)\), "\[IndentingNewLine]", 
    \(Dimensions[pts]\)}], "Input"],

Cell[BoxData[
    \({9936, 3}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(\(ListDensityPlot[Sign@d, 
        Epilog \[Rule] {Hue[0], \(Point[Most@# +  .5] &\) /@ 
              Select[pts, #[\([3]\)] \[Equal] l &]}];\)\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[diag[\([13]\)]]\)], "Input"],

Cell[BoxData[{
    \(\(u = 
        Function[{x, y, z}, 
          2\ \(Sin[\[Pi]\ x]\^2\) Sin[2  \[Pi]\ y] 
            Sin[2\ \[Pi]\ z]];\)\), "\[IndentingNewLine]", 
    \(\(v = 
        Function[{x, y, z}, \(-Sin[2  \[Pi]\ x]\)\ \(Sin[\[Pi]\ y]\^2\) 
            Sin[2\ \[Pi]\ z]];\)\), "\[IndentingNewLine]", 
    \(\(w = 
        Function[{x, y, z}, \(-Sin[2  \[Pi]\ x]\) Sin[2  \[Pi]\ y] 
            Sin[\[Pi]\ z]\^2];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(D[u, x] + D[v, y] + D[w, z] // FullSimplify\)], "Input"],

Cell[BoxData[
    \(0\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(<< Graphics`Graphics`\)], "Input"],

Cell[BoxData[{
    \(\(d =  .02;\)\), "\[IndentingNewLine]", 
    \(Flatten@
        Table[\[IndentingNewLine]u[X + d, Y, Z] - u[X - d, Y, Z] + 
            v[X, Y + d, Z] - v[X, Y - d, Z] + w[X, Y, Z + d] - 
            w[X, Y, Z - d], \[IndentingNewLine]{X, d, 1 - d, d}, {Y, d, 
            1 - d, d}, {Z, d, 1 - d, d}] // Histogram\)}], "Input"],

Cell[BoxData[
    \(Plot3D[u[ .5, y, x], {x, 0, 1}, {y, 0, 1}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(tf = 300;\)\), "\n", 
    \(g = 
      Table[\[IndentingNewLine]sol = 
          First@NDSolve[\[IndentingNewLine]{\[IndentingNewLine]\(x'\)[t] == 
                  u[x[t], y[t], z[t]], \[IndentingNewLine]\(y'\)[t] == 
                  v[x[t], y[t], z[t]], \[IndentingNewLine]\(z'\)[t] == 
                  w[x[t], y[t], z[t]], \[IndentingNewLine]x[
                    0] \[Equal]  .1  Random[] +  .5, \[IndentingNewLine]y[
                    0] \[Equal]  .1  Random[] +  .5, \[IndentingNewLine]z[
                    0] \[Equal]  .1  Random[] +  .5\[IndentingNewLine]}, {x, 
                y, z}, {t, 0, tf}, 
              MaxSteps \[Rule] \[Infinity]]; \
\[IndentingNewLine]Graphics3D[{Hue[Random[]], 
            Line@Transpose[\({x[t], y[t], z[t]} /. sol\) /. 
                  t \[Rule] 
                    Range[0, 
                      tf,  .1]]}], \
\[IndentingNewLine]{30}\[IndentingNewLine]]\), "\n", 
    \(\(Show[g, PlotRange \[Rule] {{0, 1}, {0, 1}, {0, 1}}];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
          False,
          Editable->False]}], "}"}]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d3 = 16;\)\), "\[IndentingNewLine]", 
    \(\(d2 = 128;\)\), "\[IndentingNewLine]", 
    \(\(ls = imp["\<SphereInit.0\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[ls]\)}], "Input"],

Cell[BoxData[
    \({128, 128, 16}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(<< Graphics`ContourPlot3D`\)], "Input"],

Cell[BoxData[
    \(ListContourPlot3D[ls]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(8*Times @@ Dimensions[ls]\)], "Input"],

Cell[BoxData[
    \(2097152\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[ls[\([All, 64, All]\)]]\)], "Input"],

Cell[BoxData[{
    \(\(d1 = 64;\)\), "\[IndentingNewLine]", 
    \(\(mat = Table[d1 \((i - 1)\), {i, d1}, {j, d1}, {k, d1}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Max[mat]\)], "Input"],

Cell[BoxData[
    \(4032\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\<mat.Real64\>", Flatten[mat], "\<Real64\>"]\)], "Input"],

Cell[BoxData[
    \("mat.Real64"\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Export["\<mat.Real64\>", 
      Flatten[mat], "\<UnsignedInteger8\>"]\)], "Input"],

Cell[BoxData[
    \("mat.Real64"\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Union[Flatten[mat]]\)], "Input"],

Cell[BoxData[
    \({0, 64, 128, 192, 256, 320, 384, 448, 512, 576, 640, 704, 768, 832, 
      896, 960, 1024, 1088, 1152, 1216, 1280, 1344, 1408, 1472, 1536, 1600, 
      1664, 1728, 1792, 1856, 1920, 1984, 2048, 2112, 2176, 2240, 2304, 2368, 
      2432, 2496, 2560, 2624, 2688, 2752, 2816, 2880, 2944, 3008, 3072, 3136, 
      3200, 3264, 3328, 3392, 3456, 3520, 3584, 3648, 3712, 3776, 3840, 3904, 
      3968, 4032}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(MapIndexed[#2 &, {11, 12, 13}]\)], "Input"],

Cell[BoxData[
    \({{1}, {2}, {3}}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(Export["\<mat.\>" <> ToString[#2[\([1]\)]], 
          Flatten[#1], "\<UnsignedInteger16\>"] &\)~MapIndexed~mat\)], "Input"],

Cell[BoxData[
    \({"mat.1", "mat.2", "mat.3", "mat.4", "mat.5", "mat.6", "mat.7", 
      "mat.8", "mat.9", "mat.10", "mat.11", "mat.12", "mat.13", "mat.14", 
      "mat.15", "mat.16"}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Dimensions[mat]\)], "Input"],

Cell[BoxData[
    \({16, 16, 16}\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(720\ 16\ /9. \)], "Input"],

Cell[BoxData[
    \(1280.`\)], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["advection.c", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(v = 
        Function[
            v, \[IndentingNewLine]\(Rest@
                  Import["\<vec.\>" <> 
                      ToString[v] <> "\<.Real64\>", "\<Real64\>"] // 
                Partition[#, \@Length[#]] &\) // 
              Drop[#, \(-1\), \(-1\)] &\[IndentingNewLine]] /@ 
          Range[0, 399, 1];\)\), "\[IndentingNewLine]", 
    \(max = Max[v]\), "\[IndentingNewLine]", 
    \(min = Min[v]\)}], "Input"],

Cell[BoxData[
    \(2.9980834261260823`\)], "Output"],

Cell[BoxData[
    \(1.0018873931611185`\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(tot = Total[Flatten[v[\([1]\)]]];\)\), "\[IndentingNewLine]", 
    \(\(Total[Flatten[#]]\/tot - 1 &\) /@ v // ListPlot\)}], "Input"],

Cell[BoxData[
    \(ListDensityPlot[v[\([\(-1\)]\)], PlotRange \[Rule] All]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListPlot3D[#, 
          PlotRange \[Rule] {min, max}, \[IndentingNewLine]Mesh \[Rule] 
            False, \[IndentingNewLine]DisplayFunction \[Rule] ani] &\) /@ 
      v\), "\[IndentingNewLine]", 
    \(clear\), "\[IndentingNewLine]", 
    \(SelectionAnimate[nbAltDisp]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Solve[\(u*dt\)\/dx + \(u*dt\)\/dx \[Equal]  .2, dt]\)], "Input"],

Cell[BoxData[
    \({{dt \[Rule] \(0.1`\ dx\)\/u}}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(f = \(1\/\[Pi]\) \(Sin[\[Pi]\ x]\^2\) 
          Sin[\[Pi]\ y]\^2;\)\), "\[IndentingNewLine]", 
    \(Plot3D[f, {x, 0, 1}, {y, 0, 1}]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(u = D[f, y]\), "\[IndentingNewLine]", 
    \(v = \(-D[f, x]\)\), "\[IndentingNewLine]", 
    \(Plot3D[u, {x, 0, 1}, {y, 0, 1}]\), "\[IndentingNewLine]", 
    \(Plot3D[v, {x, 0, 1}, {y, 0, 1}]\)}], "Input"],

Cell[BoxData[
    \(2\ Cos[\[Pi]\ y]\ Sin[\[Pi]\ x]\^2\ Sin[\[Pi]\ y]\)], "Output"],

Cell[BoxData[
    \(\(-2\)\ Cos[\[Pi]\ x]\ Sin[\[Pi]\ x]\ Sin[\[Pi]\ y]\^2\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["implicit", "Section"],

Cell[BoxData[{
    \(\(dx = 0.5;\)\), "\[IndentingNewLine]", 
    \(\(dt = 0.001257;\)\), "\[IndentingNewLine]", 
    \(\(vscale = dt\/dx;\)\), "\[IndentingNewLine]", 
    \(\(MX = 48;\)\), "\[IndentingNewLine]", 
    \(\(MY = MX;\)\), "\[IndentingNewLine]", 
    \(\(LX = MX*dx;\)\), "\[IndentingNewLine]", 
    \(\(LY = MY*dx;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"info.log.0", "phi.10000.Real64", "phi.10001.Real64", 
      "phi.10002.Real64", "phi.10003.Real64", "phi.irregNode.10000.array", 
      "phi.pos", "phi.size", "psi.10000.Real64", "psi.10001.Real64", 
      "psi.10002.Real64", "psi.10003.Real64", "psi.irregNode.10000.array", 
      "psi.irregNode.10001.array", "psi.irregNode.10002.array", 
      "psi.irregNode.10003.array", "psi.pos", "psi.size", "rhs.10000.Real64", 
      "rhs.10001.Real64", "rhs.10002.Real64", "rhs.10003.Real64", 
      "temporal.dat", "tmp.10000.Real64", "tmp.10001.Real64", 
      "tmp.10002.Real64", "tmp.10003.Real64", "tmp.pos", "tmp.size", 
      "uvp.10000.Real64", "uvp.10001.Real64", "uvp.10002.Real64", 
      "uvp.10003.Real64"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid["\<phi\>"];\)\), "\n", 
    \(Dimensions[phi]\), "\[IndentingNewLine]", 
    \(\(clear;\)\), "\n", 
    \(\(\(ListDensityPlot[#] &\) /@ phi;\)\)}], "Input"],

Cell[BoxData[
    \({8, 60, 60}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListContourPlot[#, ImageSize \[Rule] 1111] &\) /@ 
        phi;\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(Function[
        i, \[IndentingNewLine]ImportIrreg["\<psi.irregNode.\>" <> 
            ToString[10000 + i] <> "\<.array\>"]; \[IndentingNewLine]ListPlot[
          ir`X*dx, \ PlotRange \[Rule] {{0, 25}, {0, 25}}, 
          AspectRatio \[Rule] Automatic];\[IndentingNewLine]]~Array~
      10\)}], "Input"],

Cell[BoxData[{
    \(\(RealtimeGraph = 
        Function[
          t, \[IndentingNewLine]Module[{time = 
                t + 10000}, \
\[IndentingNewLine]ImportIrreg["\<phi.irregNode.\>" <> 
                ToString[time] <> "\<.array\>"]; \[IndentingNewLine]{pvel, 
                uvel, vvel} = 
              ImportFluid1[MX, MY, dx, "\<uvp\>", 
                time]; \[IndentingNewLine]g = \
\[IndentingNewLine]PlotVectorField[{uvel[y, x], vvel[y, x]}, {x, dx, 
                  LX - 1}, {y, dx, LY - 1}, ScaleFactor \[Rule] None, 
                ScaleFunction \[Rule] \((#*vscale &)\), 
                PlotPoints \[Rule] \(({MX, MY}/1)\), Frame \[Rule] False, 
                HeadLength \[Rule] 0.2*10^\(-2. \), ImageSize \[Rule] 1000, 
                Epilog \[Rule] {\(Point[dx*#] &\) /@ 
                      ir`X}]; \[IndentingNewLine] (*\(Export["\<g.\>" <> 
                    ToString[time] <> "\<.png\>", 
                  g];\)*) ]];\)\), "\[IndentingNewLine]", 
    \(RealtimeGraph[1]\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(RealtimeGraph /@ Range[0, 9];\)\)}], "Input"],

Cell[CellGroupData[{

Cell["psi", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({psi, pos} = ImportGrid["\<psi\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[psi]\)}], "Input"],

Cell[BoxData[
    \({40, 60, 60}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot /@ psi;\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListPlot3D /@ psi;\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListPlot3D[psi[\([#]\)] - phi[\([#]\)], 
            PlotRange \[Rule] {\(-0.5\), 0.5}] &\)~Array~
        Length[psi];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(Part::"partw"\), \(\(:\)\(\ \)\), "\<\"Part \\!\\(6\\) of \
\\!\\({\\(\\({\\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, \\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 7 \[RightSkeleton]\\)\
\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
\\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({\\(\\({7.5`, \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\) does not exist. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partw\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Part::"partw"\), \(\(:\)\(\ \)\), "\<\"Part \\!\\(6\\) of \
\\!\\({\\(\\({\\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, \\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 7 \[RightSkeleton]\\)\
\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
\\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({\\(\\({7.5`, \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\) does not exist. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::partw\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Plot3D::"gval"\), \(\(:\)\(\ \)\), "\<\"Function value \
\\!\\(\\(\\(7.5`\[InvisibleSpace]\\)\\) - \\(\\(\\(\\({\\(\\({\\(\\({7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 7 \
\[RightSkeleton]\\)\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\
\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\), \\(\\({\\(\\({7.5`, 7.5`, \\(\\(\[LeftSkeleton] 8 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 10 \
\[RightSkeleton]\\)\\)}\\)\\)}\\)\\) \[LeftDoubleBracket] 6 \
\[RightDoubleBracket]\\)\\)\\) at grid point xi = \\!\\(1\\), yi = \\!\\(1\\) \
is not a real number. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Plot3D::gval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Plot3D::"gval"\), \(\(:\)\(\ \)\), "\<\"Function value \
\\!\\(\\(\\(7.5`\[InvisibleSpace]\\)\\) - \\(\\(\\(\\({\\(\\({\\(\\({7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 7 \
\[RightSkeleton]\\)\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\
\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\), \\(\\({\\(\\({7.5`, 7.5`, \\(\\(\[LeftSkeleton] 8 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 10 \
\[RightSkeleton]\\)\\)}\\)\\)}\\)\\) \[LeftDoubleBracket] 6 \
\[RightDoubleBracket]\\)\\)\\) at grid point xi = \\!\\(1\\), yi = \\!\\(2\\) \
is not a real number. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Plot3D::gval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(Plot3D::"gval"\), \(\(:\)\(\ \)\), "\<\"Function value \
\\!\\(\\(\\(7.5`\[InvisibleSpace]\\)\\) - \\(\\(\\(\\({\\(\\({\\(\\({7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] \
50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, 7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 7 \
\[RightSkeleton]\\)\\), \\(\\({7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, 7.5`, \
7.5`, 7.5`, 7.5`, \\(\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\
\\(\[LeftSkeleton] 50 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 3 \
\[RightSkeleton]\\)\\), \\(\\({\\(\\({7.5`, 7.5`, \\(\\(\[LeftSkeleton] 8 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 50 \
\[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 10 \
\[RightSkeleton]\\)\\)}\\)\\)}\\)\\) \[LeftDoubleBracket] 6 \
\[RightDoubleBracket]\\)\\)\\) at grid point xi = \\!\\(1\\), yi = \\!\\(3\\) \
is not a real number. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"Plot3D::gval\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(Plot3D :: \\\"gval\\\"\\) will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], \
"Message"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListDensityPlot[psi[\([#]\)] - phi[\([#]\)], 
            PlotRange \[Rule] {\(-0.5\), 0.5}] &\)~Array~
        Length[psi];\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["phi-psi", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Names["\<ir`*\>"]\)], "Input"],

Cell[BoxData[
    \({"ir`f1", "ir`f2", "ir`filename", "ir`format", "ir`format$", "ir`i", 
      "ir`i$", "ir`k", "ir`len", "ir`len$", "ir`n", "ir`nv", "ir`n$", 
      "ir`raw", "ir`s", "ir`s$", "ir`s$3911533", "ir`T1", "ir`T2", "ir`x", 
      "ir`X"}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[t, 
          Module[{time = t + 10000, psi, 
              phi}, \[IndentingNewLine]ImportIrreg["\<psi.irregNode.\>" <> 
                ToString[time] <> "\<.array\>"]; psi = ir`X; 
            f1 = \[IndentingNewLine]ImportIrreg["\<phi.irregNode.\>" <> 
                  ToString[time] <> "\<.array\>"]; 
            phi = ir`X; \[IndentingNewLine]ListPlot[psi, 
              PlotRange \[Rule] {{0, MX}, {0, MY}}, 
              AspectRatio \[Rule] Automatic, 
              Epilog \[Rule] {Blue, Point /@ phi}]\[IndentingNewLine]]] /@ 
        Range[0, 41];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[t, 
          Module[{time = t + 10000, psi, phi, f1, 
              nv}, \[IndentingNewLine]ImportIrreg["\<psi.irregNode.\>" <> 
                ToString[time] <> "\<.array\>"]; psi = dx*ir`X; f1 = ir`f1; 
            nv = ir`nv; \[IndentingNewLine]ImportIrreg["\<phi.irregNode.\>" <> 
                ToString[time] <> "\<.array\>"]; 
            phi = dx*ir`X; \[IndentingNewLine]{pvel, uvel, vvel} = 
              ImportFluid1[MX, MY, dx, "\<uvp\>", 
                time]; \[IndentingNewLine]PlotVectorField[{uvel[y, x], 
                vvel[y, x]}, {x, dx, LX - 1}, {y, dx, LY - 1}, 
              ScaleFactor \[Rule] None, 
              ScaleFunction \[Rule] \((#*vscale &)\), 
              PlotPoints \[Rule] \(({MX, MY}/1)\), Frame \[Rule] False, 
              HeadLength \[Rule] 0.2*10^\(-2. \), ImageSize \[Rule] 1000, 
              Epilog \[Rule] {Blue, Point /@ phi, Red, Point /@ psi, 
                  MapThread[
                    Function[{p, n, f}, Line[{p, p + f*n}]], {psi, nv, 
                      f1}]}];\[IndentingNewLine]]] /@ 
        Range[0, 40];\)\)}], "Input"],

Cell[BoxData[
    RowBox[{\(BinaryReadList::"nffil"\), \(\(:\)\(\ \)\), "\<\"File not found \
during \\!\\(BinaryReadList[\\(\\(\\\"psi.irregNode.10000.array\\\", \
\\\"Real64\\\", \\(\\(ByteOrdering \[Rule] 1\\)\\)\\)\\)]\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::nffil\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["tmp", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({tmp, pos} = ImportGrid["\<tmp\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[tmp]\)}], "Input"],

Cell[BoxData[
    \({40, 60, 60}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Max[Abs[tmp]]\)], "Input"],

Cell[BoxData[
    \(0.8944045819668218`\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListDensityPlot[#, PlotRange \[Rule] 0.1 {\(-1\), 1}] &\) /@ 
        tmp;\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListPlot3D[#, PlotRange \[Rule] 0.8 {\(-1\), 1}] &\) /@ 
        tmp;\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["log", "Subsection"],

Cell[BoxData[{
    \(\(clear;\)\), "\n", 
    \(\(convg = 
        Import["\<!grep \"BFGS convergence norm\" info.log.0\>", \
"\<Table\>"];\)\), "\n", 
    \(convg = convg[\([All, \(-1\)]\)]\), "\n", 
    \(\(ListPlot[convg, PlotJoined \[Rule] True, 
        Epilog \[Rule] 
          Array[{GrayLevel[1 - #\/Length[convg]], 
                Point[{#, convg[\([\)\(#\)\(]\)]}]} &, Length[convg]], 
        PlotRange \[Rule] {0, 10}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(tolg = 0.1;\)\), "\[IndentingNewLine]", 
    \(\(root = 
        Import["\<!grep \"BFGSstep(): root norm\" info.log.0\>", \
"\<Table\>"];\)\), "\n", 
    \(\(root = root[\([\)\(All, \(-1\)\)\(]\)];\)\), "\n", 
    \(\(ListPlot[root, PlotJoined \[Rule] True, 
        Epilog \[Rule] {Blue, 
            Line[{{0, tolg}, {1000, 
                  tolg}}], \[IndentingNewLine]Array[{GrayLevel[
                    1 - #\/Length[root]], 
                  Point[{#, root[\([\)\(#\)\(]\)]}]} &, Length[root]]}, 
        PlotRange \[Rule] {0, 6}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(rootMAX = 
        Import["\<!grep -e \"BFGSstep(): MAX_BFGS\" -e \"BFGSstep(): root \
norm\" info.log.0\>", "\<Table\>"];\)\), "\n", 
    \(rootMAX = rootMAX[\([\)\(All, 6\)\(]\)]; \), "\n", 
    \(Dimensions[rootMAX]\), "\n", 
    \(\(tolg = 0.1;\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[rootMAX, PlotJoined \[Rule] True, 
        Epilog \[Rule] {Blue, Line[{{0, tolg}, {1000, tolg}}], 
            Array[{GrayLevel[1 - #\/Length[rootMAX]], 
                  Point[{#, rootMAX[\([\)\(#\)\(]\)]}]} &, Length[rootMAX]]}, 
        PlotRange \[Rule] All];\)\)}], "Input"],

Cell[BoxData[
    \({31}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(root = 
        Import["\<!grep \"BFGSstep(): tentative root norm\" info.log.0\>", \
"\<Table\>"];\)\), "\n", 
    \(\(root = root[\([All, \(-1\)]\)];\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[root, PlotJoined \[Rule] True, 
        Epilog \[Rule] 
          Array[{GrayLevel[1 - #\/Length[root]], 
                Point[{#, root[\([\)\(#\)\(]\)]}]} &, Length[root]], 
        PlotRange \[Rule] All];\)\)}], "Input"],

Cell[BoxData[{
    \(\(tolg = 0.01;\)\), "\[IndentingNewLine]", 
    \(\(root = 
        Import["\<!grep -e \"ti =\" -e \"BFGSstep(): tentative root norm\" -e \
\"BFGSstep(): root norm\" info.log.0\>", "\<Table\>"];\)\), "\n", 
    \(\(root = \(Append[root[\([\)\(#\)\(]\)], #] &\)~Array~
          Length[root];\)\), "\n", 
    \(\(root = 
        Split[root, #1[\([\)\(2\)\(]\)] === #2[\([\)\(2\)\(]\)] &];\)\), "\n\
", 
    \(\(root = Take[root, {1, \(-1\), 2}];\)\), "\n", 
    \(\(rootpts = \(Select[
            Flatten[root, 
              1], #[\([\)\(3\)\(]\)] === "\<root\>" &]\)[\([\)\(All, {\(-1\), \
\(-2\)}\)\(]\)];\)\), "\n", 
    \(\(root = \(#[\([\)\(All, {\(-1\), \(-2\)}\)\(]\)] &\) /@ 
          root;\)\), "\n", 
    \(\(ListPlot[Flatten[root, 1], 
        Epilog \[Rule] {Line /@ root, Blue, Line[{{0, tolg}, {1000, tolg}}], 
            Red, Point /@ rootpts}, PlotRange \[Rule] All];\)\)}], "Input"],

Cell[BoxData[{
    \(\(maxd = 
        Import["\<!grep \"max lambda\" info.log.0\>", "\<Table\>"];\)\), "\n\
", 
    \(\(maxd = maxd[\([All, \(-1\)]\)];\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[maxd, PlotJoined \[Rule] True, 
        Epilog \[Rule] 
          Array[{GrayLevel[1 - #\/Length[maxd]], 
                Point[{#, maxd[\([#]\)]}]} &, Length[maxd]], 
        PlotRange \[Rule] All];\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["temporal", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ImportTemporal[]\)], "Input"],

Cell[BoxData[
    \({"iter", "t", "dt", "dtcfl", "tiframe", "CFL"}\)], "Print"]
}, Open  ]],

Cell[BoxData[
    \(\(ListPlot[dt];\)\)], "Input"],

Cell[BoxData[
    \(\(ListPlot[dt\/dt[\([1]\)]];\)\)], "Input"]
}, Open  ]]
}, Open  ]]
},
FrontEndVersion->"5.2 for X",
ScreenRectangle->{{0, 2400}, {0, 1600}},
AutoGeneratedPackage->None,
WindowSize->{1200, 1523},
WindowMargins->{{0, Automatic}, {0, Automatic}},
ShowSelection->True
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{
Cell[1754, 51, 56, 1, 27, "Input"],
Cell[1813, 54, 166, 3, 43, "Input",
  InitializationCell->True],
Cell[1982, 59, 39, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[2046, 64, 19, 0, 74, "Section"],
Cell[2068, 66, 54, 1, 27, "Input"],
Cell[2125, 69, 145, 3, 59, "Input"],
Cell[2273, 74, 377, 8, 91, "Input"],

Cell[CellGroupData[{
Cell[2675, 86, 52, 1, 27, "Input"],
Cell[2730, 89, 98, 3, 27, "Output"]
}, Open  ]],
Cell[2843, 95, 92, 1, 27, "Input"],
Cell[2938, 98, 166, 2, 43, "Input"],
Cell[3107, 102, 371, 7, 123, "Input"],
Cell[3481, 111, 311, 6, 91, "Input"],

Cell[CellGroupData[{
Cell[3817, 121, 53, 1, 27, "Input"],
Cell[3873, 124, 189, 4, 43, "Output"]
}, Open  ]],
Cell[4077, 131, 76, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[4178, 136, 83, 1, 27, "Input"],
Cell[4264, 139, 53, 1, 27, "Output"],
Cell[4320, 142, 105, 3, 27, "Output"]
}, Open  ]],
Cell[4440, 148, 438, 8, 91, "Input"],
Cell[4881, 158, 165, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[5071, 164, 48, 1, 27, "Input"],
Cell[5122, 167, 88, 3, 27, "Output"]
}, Open  ]],
Cell[5225, 173, 153, 2, 43, "Input"],
Cell[5381, 177, 107, 2, 27, "Input"],
Cell[5491, 181, 64, 1, 27, "Input"],
Cell[5558, 184, 364, 7, 91, "Input"],
Cell[5925, 193, 43, 1, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[6005, 199, 19, 0, 44, "Section"],
Cell[6027, 201, 195, 4, 59, "Input",
  InitializationCell->True],
Cell[6225, 207, 418, 7, 123, "Input"],
Cell[6646, 216, 117, 2, 27, "Input"],
Cell[6766, 220, 122, 2, 43, "Input"],
Cell[6891, 224, 77, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[6993, 229, 212, 3, 43, "Input"],
Cell[7208, 234, 110, 3, 27, "Output"]
}, Open  ]],
Cell[7333, 240, 116, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[7474, 246, 70, 1, 27, "Input"],
Cell[7547, 249, 101, 3, 27, "Output"]
}, Open  ]],
Cell[7663, 255, 115, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[7803, 261, 258, 5, 91, "Input"],
Cell[8064, 268, 375, 7, 20, "Message"],
Cell[8442, 277, 397, 7, 33, "Message"],
Cell[8842, 286, 462, 8, 33, "Message"]
}, Open  ]],
Cell[9319, 297, 77, 1, 27, "Input"],
Cell[9399, 300, 76, 1, 27, "Input"],
Cell[9478, 303, 202, 3, 59, "Input"],
Cell[9683, 308, 143, 4, 59, "Input"],
Cell[9829, 314, 154, 3, 43, "Input"],
Cell[9986, 319, 386, 7, 91, "Input"],
Cell[10375, 328, 55, 1, 27, "Input"],
Cell[10433, 331, 113, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[10571, 337, 46, 1, 27, "Input"],
Cell[10620, 340, 94, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10751, 348, 810, 14, 187, "Input"],
Cell[11564, 364, 95, 3, 27, "Output"]
}, Open  ]],
Cell[11674, 370, 177, 3, 59, "Input"],
Cell[11854, 375, 64, 1, 27, "Input"],
Cell[11921, 378, 442, 10, 71, "Input"],

Cell[CellGroupData[{
Cell[12388, 392, 76, 1, 27, "Input"],
Cell[12467, 395, 87, 3, 27, "Output"]
}, Open  ]],
Cell[12569, 401, 54, 1, 27, "Input"],
Cell[12626, 404, 349, 6, 107, "Input"],
Cell[12978, 412, 75, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[13078, 417, 1021, 19, 299, "Input"],
Cell[14102, 438, 3892, 94, 139, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[18031, 537, 209, 4, 75, "Input"],
Cell[18243, 543, 100, 3, 27, "Output"]
}, Open  ]],
Cell[18358, 549, 59, 1, 27, "Input"],
Cell[18420, 552, 54, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[18499, 557, 58, 1, 27, "Input"],
Cell[18560, 560, 93, 3, 27, "Output"]
}, Open  ]],
Cell[18668, 566, 72, 1, 27, "Input"],
Cell[18743, 569, 140, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[18908, 575, 41, 1, 27, "Input"],
Cell[18952, 578, 90, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[19079, 586, 85, 1, 27, "Input"],
Cell[19167, 589, 98, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[19302, 597, 102, 2, 27, "Input"],
Cell[19407, 601, 98, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[19542, 609, 52, 1, 27, "Input"],
Cell[19597, 612, 486, 8, 107, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20120, 625, 63, 1, 27, "Input"],
Cell[20186, 628, 101, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20324, 636, 146, 2, 43, "Input"],
Cell[20473, 640, 251, 5, 43, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20761, 650, 48, 1, 27, "Input"],
Cell[20812, 653, 98, 3, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[20947, 661, 46, 1, 27, "Input"],
Cell[20996, 664, 92, 3, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[21137, 673, 30, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[21192, 677, 447, 10, 106, "Input"],
Cell[21642, 689, 53, 1, 26, "Output"],
Cell[21698, 692, 53, 1, 26, "Output"]
}, Open  ]],
Cell[21766, 696, 155, 2, 60, "Input"],
Cell[21924, 700, 88, 1, 27, "Input"],
Cell[22015, 703, 346, 7, 107, "Input"],

Cell[CellGroupData[{
Cell[22386, 714, 84, 1, 42, "Input"],
Cell[22473, 717, 64, 1, 41, "Output"]
}, Open  ]],
Cell[22552, 721, 170, 3, 60, "Input"],

Cell[CellGroupData[{
Cell[22747, 728, 226, 4, 75, "Input"],
Cell[22976, 734, 83, 1, 27, "Output"],
Cell[23062, 737, 88, 1, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[23199, 744, 27, 0, 44, "Section"],
Cell[23229, 746, 344, 7, 142, "Input"],

Cell[CellGroupData[{
Cell[23598, 757, 44, 1, 27, "Input"],
Cell[23645, 760, 748, 11, 71, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[24430, 776, 203, 4, 75, "Input"],
Cell[24636, 782, 45, 1, 26, "Output"]
}, Open  ]],
Cell[24696, 786, 143, 3, 43, "Input"],
Cell[24842, 791, 367, 7, 91, "Input"],
Cell[25212, 800, 1022, 19, 155, "Input"],
Cell[26237, 821, 107, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[26369, 827, 25, 0, 40, "Subsection"],

Cell[CellGroupData[{
Cell[26419, 831, 123, 2, 43, "Input"],
Cell[26545, 835, 46, 1, 26, "Output"]
}, Open  ]],
Cell[26606, 839, 106, 2, 43, "Input"],
Cell[26715, 843, 96, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[26836, 849, 199, 4, 43, "Input"],
Cell[27038, 855, 1180, 17, 33, "Message"],
Cell[28221, 874, 1180, 17, 33, "Message"],
Cell[29404, 893, 1171, 17, 46, "Message"],
Cell[30578, 912, 1171, 17, 46, "Message"],
Cell[31752, 931, 1171, 17, 46, "Message"],
Cell[32926, 950, 330, 5, 20, "Message"],
Cell[33259, 957, 42, 1, 26, "Output"]
}, Open  ]],
Cell[33316, 961, 204, 4, 43, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[33557, 970, 29, 0, 40, "Subsection"],

Cell[CellGroupData[{
Cell[33611, 974, 50, 1, 27, "Input"],
Cell[33664, 977, 264, 4, 41, "Output"]
}, Open  ]],
Cell[33943, 984, 650, 12, 107, "Input"],

Cell[CellGroupData[{
Cell[34618, 1000, 1170, 20, 155, "Input"],
Cell[35791, 1022, 393, 6, 20, "Message"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[36233, 1034, 25, 0, 40, "Subsection"],

Cell[CellGroupData[{
Cell[36283, 1038, 123, 2, 43, "Input"],
Cell[36409, 1042, 46, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36492, 1048, 46, 1, 27, "Input"],
Cell[36541, 1051, 53, 1, 26, "Output"]
}, Open  ]],
Cell[36609, 1055, 154, 3, 43, "Input"],
Cell[36766, 1060, 149, 3, 43, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36952, 1068, 25, 0, 40, "Subsection"],
Cell[36980, 1070, 449, 10, 94, "Input"],
Cell[37432, 1082, 580, 12, 115, "Input"],

Cell[CellGroupData[{
Cell[38037, 1098, 598, 11, 131, "Input"],
Cell[38638, 1111, 38, 1, 26, "Output"]
}, Open  ]],
Cell[38691, 1115, 443, 9, 78, "Input"],
Cell[39137, 1126, 923, 19, 139, "Input"],
Cell[40063, 1147, 414, 9, 78, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[40514, 1161, 30, 0, 40, "Subsection"],

Cell[CellGroupData[{
Cell[40569, 1165, 49, 1, 27, "Input"],
Cell[40621, 1168, 79, 1, 22, "Print"]
}, Open  ]],
Cell[40715, 1172, 50, 1, 27, "Input"],
Cell[40768, 1175, 63, 1, 44, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

