(************** Content-type: application/mathematica **************
                     CreatedBy='Mathematica 5.2'

                    Mathematica-Compatible Notebook

This notebook can be used with any Mathematica-compatible
application, such as Mathematica, MathReader or Publicon. The data
for the notebook starts with the line containing stars above.

To get the notebook into a Mathematica-compatible application, do
one of the following:

* Save the data starting with the line of stars above into a file
  with a name ending in .nb, then open the file inside the
  application;

* Copy the data starting with the line of stars above to the
  clipboard, then use the Paste menu command inside the application.

Data for notebooks contains only printable 7-bit ASCII and can be
sent directly in email or through ftp in text mode.  Newlines can be
CR, LF or CRLF (Unix, Macintosh or MS-DOS style).

NOTE: If you modify the data for this notebook not in a Mathematica-
compatible application, you must delete the line below containing
the word CacheID, otherwise Mathematica-compatible applications may
try to use invalid cache data.

For more information on notebooks and Mathematica-compatible 
applications, contact Wolfram Research:
  web: http://www.wolfram.com
  email: info@wolfram.com
  phone: +1-217-398-0700 (U.S.)

Notebook reader applications are available free of charge from 
Wolfram Research.
*******************************************************************)

(*CacheID: 232*)


(*NotebookFileLineBreakTest
NotebookFileLineBreakTest*)
(*NotebookOptionsPosition[     82688,       2451]*)
(*NotebookOutlinePosition[     83367,       2475]*)
(*  CellTagsIndexPosition[     83323,       2471]*)
(*WindowFrame->Normal*)



Notebook[{

Cell[CellGroupData[{
Cell["init", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Get[Environment["\<ALT_DISP\>"]]\), "\n", 
    \(\(SetDirectory[
        Environment["\<DCELL_DIR\>"] <> "\</temp\>"];\)\), "\n", 
    \(<< Graphics`Arrow`\), "\[IndentingNewLine]", 
    \(Get["\</home/abergman/Research/DCell/PetscImport.m\>"]\)}], "Input",
  InitializationCell->True],

Cell[BoxData[
    RowBox[{\(SetDirectory::"cdir"\), \(\(:\)\(\ \)\), "\<\"Cannot set \
current directory to \\!\\(\\\"/home/abergman/Research/DCell/temp\\\"\\). \\!\
\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"SetDirectory::cdir\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Date[] - FileDate["\<irregNode.0.Real64\>"]\)], "Input"],

Cell[BoxData[
    \({0, 0, 0, 0, 0, 3.5956019999999995`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\($IMAGESIZE = 650;\)\)], "Input"],

Cell[BoxData[{
    \(\(imp[file_] := 
        Transpose@
          Partition[Import[file <> "\<.Real64\>", "\<Real64\>"], 
            d1];\)\), "\n", 
    \(\(imp[file_, index_] := 
        imp[file <> "\<.\>" <> ToString@index];\)\), "\n", 
    \(\(\(imp[file_, end_, step_] := \(imp[file, #] &\) /@ 
          Range[0, end, step];\)\(\[IndentingNewLine]\)
    \)\), "\[IndentingNewLine]", 
    \(\(impNode[index_] := 
        Partition[
          Import["\<irregNode.\>" <> 
              ToString[index] <> "\<.Real64\>", "\<Real64\>"], 
          25];\)\)}], "Input",
  InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{

Cell["KDTree test", "Section"],

Cell[CellGroupData[{

Cell["2D", "Subsection"],

Cell[BoxData[{
    \(\(d1 = 32;\)\), "\[IndentingNewLine]", 
    \(\(ls = imp["\<ls\>"];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5}]\)];\)\), "\n", 
    \(\(\(Length[op]\)\(\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(index = 34;\)\), "\n", 
    \(\(kd = impNode[index];\)\), "\n", 
    \(\(kop = kd[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(kir = kd[\([All, {4, 5}]\)];\)\), "\n", 
    \(\(\(Length[kop]\)\(\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(eps = 2.5;\)\), "\n", 
    \(\(bbox = 
        Rectangle[{\(-eps\), \(-eps\)} + op[\([index]\)], {eps, eps} + 
            op[\([index]\)]];\)\), "\n", 
    \(\(pr = 
        Transpose[{2 {\(-eps\), \(-eps\)} + op[\([index]\)], 
            2 {eps, eps} + op[\([index]\)]}];\)\), "\n", 
    \(ListPlot[op, 
      AspectRatio \[Rule] 1, \[IndentingNewLine]PlotRange \[Rule] 
        pr, \[IndentingNewLine]Prolog \[Rule] {\[IndentingNewLine]Yellow, 
          bbox, \[IndentingNewLine]Orange, 
          Circle[op[\([index]\)], eps], \[IndentingNewLine]Hue[0], 
          PointSize[ .024], Point[op[\([index]\)]], \[IndentingNewLine]Green, 
          PointSize[ .02], Point /@ kop, \[IndentingNewLine]Blue, 
          Line /@ Thread[{kir, kop}], \[IndentingNewLine]Black, 
          PointSize[ .01]}\[IndentingNewLine]]\)}], "Input"],

Cell[BoxData[
    \(200\)], "Output"],

Cell[BoxData[
    \(7\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(\(Length@impNode[#] &\) /@ Range[Length[irreg]] // Sort\) // 
      ListPlot\)], "Input"],

Cell[BoxData[
    \(ListContourPlot[ls, Contours \[Rule] {0}, ContourShading \[Rule] None, 
      Prolog \[Rule] {\[IndentingNewLine]Yellow, 
          bbox, \[IndentingNewLine]Hue[0], PointSize[ .002], 
          Point[op[\([index]\)]], \[IndentingNewLine]Green, PointSize[ .002], 
          Point /@ kop, \[IndentingNewLine]Blue, 
          Line /@ Thread[{kir, kop}], \[IndentingNewLine]Black, 
          PointSize[ .01]}]\)], "Input"],

Cell[BoxData[
    \(ListPlot[op]\)], "Input"],

Cell["\<\
Given a level set, we can find irregular nodes
Given an irregular node, we can find its orthogonal projection
Given an OP, we can find its interpolated normal vector, curvature, and \
normal/tangential forces
Given OP and NV, we can define a local coordinate system 
Given a LC, we can interpolate surface derivatives by least squares
Given K and dS, we can calculate RHS IIM Correction terms\
\>", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["3D", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2, 3}]\)];\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5, 6}]\)];\)\), "\n", 
    \(\(nv = irreg[\([All, {7, 8, 9}]\)];\)\), "\[IndentingNewLine]", 
    \(\(\(Length[op]\)\(\[IndentingNewLine]\)
    \)\), "\n", 
    \(\(index = 21559;\)\), "\n", 
    \(\(kd = impNode[index];\)\), "\n", 
    \(\(kop = kd[\([All, {1, 2, 3}]\)];\)\), "\n", 
    \(\(kir = kd[\([All, {4, 5, 6}]\)];\)\), "\n", 
    \(Length[kop]\[IndentingNewLine]\), "\n", 
    \(\(eps = 1.8;\)\), "\n", 
    \(\(bbox = 
        Cuboid[{\(-eps\), \(-eps\), \(-eps\)} + 
            op[\([index]\)], {eps, eps, eps} + op[\([index]\)]];\)\), "\n", 
    \(\(pr = 
        Transpose[{2 {\(-eps\), \(-eps\), \(-eps\)} + op[\([index]\)], 
            2 {eps, eps, eps} + op[\([index]\)]}];\)\), "\n", 
    \(Show[
      Graphics3D[{Point /@ op, \[IndentingNewLine]Hue[0], PointSize[ .024], 
          Point[op[\([index]\)]], \[IndentingNewLine]Green, PointSize[ .02], 
          Point /@ 
            kop\[IndentingNewLine]}, \[IndentingNewLine]BoxRatios \[Rule] {1, 
            1, 1}, \[IndentingNewLine]PlotRange \[Rule] 
          pr, \[IndentingNewLine]ImageSize \[Rule] $IMAGESIZE\
\[IndentingNewLine]], \[IndentingNewLine]ViewPoint \[Rule] 
        5\ nv[\([index]\)]\[IndentingNewLine]]\)}], "Input"],

Cell[BoxData[
    \(22572\)], "Output"],

Cell[BoxData[
    \(12\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(sizes = \(Length@impNode[#] &\) /@ Range[Length[irreg]];\)\), "\n", 
    \(Union[sizes]\)}], "Input"],

Cell[BoxData[
    \({9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Position[sizes, _?\((# \[Equal] 12 &)\)]\)], "Input"],

Cell[BoxData[
    \(ListPlot@Sort[sizes]\)], "Input"],

Cell[BoxData[
    \(Histogram[sizes]\)], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["op/ir/nv", "Section"],

Cell[BoxData[{
    \(\(d1 = 630;\)\), "\[IndentingNewLine]", 
    \(\(phi = imp["\<ls\>"];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5}]\)];\)\), "\n", 
    \(\(nv = irreg[\([All, {7, 8}]\)];\)\), "\n", 
    \(Length[op]\)}], "Input"],

Cell[BoxData[
    \(4008\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[ir, PlotRange \[Rule] All, AspectRatio \[Rule] 1]\)], "Input"],

Cell[BoxData[
    \(ListPlot[op, PlotRange \[Rule] All, AspectRatio \[Rule] 1]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(ListContourPlot[
        phi, \[IndentingNewLine]Contours \[Rule] {0}, \
\[IndentingNewLine]ContourShading \[Rule] 
          None, \[IndentingNewLine]ImageSize \[Rule] 10  $IMAGESIZE, 
        Epilog \[Rule] {Hue[0], 
            PointSize[ .001], \[IndentingNewLine]\(Point[# + 1] &\) /@ op, 
            Hue[ .3], \[IndentingNewLine]\(Point[# + 1] &\) /@ ir, Hue[ .6], 
            MapThread[Line[{#1 + 1, #2 + 1}] &, {op, ir}]}];\)\)], "Input"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(ContourGraphics :: \\\"ctpnt\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListContourPlot[phi, \[IndentingNewLine]Contours \[Rule] {0}, 
      ContourShading \[Rule] None, \[IndentingNewLine]ImageSize \[Rule] 
        10  $IMAGESIZE\ , \[IndentingNewLine]Epilog \[Rule] {\
\[IndentingNewLine]PointSize[ .001], 
          Hue[0], \(Point[# + 1] &\) /@ op, \[IndentingNewLine]Hue[ .6], 
          MapThread[
            Arrow[#1, #1 + #2\ 3, HeadScaling \[Rule] Absolute] &, {op + 1, 
              nv}]\[IndentingNewLine]}]\)], "Input"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(ContourGraphics::"ctpnt"\), \(\(:\)\(\ \)\), "\<\"The contour \
is attempting to traverse a cell in which some of the points have not \
evaluated to numbers, and it will be dropped. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"ContourGraphics::ctpnt\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
    RowBox[{\(General::"stop"\), \(\(:\)\(\ \)\), "\<\"Further output of \
\\!\\(ContourGraphics :: \\\"ctpnt\\\"\\) will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", \
ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"]
}, Open  ]],

Cell[BoxData[{
    \(Union[Flatten@c]\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[c /. Indeterminate \[Rule] 0, 
        Epilog \[Rule] {Hue[0], PointSize[ .01], \(Point[# +  .5] &\) /@ op, 
            Hue[ .3], \(Point[# +  .5] &\) /@ ir}];\)\)}], "Input"],

Cell[BoxData[{
    RowBox[{
      RowBox[{"dy", "=", 
        RowBox[{"ListConvolve", "[", 
          RowBox[{
            RowBox[{"(", GridBox[{
                  {"0", ".5", "0"},
                  {"0", "0", "0"},
                  {"0", \(- .5\), "0"}
                  }], ")"}], ",", "phi"}], "]"}]}], ";"}], "\n", 
    RowBox[{
      RowBox[{"dx", "=", 
        RowBox[{"ListConvolve", "[", 
          RowBox[{
            RowBox[{"(", GridBox[{
                  {"0", "0", "0"},
                  {".5", "0", \(- .5\)},
                  {"0", "0", "0"}
                  }], ")"}], ",", "phi"}], "]"}]}], 
      ";"}], "\n", \(h = \@\(dx\^2 + dy\^2\); \), "\n", \(dyh = 
      dy/h; \), "\n", \(dxh = dx/h; \), "\n", \(fx = 
      ListInterpolation[dxh]; \), "\n", \(fy = 
        ListInterpolation[
          dyh];\), "\n", \(mynv = \({fx[Sequence @@ \((Reverse@# -  .5)\)], 
            fy[Sequence @@ \((Reverse@# -  .5)\)]} &\) /@ op\)}], "Input"],

Cell[BoxData[
    \(\(p = Take[phi, {2, \(-2\)}, {2, \(-2\)}];\)\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[Sign@phi, ImageSize \[Rule] $IMAGESIZE, 
      Epilog \[Rule] {PointSize[ .01], 
          Hue[0], \(Point[# -  .5] &\) /@ op, \[IndentingNewLine]Hue[ .6], 
          MapThread[
            Arrow[#1 -  .5, #1 + #2 -  .5, 
                HeadScaling \[Rule] Absolute] &, {op, 
              mynv}], \[IndentingNewLine]Hue[ .3], \(Point[# -  .5] &\) /@ 
            ir\[IndentingNewLine]}]\)], "Input"],

Cell[BoxData[
    RowBox[{"ListContourPlot", "[", 
      RowBox[{
        RowBox[{"(", GridBox[{
              {"1", "1", "1"},
              {"1", "0", "1"},
              {"1", "1", "1"}
              }], ")"}], 
        ",", \(Epilog \[Rule] {Hue[0], Point[{1, 1} + 1]}\)}], "]"}]], "Input"],

Cell[BoxData[
    \(ListDensityPlot[c - Mean[c]]\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[c - Mean[c], Mesh \[Rule] False, 
      PlotRange \[Rule] All]\)], "Input"],

Cell[BoxData[
    \(ParametricPlot[\[IndentingNewLine]{Sin[\[Theta]], 
        Sin[\[Theta]] Cos[\[Theta]]}, \[IndentingNewLine]{\[Theta], 0, 
        2  \[Pi]}]\)], "Input"],

Cell[BoxData[
    \(Block[{d = 
            30}, \[IndentingNewLine]Table[\@\(\((x + y)\)\^2\/\(2  a\) + \((x \
- y)\)\^2\/\(2  b\)\) /. {a \[Rule] 1, b \[Rule] 1}, {x, \(-d\), 
            d}, {y, \(-d\), d}]] // 
      ListDensityPlot[Sign[# - 15]] &\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Flatten[c - Mean[c]] // Total\)], "Input"],

Cell[BoxData[
    \(\(-1.0005885009434223`*^-14\)\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["", "Section"],

Cell[BoxData[{
    \(\(d1 = 63;\)\), "\n", 
    \(\(index = 0;\)\), "\[IndentingNewLine]", 
    \(\(ls = imp["\<ls\>", index];\)\), "\[IndentingNewLine]", 
    \(\(c = imp["\<c\>", index];\)\), "\[IndentingNewLine]", 
    \(\(p = imp["\<p\>", index];\)\), "\[IndentingNewLine]", 
    \(\(px = imp["\<px\>", index];\)\), "\n", 
    \(\(py = imp["\<py\>", index];\)\), "\[IndentingNewLine]", 
    \(\(u = imp["\<u\>", index];\)\), "\n", 
    \(\(v = imp["\<v\>", index];\)\), "\[IndentingNewLine]", 
    \(ListDensityPlot[p, ImageSize \[Rule] $IMAGESIZE]\)}], "Input"],

Cell[BoxData[{
    \(\(irreg = impNode[index];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2}]\)] +  .5;\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5}]\)] +  .5;\)\), "\[IndentingNewLine]", 
    \(\(nv = irreg[\([All, {7, 8}]\)];\)\), "\[IndentingNewLine]", 
    \(\(k = irreg[\([All, 11]\)];\)\), "\[IndentingNewLine]", 
    \(\(f1 = irreg[\([All, 12]\)];\)\), "\[IndentingNewLine]", 
    \(\(df1 = irreg[\([All, 13]\)];\)\), "\[IndentingNewLine]", 
    \(\(ddf1 = irreg[\([All, 14]\)];\)\), "\[IndentingNewLine]", 
    \(\(f2 = irreg[\([All, 15]\)];\)\), "\[IndentingNewLine]", 
    \(\(df2 = irreg[\([All, 16]\)];\)\), "\[IndentingNewLine]", 
    \(\(ddf2 = irreg[\([All, 17]\)];\)\), "\[IndentingNewLine]", 
    \(\(corr = irreg[\([All, 18]\)];\)\)}], "Input"],

Cell[BoxData[
    \(ListDensityPlot[v]\)], "Input"],

Cell[BoxData[{
    \(\(ux = \(RotateRight[#, \(-1\)] - RotateRight[#, 1] &\) /@ 
          u;\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[ux];\)\)}], "Input"],

Cell[BoxData[{
    \(\(vy = 
        RotateRight[v, \(-1\)] - 
          RotateRight[v, 1];\)\), "\[IndentingNewLine]", 
    \(ListDensityPlot[vy]\)}], "Input"],

Cell[BoxData[{
    \(\(div = ux + vy;\)\), "\[IndentingNewLine]", 
    \(ListPlot3D[\(-div\), ImageSize \[Rule] 1500]\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Total[Flatten@div]\)], "Input"],

Cell[BoxData[
    \(\(-5.487277299209836`*^-14\)\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[corr]\)], "Input"],

Cell[BoxData[{
    \(\(o = op - ir;\)\), "\[IndentingNewLine]", 
    \(\(pp = 
        Flatten@Table[
            Ordering[\(Norm[# + o[\([i]\)]] &\) /@ o, 1], {i, 1, 
              Length[o]}];\)\)}], "Input"],

Cell[BoxData[
    \(Plot[x, {x, 0, d1}, AspectRatio \[Rule] 1, 
      ImageSize \[Rule] 
        1500, \[IndentingNewLine]Epilog \[Rule] \
{Table[{\[IndentingNewLine]Hue[
                Random[]], \[IndentingNewLine]Line[{ir[\([i]\)], 
                  ir[\([pp[\([i]\)]]\)]}]}, {i, Length[o]}]}]\)], "Input"],

Cell[BoxData[
    \(Table[corr[\([i]\)] - corr[\([p[\([i]\)]]\)], {i, Length[o]}] // 
      ListPlot\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(Round[ir[\([40]\)] - 0.5] - 31\), "\[IndentingNewLine]", 
    \(Round[ir[\([pp[\([40]\)]]\)] - 0.5] - 31\), "\[IndentingNewLine]", 
    \(Table[\[IndentingNewLine]c[\([Sequence @@ 
                Round[ir[\([idx]\)] - 0.5]]\)] - 
          c[\([Sequence @@ 
                Round[ir[\([pp[\([idx]\)]]\)] - 
                    0.5]]\)], \[IndentingNewLine]{idx, Length[irreg]}] // 
      ListPlot\)}], "Input"],

Cell[BoxData[
    \({\(-10\), \(-11\)}\)], "Output"],

Cell[BoxData[
    \({10, 11}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[c, 
      PlotRange \[Rule] \({{15, 45}, {15, 45}, All} 
            Epilog \[Rule] {Point /@ ir}\)]\)], "Input"],

Cell[BoxData[
    \(ListDensityPlot[p, ImageSize \[Rule] 1500, 
      PlotRange \[Rule] {Select[Flatten[p], # > \(- .02\) &] // Min, Max[p]}, 
      Epilog \[Rule] {Hue[0], PointSize[ .005], Point /@ op, Hue[ .3], 
          Point /@ ir, Hue[ .6], 
          MapThread[Line[{#1, #2}] &, {op, ir}]}]\)], "Input"],

Cell[BoxData[
    \(Block[{m, max, min}, \[IndentingNewLine]m = 
        df1; \[IndentingNewLine]max = Max[m]; \[IndentingNewLine]min = 
        Min[m]; \[IndentingNewLine]\[IndentingNewLine]ListDensityPlot[
        p, \[IndentingNewLine]ImageSize \[Rule] 
          650, \[IndentingNewLine]Epilog \[Rule] {PointSize[ .015], 
            MapThread[\[IndentingNewLine]{RGBColor[#1, 0, 0], 
                  Point[#2]} &, {Rescale[m, {min, max}], 
                op}]}]\[IndentingNewLine]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(p[\([32, 32]\)]\)], "Input"],

Cell[BoxData[
    \(0.`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot3D[ls, ImageSize \[Rule] 1500, PlotRange \[Rule] All, 
      Mesh \[Rule] True, Lighting \[Rule] False, 
      ColorFunction \[Rule] \((RGBColor[0, 2  Abs[#1 -  .5], 
              0] &)\)]\)], "Input"],

Cell[BoxData[
    \(Histogram[Select[Flatten[c], # \[NotEqual] 0.  &]]\)], "Input"],

Cell[BoxData[
    \(Block[{vv = 
          imp["\<u\>", 99, 5]}, \[IndentingNewLine]Block[{min = Min[vv], 
          max = Max[
              vv]}, \[IndentingNewLine]\(\(ListPlot3D[#, 
                ImageSize \[Rule] 1000, DisplayFunction \[Rule] ani, 
                PlotRange \[Rule] {min, max}] &\) /@ 
            vv;\)\[IndentingNewLine]]]\)], "Input"],

Cell[BoxData[
    \(\(g = 
        Block[{u = imp["\<u\>", 45, 1], 
            p = imp["\<p\>", 45, 1]}, \[IndentingNewLine]Block[{maxU = 
                Max[u], minU = Min[u], maxP = Max[p], 
              minP = Min[
                  p]}, \[IndentingNewLine]MapThread[\[IndentingNewLine]\
DisplayTogetherArray[\[IndentingNewLine]ListPlot3D[#2, 
                    PlotRange \[Rule] {minP, maxP}, 
                    BoxRatios \[Rule] {1, 1, 
                        0.6`}], \[IndentingNewLine]ListPlot3D[#1, 
                    BoxRatios \[Rule] {1, 1, 0.6`}, 
                    PlotRange \[Rule] {minU, maxU}, Lighting \[Rule] False, 
                    ColorFunction \[Rule] \((RGBColor[
                            UnitStep[ .5 - #] Abs[\@\(# -  .5\)]/ .71, 
                            UnitStep[# -  .5] Abs[\@\(# -  .5\)]/ .71, 
                            0] &)\)], \[IndentingNewLine]DisplayFunction \
\[Rule] ani, \[IndentingNewLine]GraphicsSpacing \[Rule] 
                    0, \[IndentingNewLine]ImageSize \[Rule] 
                    1200\[IndentingNewLine]] &, {u, 
                p}]\[IndentingNewLine]]];\)\)], "Input"],

Cell[BoxData[
    \(Plot[Abs[\@\(x -  .5\)]/ .7\ UnitStep[x -  .5], {x, 0, 1}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(p = imp["\<p\>", 40, 1];\)\), "\[IndentingNewLine]", 
    \(Max[p]\), "\[IndentingNewLine]", 
    \(Min[p]\)}], "Input"],

Cell[BoxData[
    \(0.64105417042793`\)], "Output"],

Cell[BoxData[
    \(\(-0.35715882019829165`\)\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(d1 = 63;\)\), "\n", 
    \(\(ls = imp["\<ls\>", 99, 1];\)\)}], "Input"],

Cell[BoxData[
    \(\(g = \(ListContourPlot[#, Contours \[Rule] {0}, 
              ContourShading \[Rule] None, 
              ContourStyle \[Rule] {Hue[ .6], Thickness[ .01]}, 
              ImageSize \[Rule] 512, DisplayFunction \[Rule] Identity] &\) /@ 
          ls;\)\)], "Input"],

Cell[BoxData[
    \(\(\(Show[#, DisplayFunction \[Rule] ani, ImageSize \[Rule] 1000] &\) /@ 
        g;\)\)], "Input"],

Cell[BoxData[
    \(\(Count[Flatten@\(Sign@#\), \(-1\)]/d1\^2.  &\) /@ ls // 
      ListPlot\)], "Input"],

Cell[BoxData[
    \(MapIndexed[\[IndentingNewLine]Export["\<ani.\>" <> 
            ToString[100 + #2[\([1]\)]] <> "\<.jpg\>", #1] &, g]\)], "Input"],

Cell[BoxData[
    \(<< Graphics`PlotField`\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(g = 
        Map[\((\[IndentingNewLine]p = 
                imp["\<p\>", #]; \[IndentingNewLine]vx = 
                imp["\<u\>", #]; \[IndentingNewLine]vy = 
                imp["\<v\>", #]; \[IndentingNewLine]ls = 
                imp["\<ls\>", #]; \[IndentingNewLine]fvx = 
                ListInterpolation[vx]; \[IndentingNewLine]fvy = 
                ListInterpolation[
                  vy]; \[IndentingNewLine]DisplayTogether[\[IndentingNewLine]\
ListDensityPlot[p, ColorFunction \[Rule] Hue, 
                  PlotRange \[Rule] {All, 
                      All,  .4 {\(-0.35715882019829165`\), 
                          0.64105417042793`}}], \
\[IndentingNewLine]PlotVectorField[{fvy[x, y], 
                    fvx[x, y]}, \[IndentingNewLine]{x, 1, d1}, {y, 1, d1}, 
                  ScaleFactor \[Rule] None, 
                  ScaleFunction \[Rule] \((Chop[#/ .05,  .1] &)\)], \
\[IndentingNewLine]ListContourPlot[ls, Contours \[Rule] {0}, 
                  ContourShading \[Rule] None, 
                  ContourStyle \[Rule] {White, 
                      Thickness[ .02]}], \[IndentingNewLine]ListContourPlot[
                  ls, Contours \[Rule] {0}, ContourShading \[Rule] None, 
                  ContourStyle \[Rule] {Black, 
                      Thickness[ .01]}], \[IndentingNewLine]ImageSize \[Rule] 
                  512, \[IndentingNewLine]DisplayFunction \[Rule] 
                  ani]\[IndentingNewLine])\) &, Range[0, 45]];\)\)], "Input"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
    \(\(magVel = \@\(vx\^2 + vy\^2\);\)\), "\n", 
    \(\(thres = \(( .5 
               Sign[magVel - 10] +  .5)\);\)\), "\[IndentingNewLine]", 
    \(ListPlot3D[magVel]\)}], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Arc Length (surfderiv.c)", "Section"],

Cell["{nx, ny} mangled to local cooridinate {xi, eta}", "Subsection"],

Cell[CellGroupData[{

Cell["{df1,df2} mangled to rotated normal vector {nx, ny}", "Subsection"],

Cell[BoxData[{
    \(\(d1 = 63;\)\), "\[IndentingNewLine]", 
    \(\(ls = imp["\<ls\>"];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5}]\)];\)\), "\n", 
    \(Length[op]\)}], "Input"],

Cell[BoxData[
    \(172\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(index = 288;\)\), "\[IndentingNewLine]", 
    \(\(kd = impNode[index];\)\), "\n", 
    \(\(kop = kd[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(kir = kd[\([All, {4, 5}]\)];\)\), "\n", 
    \(\(kf1 = kd[\([All, 12]\)];\)\), "\[IndentingNewLine]", 
    \(\(lc = Reverse /@ kd[\([All, {7, 8}]\)];\)\), "\[IndentingNewLine]", 
    \(\(no = Reverse /@ kd[\([All, {13, 16}]\)];\)\), "\[IndentingNewLine]", 
    \(\(sir = kd[\([All, \(-1\)]\)];\)\), "\[IndentingNewLine]", 
    \(TableForm[Sort@\(Transpose@{sir, lc, no}\)]\), "\[IndentingNewLine]", 
    \(Length[kop]\)}], "Input"],

Cell[BoxData[
    TagBox[\(Transpose[{\(Partition[$Failed, 18]\)\[LeftDoubleBracket]
            All, \(-1\)\[RightDoubleBracket], \(Partition[
              18, $Failed]\)\[LeftDoubleBracket]
            Reverse[All], {8, 7}\[RightDoubleBracket], \(Partition[
              18, $Failed]\)\[LeftDoubleBracket]
            Reverse[All], {16, 13}\[RightDoubleBracket]}]\),
      Function[ BoxForm`e$, 
        TableForm[ BoxForm`e$]]]], "Output"],

Cell[BoxData[
    \(3\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(eps = 1.5;\)\), "\[IndentingNewLine]", 
    \(ListPlot[lc, PlotRange \[Rule] {{\(-eps\), eps}, {\(-eps\), eps}}, 
      AxesOrigin \[Rule] {0, 0}, Axes \[Rule] True, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {MapThread[
            Text[ToString[#2], #1 + {0,  .1}] &, {lc, sir}], 
          MapThread[Line[{#1, #1 + #2}] &, {lc, no}]}]\)}], "Input"],

Cell[BoxData[
    \(ListPlot[op, AspectRatio \[Rule] 1, 
      Prolog \[Rule] {Red, PointSize[ .02], Point[op[\([index]\)]], Black, 
          PointSize[ .01]}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(equ = Fit[lc, {1, x, x\^2}, x]\), "\n", 
    \(Plot[equ, {x, \(-eps\), eps}, ImageSize \[Rule] $IMAGESIZE, 
      AspectRatio -> 1, Epilog \[Rule] {Point /@ lc}, 
      AxesOrigin \[Rule] {0, 0}, Axes \[Rule] True, Frame \[Rule] True, 
      PlotRange \[Rule] {{\(-eps\), eps}, {\(-eps\), eps}}]\)}], "Input"],

Cell[BoxData[
    \(\(-0.017610709890872114`\) + 0.18377095757724202`\ x + 
      0.511545303760312`\ x\^2\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input"],

Cell[BoxData[
    \({0.8994667885555431`, 
      1.3189190388974332`, \(-0.19001564996391904`\), \
\(-1.1096289344720414`\), \(-1.1183144265128115`\), 0.`}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Plot[x, {x, \(-2\), 2}, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {Red, 
          Point /@ \(({\(NIntegrate[\@\(1 + D[equ, x]\^2\), {x, 0, #}] &\) /@ 
                    lc[\([\)\(All, 1\)\(]\)], 
                  sir}\[Transpose] )\)}]\)], "Input"],

Cell[BoxData[
    \(<< Statistics`DataManipulation`\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(\(Length@impNode[#] &\) /@ 
        Range@Length[op];\)\), "\[IndentingNewLine]", 
    \(Frequencies[%]\), "\[IndentingNewLine]", 
    \(BarChart[%]\)}], "Input"],

Cell[BoxData[
    \({{4, 3}, {16, 4}, {136, 5}, {224, 6}, {12, 7}}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[{sir, kf1}\[Transpose] , AspectRatio \[Rule] 1]\)], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["viz_SurfaceDerivatives", "Section"],

Cell[BoxData[
    \(\(d1 = 63;\)\)], "Input"],

Cell[BoxData[{
    \(\(dat = 
        ToExpression@
          Import["\<viz_SurfaceDerivatives\>", "\<Text\>"];\)\), "\n", 
    \(Length[dat]\), "\n", 
    \(\(Length /@ dat // Sort\) // ListPlot\)}], "Input"],

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\[IndentingNewLine]", 
    \(\(op = irreg[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5}]\)];\)\), "\[IndentingNewLine]", 
    \(\(f1 = irreg[\([All, 12]\)];\)\), "\[IndentingNewLine]", 
    \(\(df1 = irreg[\([All, 13]\)];\)\), "\n", 
    \(\(ddf1 = irreg[\([All, 14]\)];\)\), "\[IndentingNewLine]", 
    \(\(k = irreg[\([All, 11]\)];\)\)}], "Input"],

Cell[BoxData[
    \(ListPlot[ddf1, PlotRange \[Rule] All]\)], "Input"],

Cell[BoxData[
    \(\(Function[
        d, \[IndentingNewLine]ListPlot[op, AspectRatio \[Rule] 1, 
          Epilog \[Rule] {PointSize[ .02], 
              MapThread[{\[IndentingNewLine]If[#2 < 0, 
                      RGBColor[\@\(#2/Min[d]\), 0, 0], 
                      RGBColor[0, \@\(#2/Max[d]\), 0]], Point[#1]} &, {op, 
                  d}]}]\[IndentingNewLine]]\)[df1]\)], "Input"],

Cell[BoxData[
    \(ListPlot[op, AspectRatio \[Rule] 1, 
      Epilog \[Rule] {PointSize[ .02], 
          MapThread[{\[IndentingNewLine]If[#2 < 0, 
                  RGBColor[\@\(#2/Min[df1]\), 0, 0], 
                  RGBColor[0, \@\(#2/Max[df1]\), 0]], Point[#1]} &, {op, 
              df1}]}]\)], "Input"],

Cell[BoxData[{
    \(\(o = op - ir;\)\), "\n", 
    \(\(p = 
        Flatten@Table[
            Ordering[\(Norm[# + o[\([i]\)]] &\) /@ o, 1], {i, 1, 
              Length[o]}];\)\), "\n", 
    \(\(Plot[x, {x, \(-1\), d1}, 
        Epilog \[Rule] {Table[\[IndentingNewLine]Line[{op[\([i]\)], 
                  op[\([p[\([i]\)]]\)]}], {i, Length[o]}]}];\)\)}], "Input"],

Cell[BoxData[
    \(Table[ddf1[\([i]\)] - ddf1[\([p[\([i]\)]]\)], {i, Length[o]}] // 
      ListPlot\)], "Input"],

Cell[BoxData[{
    RowBox[{
      RowBox[{"f", "=", 
        RowBox[{"Function", "[", 
          RowBox[{"idx", ",", "\[IndentingNewLine]", 
            
            RowBox[{\({cos, sin} = irreg[\([idx, {7, 8}]\)]\), ";", 
              "\[IndentingNewLine]", \(cc = dat[\([idx]\)]\), ";", 
              "\[IndentingNewLine]", \(c = Most[cc]\), ";", 
              "\[IndentingNewLine]", \(s = c[\([All, 5]\)]\), ";", 
              "\[IndentingNewLine]", \(pp = c[\([All, {1, 2}]\)]\), ";", 
              "\[IndentingNewLine]", 
              RowBox[{
                RowBox[{
                  RowBox[{
                    RowBox[{"(", GridBox[{
                          {"cos", "sin"},
                          {\(-sin\), "cos"}
                          }], ")"}], ".", "#"}], "&"}], "/@", "pp"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], 
      ";"}], "\[IndentingNewLine]", \(idx = 
        40;\), "\[IndentingNewLine]", \(ListPlot[f[idx], 
      PlotRange \[Rule] {{\(-2.5\), 2.5}, {\(-2.5\), 2.5}}, 
      AspectRatio \[Rule] 1, 
      Epilog \[Rule] {PointSize[ .03], Green, Point /@ f[p[\([idx]\)]], 
          PointSize[ .02], Blue, Point /@ f[idx]}]\)}], "Input"],

Cell[BoxData[{
    \(\(idx = 150;\)\), "\[IndentingNewLine]", 
    \(\(cc = dat[\([idx]\)];\)\), "\[IndentingNewLine]", 
    \(\(c = Most[cc];\)\), "\[IndentingNewLine]", 
    \(\(s = c[\([All, 5]\)];\)\), "\[IndentingNewLine]", 
    \(\(f1 = c[\([All, 6]\)];\)\), "\[IndentingNewLine]", 
    \(\(p = Sort@c[\([All, {1, 2}]\)];\)\), "\[IndentingNewLine]", 
    \(\(q = 
        Sort[c[\([All, {3, 
                4}]\)], #1[\([2]\)] < #2[\([2]\)] &];\)\), "\
\[IndentingNewLine]", 
    \(\(pn = 0  c[\([1, {1, 2}]\)];\)\), "\[IndentingNewLine]", 
    \(\(qn = 0  c[\([1, {3, 4}]\)];\)\), "\[IndentingNewLine]", 
    \(ListPlot[
      p, \[IndentingNewLine]PlotRange \[Rule] {{\(-3\), 3}, {\(-3\), 3}}, 
      AspectRatio \[Rule] 
        1, \[IndentingNewLine]Epilog \[Rule] {\[IndentingNewLine]Line[{{0, 
                0}, pn}], \[IndentingNewLine]Line[p], \[IndentingNewLine]Hue[
            0], \[IndentingNewLine]Point /@ q, Line[q], 
          Line[{{0, 0}, qn}], \[IndentingNewLine]PointSize[ .03], 
          MapThread[{RGBColor[0, 0, #1], 
                Point[#2]} &\[IndentingNewLine], {Rescale[f1], 
              c[\([All, {3, 4}]\)]}]\[IndentingNewLine]}]\)}], "Input"],

Cell[BoxData[
    \(ListPlot[Thread[{s, f1}]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(df1[\([idx]\)]\), "\[IndentingNewLine]", 
    \(ddf1[\([idx]\)]\)}], "Input"],

Cell[BoxData[
    \(\(-0.1401679948739602`\)\)], "Output"],

Cell[BoxData[
    \(\(-0.06514735966076354`\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Evaluate@Fit[Thread[{s, f1}], {1, x, x\^2}, x]\)], "Input"],

Cell[BoxData[
    \(\(-0.16678482308914216`\) - 0.14016798443277254`\ x - 
      0.032573738592583994`\ x\^2\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Plot[
      Evaluate@Fit[Thread[{s, f1}], {1, x, x\^2}, x], {x, Min[s], Max[s]}, 
      Epilog \[Rule] {Point /@ Thread[{s, f1}]}, 
      ImageSize \[Rule] $IMAGESIZE]\)], "Input"],

Cell[BoxData[{\({cos, sin} = pn;\), "\[IndentingNewLine]", 
    RowBox[{
      RowBox[{"qq", "=", 
        RowBox[{
          RowBox[{
            RowBox[{
              RowBox[{"(", GridBox[{
                    {"cos", "sin"},
                    {\(-sin\), "cos"}
                    }], ")"}], ".", "#"}], "&"}], "/@", "p"}]}], 
      ";"}], "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
      RowBox[{
      "p", ",", 
        "\[IndentingNewLine]", \(PlotRange \[Rule] {{\(-2\), 2}, {\(-2\), 
              2}}\), ",", \(AspectRatio \[Rule] 1\), ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Epilog", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
            
            RowBox[{\(Line[{{0, 0}, pn}]\), ",", 
              "\[IndentingNewLine]", \(Line[p]\), ",", 
              "\[IndentingNewLine]", \(Hue[0]\), ",", 
              "\[IndentingNewLine]", \(Point /@ qq\), ",", \(Line[qq]\), ",", 
              
              RowBox[{"Line", "[", 
                RowBox[{"{", 
                  RowBox[{\({0, 0}\), ",", 
                    RowBox[{
                      RowBox[{"(", GridBox[{
                            {"cos", "sin"},
                            {\(-sin\), "cos"}
                            }], ")"}], ".", "pn"}]}], "}"}], "]"}]}], 
            "\[IndentingNewLine]", "}"}]}]}], "]"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{\(p = 
      Table[{i, 0}, {i, 0, 
          5}]\), "\[IndentingNewLine]", \(\[Theta] =  .1;\), "\
\[IndentingNewLine]", \(pn = {Cos[\[Theta]], 
        Sin[\[Theta]]}\), "\[IndentingNewLine]", \({cos, sin} = 
        pn;\), "\[IndentingNewLine]", 
    RowBox[{"q", "=", 
      RowBox[{
        RowBox[{
          RowBox[{
            RowBox[{"(", GridBox[{
                  {"cos", "sin"},
                  {\(-sin\), "cos"}
                  }], ")"}], ".", "#"}], "&"}], "/@", "p"}]}]}], "Input"],

Cell[BoxData[
    \({{0, 0}, {1, 0}, {2, 0}, {3, 0}, {4, 0}, {5, 0}}\)], "Output"],

Cell[BoxData[
    \({0.9950041652780258`, 0.09983341664682815`}\)], "Output"],

Cell[BoxData[
    \({{0.`, 
        0.`}, {0.9950041652780258`, \(-0.09983341664682815`\)}, \
{1.9900083305560516`, \(-0.1996668332936563`\)}, {2.9850124958340776`, \
\(-0.29950024994048446`\)}, {3.9800166611121033`, \(-0.3993336665873126`\)}, \
{4.975020826390129`, \(-0.4991670832341408`\)}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(qq - q // Chop[#, 10^\(-6\)] &\)], "Input"],

Cell[BoxData[
    \({{1.`, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}, {0, 0}}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(qq = {{1.000000, 
            0.000000}, {0.995004, \(-0.099833\)}, {1.990008, \(-0.199667\)}, \
{2.985012, \(-0.299500\)}, {3.980016, \(-0.399334\)}, {4.975020, \
\(-0.499167\)}};\)\)], "Input"],

Cell[BoxData[
    \(ListPlot[
      p, \[IndentingNewLine]PlotRange \[Rule] {{\(-7\), 7}, {\(-7\), 7}}, 
      AspectRatio \[Rule] 
        1, \[IndentingNewLine]Epilog \[Rule] {\[IndentingNewLine]Line[{{0, 
                0}, pn}], \[IndentingNewLine]Line[p], \[IndentingNewLine]Hue[
            0], \[IndentingNewLine]Point /@ q, Line[q], 
          Line[{{0, 0}, {1, 0}}]\[IndentingNewLine]}]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \({Cos[ .01], Sin[ .01]}\)], "Input"],

Cell[BoxData[
    \({0.9999500004166653`, 0.009999833334166664`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["viz_LocalStencil", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(acoeff = 
        Most@\(ToExpression@
            Import["\<viz_LocalStencilACoeff\>", "\<Text\>"]\);\)\), "\n", 
    \(Dimensions[acoeff]\)}], "Input"],

Cell[BoxData[
    \({172, 6}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(dat = 
        Most /@ Most@\(ToExpression@
              Import["\<viz_LocalStencil\>", "\<Text\>"]\);\)\), "\n", 
    \(Dimensions[dat]\)}], "Input"],

Cell[BoxData[
    \({172}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\n", 
    \(\(op = irreg[\([All, {1, 2}]\)];\)\), "\n", 
    \(\(ir = irreg[\([All, {4, 5}]\)];\)\), "\[IndentingNewLine]", 
    \(\(nv = irreg[\([All, {7, 8}]\)];\)\)}], "Input"],

Cell[BoxData[{
    \(\(idx = 6;\)\), "\[IndentingNewLine]", 
    \(Block[{sten = dat[\([idx]\)], op = op[\([idx]\)], nv = nv[\([idx]\)], 
        ir = ir[\([idx]\)], z}, \[IndentingNewLine]z = 
        op - ir; \[IndentingNewLine]ListPlot[
        sten[\([All, 1]\)], \[IndentingNewLine]AspectRatio \[Rule] 
          1, \[IndentingNewLine]Epilog \[Rule] {Line /@ sten, 
            Arrow[z, z + nv], Hue[0], PointSize[ .02], 
            Point[op - ir]}, \[IndentingNewLine]PlotRange \[Rule] {{\(-2\), 
              2}, {\(-2\), 2}}\[IndentingNewLine]]; \[IndentingNewLine]Print[
        nv]\[IndentingNewLine]]\)}], "Input"],

Cell[BoxData[
    \(ListPlot[acoeff[\([All, 1]\)]]\)], "Input"],

Cell[BoxData[{
    \(\(o = op - ir;\)\), "\[IndentingNewLine]", 
    \(\(p = 
        Flatten@Table[
            Ordering[\(Norm[# + o[\([i]\)]] &\) /@ o, 1], {i, 1, 
              Length[o]}];\)\)}], "Input"],

Cell[BoxData[
    \(Plot[x, {x, \(-1\), 1}, 
      Epilog \[Rule] {Table[\[IndentingNewLine]Line[{o[\([i]\)], 
                o[\([p[\([i]\)]]\)]}], {i, Length[o]}]}]\)], "Input"],

Cell[BoxData[
    \(Table[
        acoeff[\([i, 6]\)] - acoeff[\([p[\([i]\)], 6]\)], {i, Length[o]}] // 
      ListPlot\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["surfquant.c", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"band.10000.array", "params.txt", "phi.10000.Real64", 
      "phi.10000.Real64.info", "phi.iimIrregNode.10000.array", 
      "phi.iimIrregNode.10000.array.info", "phi.pos", "phi.size"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(ImportIrreg["\<phi.iimIrregNode.10000.array\>"];\)\), "\
\[IndentingNewLine]", 
    \(\({phi, pos} = ImportGrid["\<phi\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[phi]\), "\[IndentingNewLine]", 
    \(\(phi = phi[\([1]\)];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi, PlotRange \[Rule] {\(-4\), 4}];\)\)}], "Input"],

Cell[BoxData[
    \({1, 34, 34}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ListPlot[ir`X, AspectRatio \[Rule] 1]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(ListPlot[ir`X, PlotRange \[Rule] {{\(-2\), 3}, {\(-2\), 3}}, 
        Epilog \[Rule] {MapThread[{If[#3 > 0, Green, Red], 
                  Line[{#1, #1 + #2\ #3}]} &, {ir`X, ir`nv, 3  ir`f1}]}, 
        AspectRatio \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \(\(ListPlot[op, 
        Epilog \[Rule] {MapThread[{Line[{#1, #1 + #3  #2 + #4 \(({\(-1\), 1} 
                              Reverse@#2)\)}]} &, {op, nv, df1, df2}]}, 
        AspectRatio \[Rule] 1];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Sort[df1] // ListPlot\)], "Input"],

Cell[BoxData[
    RowBox[{\(ListPlot::"list"\), \(\(:\)\(\ \)\), "\<\"List expected at \
position \\!\\(1\\) in \\!\\(ListPlot[\\(\\(String[]\\)\\)]\\). \
\\!\\(\\*ButtonBox[\\\"More\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\
\\\", ButtonFrame->None, ButtonData:>\\\"General::list\\\"]\\)\"\>"}]], \
"Message"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(irreg = impNode[0];\)\), "\n", 
    \(Dimensions[irreg]\), "\n", 
    \(\(op = irreg[\([All, {1, 2, 3}]\)];\)\), "\n", 
    \(\(nv = irreg[\([All, {7, 8, 9}]\)];\)\), "\n", 
    \(\(sv = irreg[\([All, {19, 20, 21}]\)];\)\), "\n", 
    \(\(rv = irreg[\([All, {22, 23, 24}]\)];\)\), "\n", 
    \(\(k = irreg[\([All, 11]\)];\)\), "\[IndentingNewLine]", 
    \(\(df1 = irreg[\([All, 13]\)];\)\)}], "Input"],

Cell[BoxData[
    \({22572, 24}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListPlot[Sort[df1]]\)], "Input"],

Cell[BoxData[
    \(<< Graphics`Graphics3D`\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(minK = Min[k]\), "\[IndentingNewLine]", 
    \(maxK = Max[k]\), "\[IndentingNewLine]", 
    \(zeroK = minK\/\(\(-maxK\) + minK\)\)}], "Input"],

Cell[BoxData[
    \(\(-0.7715187966641119`\)\)], "Output"],

Cell[BoxData[
    \(0.3067032015900473`\)], "Output"],

Cell[BoxData[
    \(0.7155472601313492`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Graphics3D[\[IndentingNewLine]MapThread[{If[#1 < zeroK, 
                  Hue[ .3, 1 - #1\/zeroK, 1], 
                  Hue[0, 1 - \(1 - #1\)\/\(1 - zeroK\), 1]], 
                Point[#2]} &, {Rescale@k, op}]\[IndentingNewLine]] // 
        Show;\)\)], "Input"],

Cell[BoxData[{
    \(\(zeroK = 0.5;\)\), "\[IndentingNewLine]", 
    \(\(Graphics3D[\[IndentingNewLine]MapThread[{If[#1 < zeroK, 
                  Hue[ .3, 1 - #1\/zeroK, 1], 
                  Hue[0, 1 - \(1 - #1\)\/\(1 - zeroK\), 1]], 
                Point[#2]} &, {Rescale@k, op}]\[IndentingNewLine]] // 
        Show;\)\)}], "Input"],

Cell[BoxData[
    \(\(Graphics[\[IndentingNewLine]MapThread[{If[#1 < zeroK, 
                  Hue[ .3, 1 - #1\/zeroK, 1], 
                  Hue[0, 1 - \(1 - #1\)\/\(1 - zeroK\), 1]], 
                Point[#2[\([{1, 2}]\)]]} &, 
            Select[{Rescale@k, op}\[Transpose] , 
                32 > #[\([2, 3]\)] &]\[Transpose] ]\[IndentingNewLine]] // 
        Show[#, AspectRatio \[Rule] 1, 
            ImageSize \[Rule] $IMAGESIZE] &;\)\)], "Input"],

Cell[CellGroupData[{

Cell["Ortho-coor at ortho-proj", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"band.10000.array", "phi.10000.Real64", "phi.10000.Real64.info", 
      "phi.irregNode.10000.array", "phi.irregNode.10000.array.info", 
      "phi.pos", "phi.size"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(dx = 0.1;\)\), "\[IndentingNewLine]", 
    \(ImportIrreg3D["\<phi.irregNode.10000.array\>"]\), \
"\[IndentingNewLine]", 
    \(\(ir`X = dx*ir`X;\)\), "\[IndentingNewLine]", 
    \(Length[ir`X]\)}], "Input"],

Cell[BoxData[
    \(774602\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Histogram[ir`numNei, BarEdges \[Rule] None];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(color = 
        Rescale[\(Norm[{1, 1, \(-1\)} - #] &\) /@ 
            ir`X];\)\), "\[IndentingNewLine]", 
    \(\(Show[
        Graphics3D[{PointSize[0.02], 
            MapThread[{GrayLevel[#1], Point[#2]} &, {color, ir`X}]}], 
        Axes \[Rule] True, ImageSize \[Rule] 800];\)\)}], "Input"],

Cell[BoxData[
    \(Hold[Abort[], Abort[]]\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(Function[
          f, \[IndentingNewLine]g = 
            Show[Graphics3D[{PointSize[
                    0.04], \[IndentingNewLine]MapThread[{If[#1 > 0, 
                          RGBColor[0, #1, 0], RGBColor[\(-#1\), 0, 0]], 
                        Point[#2]} &, {f\/Max[Abs[f]], 
                      ir`X}]\[IndentingNewLine]}], Axes \[Rule] True, 
              ImageSize \[Rule] 800]] /@ {ir`f1, ir`f1n, 
          ir`f1t};\)\)], "Input"],

Cell[BoxData[
    \(<< Graphics`Animation`\)], "Input"],

Cell[BoxData[
    \(Block[{$DisplayFunction = ani}, \[IndentingNewLine]SpinShow[
        g]\[IndentingNewLine]]\)], "Input"],

Cell[BoxData[
    \(\(\(Histogram[#\/Max[Abs[#]], BarEdges \[Rule] 1] &\)[
        ir`f1t];\)\)], "Input"],

Cell[BoxData[{
    \(\(Histogram[ir`f1, BarEdges \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(\(Histogram[ir`f1n, BarEdges \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(\(Histogram[ir`f1t, BarEdges \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[{
    \(\(Histogram[ir`f1nn, BarEdges \[Rule] 1];\)\), "\n", 
    \(\(Histogram[ir`f1tt, BarEdges \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(\(Histogram[ir`f1nt, BarEdges \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    \(Histogram[Select[ir`f1n, Abs[#] < 0.01 &]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid3D["\<phi\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[phi]\)}], "Input"],

Cell[BoxData[
    \({1, 224, 224, 224}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[
          i, \[IndentingNewLine]ListDensityPlot[Sign@phi[\([1, i]\)], 
            PlotLabel \[Rule] i, 
            Epilog \[Rule] {Green, \(Point[
                      Most[#] + 0.5 - pos[\([1, {1, 2}]\)]] &\) /@ 
                  Select[ir`x, #[\([3]\)] + 1 - pos[\([1, 3]\)] \[Equal] 
                        i &]}, Mesh \[Rule] True]\[IndentingNewLine]] /@ 
        Range[Length[phi[\([\)\(1\)\(]\)]]];\)\)}], "Input"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(band = 
        Import["\<band.10000.array\>", "\<Integer32\>"] // 
          Partition[#, 3] &;\)\), "\[IndentingNewLine]", 
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[
          i, \[IndentingNewLine]ListDensityPlot[Sign@phi[\([1, i]\)], 
            PlotLabel \[Rule] i, Mesh \[Rule] True, 
            Epilog \[Rule] {Green, \(Point[
                      Most[#] + 0.5 - pos[\([1, {1, 2}]\)]] &\) /@ 
                  Select[band, #[\([3]\)] + 1 - pos[\([1, 3]\)] \[Equal] 
                        i &]}]\[IndentingNewLine]] /@ 
        Range[Length[phi[\([1]\)]]];\)\)}], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(\(ListContourPlot[#, Contours \[Rule] {0}] &\) /@ 
        phi[\([1]\)];\)\)}], "Input"],

Cell[BoxData[
    \(\(Block[{s = 0.05}, \[IndentingNewLine]g = 
          Graphics3D[\[IndentingNewLine]MapThread[{\[IndentingNewLine]Green, 
                    Line[{#1, #1 + s  #2}], \[IndentingNewLine]Red, 
                    Line[{#1, #1 + s  #3}], \[IndentingNewLine]Blue, 
                    Line[{#1, #1 + s  #4}]} &, \[IndentingNewLine]Take[
                    Select[{ir`X, ir`nv, ir`sv, ir`rv}\[Transpose] , 
                      Abs[#[\([1, 1]\)]] < 0.15 || Abs[#[\([1, 2]\)]] < 0.15 || 
                          Abs[#[\([1, 3]\)]] < 0.15 &], {1, \(-1\), 
                      1}]\[Transpose] ]] // 
            Show[#, ImageSize \[Rule] 2000, 
                PlotRange \[Rule] All] &\[IndentingNewLine]];\)\)], "Input"],

Cell[BoxData[
    \(Table[{nv[\([i]\)], sv[\([i]\)], rv[\([i]\)]} . 
            Transpose[{nv[\([i]\)], sv[\([i]\)], rv[\([i]\)]}] // Chop, {i, 
          Length[irreg]}] // Union\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \({nx, ny, nz} . {nx\ nz, ny\ nz, \ \(-nx\^2\) - ny\^2} // 
      FullSimplify\)], "Input"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \({nx, ny, nz} . {\(-nx\)\ ny, nx\^2 + nz\^2, \(-ny\)\ nz} // 
      FullSimplify\)], "Input"],

Cell[BoxData[
    \(0\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Cross[{nx, ny, nz}, {nz, 0, \(-nx\)}]\)], "Input"],

Cell[BoxData[
    \({\(-nx\)\ ny, nx\^2 + nz\^2, \(-ny\)\ nz}\)], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neighbors", "Subsection"],

Cell[BoxData[
    \(\(ir`X = ir`X/dx;\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(Xb = 
        Select[ir`X, Abs[#[\([3]\)]] < 3 &];\)\), "\[IndentingNewLine]", 
    \(Length[Xb]\)}], "Input"],

Cell[BoxData[
    \(2796\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(lens = 
        Function[
            b, \[IndentingNewLine]Length@
              Select[ir`X, Norm[b - #] < eps &]\[IndentingNewLine]] /@ 
          Xb;\)\)], "Input"],

Cell[BoxData[
    \($Aborted\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(Histogram[lens]\)], "Input"],

Cell[BoxData[{
    \(\(eps = 1.1;\)\), "\n", 
    \(\(Function[
          b, \[IndentingNewLine]dist = \(Norm[b - #] < eps &\) /@ 
              ir`X; \[IndentingNewLine]nei = 
            Pick[ir`X, dist]; \[IndentingNewLine]color = 
            Rescale[\(Norm[{1, 1, \(-1\)}/dx - #] &\) /@ 
                Xb]; \[IndentingNewLine]Show[
            Graphics3D[{PointSize[0.01], 
                MapThread[{GrayLevel[#2], Point[#1]} &, {Xb, 
                    color}], \[IndentingNewLine]PointSize[0.02], Green, 
                Point[b], Blue, Point /@ nei\[IndentingNewLine]}], 
            Axes \[Rule] True, 
            ImageSize \[Rule] 
              800];\[IndentingNewLine]] /@ {ir`X[\([4]\)]};\)\)}], "Input"],

Cell[BoxData[
    \(Take[Xb, {1, \(-1\), 10}]\)], "Input"],

Cell[BoxData[
    \(Position[ir`numNei, 0] // Flatten\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(ir`f1n[\([4]\)]\)], "Input"],

Cell[BoxData[
    \(0.`\)], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["IIMSimple (simple.c)", "Section"],

Cell[BoxData[{
    \(\(d1 = 63;\)\), "\[IndentingNewLine]", 
    \(\(pc = imp["\<pc\>"];\)\), "\[IndentingNewLine]", 
    \(\(uc = imp["\<uc\>"];\)\), "\[IndentingNewLine]", 
    \(\(vc = imp["\<vc\>"];\)\), "\[IndentingNewLine]", 
    \(\(px = imp["\<px\>"];\)\), "\[IndentingNewLine]", 
    \(\(py = imp["\<py\>"];\)\), "\[IndentingNewLine]", 
    \(\(irreg = impNode[0];\)\)}], "Input"],

Cell[BoxData[
    \(DisplayTogetherArray[\[IndentingNewLine]ListDensityPlot /@ 
          Chop@{pc, pc, uc, vc, px, py} // 
        Partition[#, 2] &, \[IndentingNewLine]ImageSize \[Rule] 
        750\[IndentingNewLine]]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Position[py, _?\((Not@NumericQ[#] &)\), {2}, 
      Heads \[Rule] False]\)], "Input"],

Cell[BoxData[
    \({}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ListDensityPlot[pc, 
      Epilog \[Rule] {MapThread[{If[#1 < 0, Red, Green], 
                Point[#2 +  .5]} &, {irreg[\([\)\(All, 10\)\(]\)], 
              irreg[\([\)\(All, {4, 5}\)\(]\)]}], Yellow, 
          Point[{33, 46} +  .5]}]\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[pc - Reverse /@ pc]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Total[Flatten[pc]]\)], "Input"],

Cell[BoxData[
    \(\(-1.7763568394002505`*^-14\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(g = pc;\)\), "\[IndentingNewLine]", 
    \(\(pos = 
        Position[
          g, _?\((# \[NotEqual] 0.  &)\)];\)\), "\[IndentingNewLine]", 
    \(max = Max[g]\), "\[IndentingNewLine]", 
    \(min = Min[g]\)}], "Input"],

Cell[BoxData[
    \(744.2038698550924`\)], "Output"],

Cell[BoxData[
    \(\(-744.2038698550924`\)\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(g = \(Function[
              p, \[IndentingNewLine]q = 
                Extract[g, p]; \[IndentingNewLine]{If[q < 0, 
                  RGBColor[\(-q\)/max\ *\  .5 +  .5, 0, 0], 
                  RGBColor[0, q/max* .5 +  .5, 0]], \[IndentingNewLine]Cuboid[
                  Append[p, 0], Append[p + 1, q]]}\[IndentingNewLine]] /@ 
            pos // Graphics3D\) // 
        Show[#, BoxRatios \[Rule] {1, 1,  .3}, PlotRange \[Rule] All, 
            Lighting \[Rule] False, ImageSize \[Rule] 1000, 
            DisplayFunction \[Rule] Identity] &\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics3D  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ConversionOptions \[Rule] {"\<Quality\>" \[Rule] 
          100, "\<Smoothing\>" \[Rule] 100}\)], "Input"],

Cell[BoxData[
    \(Function[
        r, \[IndentingNewLine]Show[g, 
            ViewPoint -> {1.2  Sin[\[Pi]\ r], 1.2  Cos[\[Pi]\ r], 1.2}, 
            ImageSize \[Rule] {900, 900}, AspectRatio \[Rule] 1] // 
          Export["\<img.\>" <> 
                ToString[
                  Round[100  r]] <> "\<.png\>", #] &\[IndentingNewLine]] /@ 
      Range[0, 2,  .01]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(upa - 2  umb + umc\)], "Input"],

Cell[BoxData[
    \(\(-2\)\ umb + umc + upa\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(uma - 2  umb + umc + upa - uma\)], "Input"],

Cell[BoxData[
    \(\(-2\)\ umb + umc + upa\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(upa - 2  upb + umc\)], "Input"],

Cell[BoxData[
    \(umc + upa - 2\ upb\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(uma - 2  umb + umc + upa - uma - 2 \((upb - umb)\) // 
      FullSimplify\)], "Input"],

Cell[BoxData[
    \(umc + upa - 2\ upb\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["RHStest.c", "Section"],

Cell[BoxData[{
    \(\(d1 = 63;\)\), "\[IndentingNewLine]", 
    \(\(rhs = imp["\<rhs\>"];\)\)}], "Input"],

Cell[BoxData[
    \(ListDensityPlot[rhs]\)], "Input"],

Cell[BoxData[
    \(ListPlot3D[rhs]\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["daAO.c", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(d1 = 10;\)\), "\[IndentingNewLine]", 
    \(Import["\<daao\>" <> "\<.Real64\>", "\<Real64\>"] // Round\)}], "Input"],

Cell[BoxData[
    \({0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
      20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 
      38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 
      56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 
      74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
      92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 
      108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 
      122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 
      136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 
      150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 
      164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 
      178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 
      192, 193, 194, 195, 196, 197, 198, 199}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Table[i + 5\ \((j - 1)\), {j, 10}, {i, 5}] // MatrixForm\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "2", "3", "4", "5"},
            {"6", "7", "8", "9", "10"},
            {"11", "12", "13", "14", "15"},
            {"16", "17", "18", "19", "20"},
            {"21", "22", "23", "24", "25"},
            {"26", "27", "28", "29", "30"},
            {"31", "32", "33", "34", "35"},
            {"36", "37", "38", "39", "40"},
            {"41", "42", "43", "44", "45"},
            {"46", "47", "48", "49", "50"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["interpolate.c", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"params.txt", "velfield.dat"}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(dat = \(Import["\<velfield.dat\>", "\<Table\>"]\)[\([1]\)];\)\), "\
\[IndentingNewLine]", 
    \(\(dat = Partition[dat, \@Length[dat]];\)\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[dat];\)\), "\[IndentingNewLine]", 
    \(\(f = 
        ListInterpolation[dat, {{\(-1.5\), 1.5}, {\(-1.5\), 1.5}}, 
          InterpolationOrder \[Rule] 1];\)\), "\n", 
    \(\(DensityPlot[f[x, y], {y, \(-1.5\), 1.5}, {x, \(-1.5\), 1.5}, 
        PlotPoints \[Rule] 200];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Max[dat]\)], "Input"],

Cell[BoxData[
    \(2.1`\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(MatrixForm[dat]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(Dimensions[dat]\)], "Input"],

Cell[BoxData[
    \({30, 30}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ListPlot[dat[\([All, 100]\)]];\)\)], "Input"],

Cell[BoxData[
    \({100.219, 30.8854}\)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Nei", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({".svn"}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(coor = 
        Module[{s, nodeSize = 380, idx, op, 
            coor = {}}, \[IndentingNewLine]s = 
            OpenRead["\<irregNode.10000.array\>", 
              BinaryFormat \[Rule] True]; \[IndentingNewLine]While[
            True, \[IndentingNewLine]idx = 
              BinaryRead[
                s, {"\<Integer32\>", "\<Integer32\>", "\<Integer32\>"}]; \
\[IndentingNewLine]If[idx[\([1]\)] == EndOfFile, 
              Break[]]; \[IndentingNewLine]op = 
              BinaryRead[
                s, {"\<Real64\>", "\<Real64\>", "\<Real64\>"}]; \
\[IndentingNewLine]Skip[s, "\<Byte\>", 
              nodeSize - 3*\((4 + 8)\)]; \[IndentingNewLine]AppendTo[
              coor, {idx, idx + op}]; \[IndentingNewLine]If[
              Length[coor] \[Equal] 1000, 
              Break[]];\[IndentingNewLine]]; \[IndentingNewLine]Close[
            s]; \[IndentingNewLine]coor\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\(p = coor[\([35, 2, {1, 2}]\)];\)\), "\[IndentingNewLine]", 
    \(\(op = {{26.000000, 13.516613}, {26.530720, 14.000000}, {27.000000, 
            14.392587}, {27.577669, 15.000000}, {28.000000, 
            15.426193}, {28.526367, 16.000000}, {29.000000, 
            16.515535}, {29.480933, 17.000000}, {30.000000, 
            17.537948}};\)\), "\[IndentingNewLine]", 
    \(\(ListPlot[coor[\([All, 2, {1, 2}]\)], 
        Epilog \[Rule] {Circle[p,  .7], Green, \(Circle[#,  .3] &\) /@ op, 
            Blue, Line /@ coor[\([All, {1, 2}, {1, 2}]\)]}, 
        AspectRatio \[Rule] 1];\)\)}], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output",
  GeneratedCell->False,
  CellAutoOverwrite->False]
}, Open  ]],

Cell[BoxData[{
    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(Do[\[IndentingNewLine]p = 
        coor[\([i, 2, {1, 2}]\)]; \[IndentingNewLine]op = 
        ops[\([i]\)]; \[IndentingNewLine]ListPlot[coor[\([All, 2, {1, 2}]\)], 
        Epilog \[Rule] {Circle[p,  .7], Circle[p, 3], 
            Green, \(Circle[#,  .3] &\) /@ op, Blue, 
            Line /@ coor[\([All, {1, 2}, {1, 2}]\)]}, 
        AspectRatio \[Rule] 1];\[IndentingNewLine], {i, 
        1*Length[coor]}]\)}], "Input"],

Cell[BoxData[{
    \(MX = 64; \), "\[IndentingNewLine]", 
    \(ls = ImportVec2[MX, 1, "\<ls.10000.Real64\>"]; \)}], "Input"],

Cell[BoxData[
    \(ListDensityPlot[ls, PlotRange \[Rule] {\(-10\), 10}]; \)], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["corrections", "Section"],

Cell[BoxData[
    \(Exit[]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"grid.10000.Real64", "grid.pos", "grid.size", "irregNode.10001.array", 
      "irregNode.9999.array", "rhs.10000.Real64", 
      ".rocks-release"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(\({phi, pos} = ImportGrid["\<grid\>"];\)\), "\[IndentingNewLine]", 
    \(Dimensions[phi]\), "\[IndentingNewLine]", 
    \(\(ListDensityPlot[phi[\([1]\)], Frame \[Rule] True];\)\)}], "Input"],

Cell[BoxData[
    \({1, 60, 60}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(\(MX = 16;\)\), "\n", 
    \(\(MY = MX;\)\), "\n", 
    \(\({pvel, uvel, vvel} = 
        ImportFluid[MX, MX, "\<rhs\>", 10000];\)\), "\n", 
    \(\(ImportIrreg["\<irregNode.10001.array\>"];\)\), "\[IndentingNewLine]", \

    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(fscale = 10;\)\), "\n", 
    \(\(iaxis = 1;\)\), "\[IndentingNewLine]", 
    \(\(axis = {{uvel, {\(-0.5\), 
              0}}, {vvel, {0, \(-0.5\)}}};\)\), "\[IndentingNewLine]", 
    \(\(DensityPlot[\(axis[\([iaxis, 1]\)]\)[y, x], {x, 0.5, MX - 2}, {y, 
          0.5, MY - 2}, PlotPoints \[Rule] {5  MX, 5  MX}, 
        Frame \[Rule] False, ImageSize \[Rule] 1500, 
        PlotRange \[Rule] {All, All, All}, 
        Epilog \[Rule] {Green, PointSize[0.008], 
            Function[{p, n, k, x}, {Point[p], Line[{p, p + n*k}], Red, 
                  PointSize[0.005], Point[x + axis[\([iaxis, 2]\)]], 
                  Blue, \[IndentingNewLine]\(Line[
                        Transpose[
                          axis[\([iaxis, 2]\)] + 
                            x + {{0, 
                                  0}, #}\[Transpose] ]] &\) /@ {{0, \(-1\)}, \
{0, 1}, {1, 0}, {\(-1\), 0}}\[IndentingNewLine]}]~
              MapThread~{ir`X, ir`nv, fscale*ir`f1, ir`x}}];\)\)}], "Input"],

Cell[BoxData[{
    \(\(MX = 54;\)\), "\n", 
    \(\(MY = MX;\)\), "\n", 
    \(\({pvel, uvel, vvel} = 
        ImportFluid[MX, MX, "\<rhs\>", 10000];\)\), "\n", 
    \(\(ImportIrreg["\<irregNode.10001.array\>"];\)\), "\[IndentingNewLine]", \

    \(\(clear;\)\), "\[IndentingNewLine]", 
    \(\(fscale = 10;\)\), "\n", 
    \(\(iaxis = 1;\)\), "\[IndentingNewLine]", 
    \(\(axis = {{uvel, {\(-1\), 
              0}}, {vvel, {0, \(-1\)}}};\)\), "\[IndentingNewLine]", 
    \(\(DensityPlot[\(axis[\([iaxis, 1]\)]\)[y, x], {x, 0.5, MX - 2}, {y, 
          0.5, MY - 2}, PlotPoints \[Rule] {5  MX, 5  MX}, 
        Frame \[Rule] False, ImageSize \[Rule] 1500, 
        PlotRange \[Rule] {All, All, All}, 
        Epilog \[Rule] {Green, PointSize[0.008], 
            Function[{p, n, k, x}, {Point[p], Line[{p, p + n*k}], Red, 
                  PointSize[0.005], Point[x], 
                  Blue, \[IndentingNewLine]Line[{x, 
                      axis[\([iaxis, 2]\)] + x}]\[IndentingNewLine]}]~
              MapThread~{ir`X, ir`nv, fscale*ir`f1, ir`x}}];\)\)}], "Input"],

Cell[BoxData[
    \(\(Plot3D[pvel[y, x], {x, 0.5, MX - 2}, {y, 0.5, MY - 2}, 
        PlotPoints \[Rule] {5  MX, 5  MX}, Mesh \[Rule] False, 
        PlotRange \[Rule] All];\)\)], "Input"],

Cell[BoxData[
    \(\(Plot[vvel[x, 6]/0.5, {x, 0.5, MX - 2}, 
        PlotRange \[Rule] All];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(250\ 16. \)], "Input"],

Cell[BoxData[
    \(4000.`\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["surfcoor", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"localcoor.10000.array", "params.txt"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(coor = 
      Import["\<localcoor.10000.array\>", "\<Real64\>"]\), "\
\[IndentingNewLine]", 
    \(\({s, n, r} = Partition[coor, Length[coor]/3];\)\)}], "Input"],

Cell[BoxData[
    \({\(-2.0000006188979045`\), \(-1.0000003094489522`\), 0.`, 
      1.4142140000000003`, 4.472137338897364`, 1.414214`, 0.707107`, 0.`, 
      1.1102230246251565`*^-16, 1.414214`, 0.`, 0.`, 0.`, 0.`, 
      0.`}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(TableForm[{s, n}\[Transpose] ]\)], "Input"],

Cell[BoxData[
    TagBox[GridBox[{
          {\(-2.0000006188979045`\), "1.414214`"},
          {\(-1.0000003094489522`\), "0.707107`"},
          {"0.`", "0.`"},
          {"1.4142140000000003`", "1.1102230246251565`*^-16"},
          {"4.472137338897364`", "1.414214`"}
          },
        RowSpacings->1,
        ColumnSpacings->3,
        RowAlignments->Baseline,
        ColumnAlignments->{Left}],
      Function[ BoxForm`e$, 
        TableForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(ListPlot[{s, n}\[Transpose] , PlotRange \[Rule] All, 
        AspectRatio \[Rule] Automatic];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(s\)], "Input"],

Cell[BoxData[
    \({\(-2.0000006188979045`\), \(-1.0000003094489522`\), 0.`, 
      1.4142140000000003`, 4.472137338897364`}\)], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["iimtest", "Section"],

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \(\(ImportDebug = 
        Function[{du, s, x, y, i}, 
          Module[{filename, raw, s = 1, T1}, \[IndentingNewLine]filename = 
              du <> "\<_\>" <> ToString[s] <> "\<_\>" <> 
                ToString[x] <> "\<_\>" <> ToString[y] <> "\<.\>" <> 
                ToString[10000 + i] <> "\<.array\>"; \[IndentingNewLine]Clear[
              h, sign, c, dof, coor]; \[IndentingNewLine]raw = 
              BinaryReadList[
                filename, {"\<Real64\>", "\<Real64\>", "\<Real64\>", \
"\<Real64\>", "\<Real64\>", "\<Real64\>", "\<Integer32\>", "\<Integer32\>", "\
\<Integer32\>", "\<Integer32\>", "\<Integer32\>", "\<Integer32\>"}, 
                ByteOrdering \[Rule] \(-1\)]; \[IndentingNewLine]raw = 
              raw\[Transpose] ; \[IndentingNewLine]T1 := 
              raw[\([\(s++\)]\)]; \[IndentingNewLine]\[IndentingNewLine]h = 
              T1; \[IndentingNewLine]dd = T1; \[IndentingNewLine]j = 
              T1; \[IndentingNewLine]jp = T1; \[IndentingNewLine]jpp = 
              T1; \[IndentingNewLine]c = T1; \[IndentingNewLine]dof = 
              T1; \[IndentingNewLine]sign = T1; \[IndentingNewLine]axis = 
              T1; \[IndentingNewLine]coor = 
              Transpose[
                raw[\([{\(s++\), \(s++\), \
\(s++\)}]\)]];\[IndentingNewLine]]];\)\)], "Input"],

Cell[BoxData[
    \(\(DrawGrid = \({\[IndentingNewLine]Black, Thickness[0.01], 
              Line[{{# - 0.5, \(-3\)}, {# - 0.5, 10}}], 
              Line[{{\(-3\), # - 0.5}, {10, # - 0.5}}], 
              Thickness[0.003], \[IndentingNewLine]Cyan, 
              Line[{{# - 0.5, \(-3\)}, {# - 0.5, 10}}], 
              Line[{{\(-3\), #}, {10, #}}], \[IndentingNewLine]Red, 
              Line[{{#, \(-3\)}, {#, 10}}], 
              Line[{{\(-3\), # - 0.5}, {10, # - 
                      0.5}}]\[IndentingNewLine]} &\) /@ 
          Range[\(-3\), 3];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(LoadData[] := 
      Module[{pre}, \[IndentingNewLine]pre = "\<phi_-1\>"; \
\[IndentingNewLine]{phi, pos} = 
          ImportGrid[
            pre]; \[IndentingNewLine]f = \(ListInterpolation[#, {{\(-2\), 
                    3}, {\(-2\), 3}}, InterpolationOrder \[Rule] 1] &\) /@ 
            phi; \[IndentingNewLine]rng = \(ToString[10000 + #] &\) /@ 
            Range[0, Length[phi] - 1]; \[IndentingNewLine]{X, F1, F1n, 
            F1nn} = Transpose[
            Function[i, 
                ImportIrreg[
                  pre <> "\<.irregNode.\>" <> i <> "\<.array\>"]; {ir`X, 
                  ir`f1, ir`f1n, ir`f1nn}] /@ 
              rng];\[IndentingNewLine]]\), "\[IndentingNewLine]", 
    \(LoadData[]\), "\[IndentingNewLine]", 
    \(X\)}], "Input"],

Cell[BoxData[
    \({{}, {{0.5`, 0.07407407407407418`}, {0.07407407407407418`, 
          0.5`}}, {{0.5`, 0.35897435897435903`}, {0.35897435897435903`, 
          0.5`}}, {{0.5`, 0.5098039215686274`}, {0.5098039215686274`, 
          0.5`}}, {{0.5`, 0.6031746031746033`}, {0.6031746031746033`, 
          0.5`}}, {{0.5`, 0.6666666666666667`}, {0.6666666666666667`, 
          0.5`}}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(ImportIrreg["\<phi_-1.irregNode.10000.array\>"]; ir`X\)], "Input"],

Cell[BoxData[
    \({}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(GridCoor = 
        Function[{dof, x}, \[IndentingNewLine]x[\([{1, 2}]\)] - 
            Which[\[IndentingNewLine]dof \[Equal] 0, {0, 
                0}, \[IndentingNewLine]dof \[Equal] 1, {0.5, 
                0}, \[IndentingNewLine]dof \[Equal] 2, {0, 
                0.5}]\[IndentingNewLine]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
    \(TraditionalForm\`C {\[Del]p}\)]]], "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(band = {{0, 0}, {1, 0}, {0, 1}, {1, 1}}\)], "Input"],

Cell[BoxData[
    \({{0, 0}, {1, 0}, {0, 1}, {1, 1}}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames["\<dp_-1*.10000.array\>"]\)], "Input"],

Cell[BoxData[
    \({"dp_-1_0_0.10000.array", "dp_-1_0_1.10000.array", 
      "dp_-1_1_0.10000.array", "dp_-1_1_1.10000.array"}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(ImportDebug["\<dp\>", \(-1\), 1, 1, 0]\), "\[IndentingNewLine]", 
    \(h\)}], "Input"],

Cell[BoxData[
    \({EndOfFile}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[
          i, \[IndentingNewLine]\[IndentingNewLine]g1 = \({Blue, 
                  ImportDebug["\<du\>", \(-1\), #[\([1]\)], #[\([2]\)], 
                    i - 1]; 
                  If[Length[dof] > 
                      0, \[IndentingNewLine]MapThread[\[IndentingNewLine]\
Function[{v, d, c}, Text[v, GridCoor[d, c], 
                          TextStyle \[Rule] {"\<Title\>"}]], \
\[IndentingNewLine]Most[{sign, dof, 
                              coor}\[Transpose] ]\[Transpose] \
\[IndentingNewLine]], Point[{0, 0}]]} &\) /@ 
              band[\([{2}]\)]; \[IndentingNewLine]ContourPlot[\(f[\([i]\)]\)[
              x, y], {x, \(-2\), 2}, {y, \(-2\), 2}, Contours \[Rule] {0}, 
            ContourShading \[Rule] None, PlotPoints \[Rule] 100, 
            ImageSize \[Rule] 800, 
            Epilog \[Rule] {DrawGrid, \[IndentingNewLine]Green, 
                PointSize[0.02], \(Point[#] &\) /@ 
                  X[\([i]\)], \[IndentingNewLine]g1\[IndentingNewLine]}]\
\[IndentingNewLine]] /@ Range[Length[phi]];\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
    \(TraditionalForm\`C {\[Del]\^2 u}\)]]], "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames["\<ddu_-1*.10000.array\>"]\)], "Input"],

Cell[BoxData[
    \({"ddu_-1_0_0.10000.array", "ddu_-1_0_1.10000.array", 
      "ddu_-1_1_0.10000.array", "ddu_-1_1_1.10000.array"}\)], "Output"]
}, Open  ]],

Cell[BoxData[
    \(ImportDebug["\<ddu\>", \(-1\), 0, 0, 0]\)], "Input"],

Cell[BoxData[{
    \(clear\), "\[IndentingNewLine]", 
    \(\(Function[
          i, \[IndentingNewLine]g1 = \({Blue, 
                  ImportDebug["\<ddu\>", \(-1\), #[\([1]\)], #[\([2]\)], 
                    i - 1]; 
                  If[Length[dof] > 
                      0, \[IndentingNewLine]MapThread[\[IndentingNewLine]\
Function[{v, d, c}, Text[v, GridCoor[d, c], 
                          TextStyle \[Rule] {"\<Title\>"}]], \
\[IndentingNewLine]Most[{sign, dof, 
                              coor}\[Transpose] ]\[Transpose] \
\[IndentingNewLine]], Point[{0, 0}]]} &\) /@ 
              band[\([{2}]\)]; \[IndentingNewLine]ContourPlot[\(f[\([i]\)]\)[
              x, y], {x, \(-2\), 2}, {y, \(-2\), 2}, Contours \[Rule] {0}, 
            ContourShading \[Rule] None, PlotPoints \[Rule] 100, 
            ImageSize \[Rule] 800, 
            Epilog \[Rule] {DrawGrid, \[IndentingNewLine]Green, 
                PointSize[0.02], \(Point[#] &\) /@ 
                  X[\([i]\)], \[IndentingNewLine]g1\[IndentingNewLine]}]\
\[IndentingNewLine]] /@ Range[Length[phi]];\)\)}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["old", "Subsection"],

Cell[BoxData[{
    \(LoadData[] := 
      Module[{}, \[IndentingNewLine]{phi, pos} = 
          ImportGrid["\<phi\>"]; \[IndentingNewLine]f = \
\(ListInterpolation[#, {{\(-2\), 3}, {\(-2\), 3}}, 
                InterpolationOrder \[Rule] 1] &\) /@ 
            phi; \[IndentingNewLine]rng = \(ToString[10000 + #] &\) /@ 
            Range[0, Length[phi] - 1]; \[IndentingNewLine]{X, F1, F1n, 
            F1nn} = Transpose[
            Function[i, 
                ImportIrreg["\<phi.irregNode.\>" <> 
                    i <> "\<.array\>"]; {ir`X, ir`f1, ir`f1n, ir`f1nn}] /@ 
              rng]; \[IndentingNewLine]coors = \(Partition[
                Import["\<iim_coor.\>" <> # <> "\<.array\>", \
"\<Integer32\>"], 4] &\) /@ 
            rng; \[IndentingNewLine]vals = \(Import["\<iim_val.\>" <> # <> \
"\<.array\>", "\<Real64\>"] &\) /@ 
            rng;\[IndentingNewLine]]\), "\[IndentingNewLine]", 
    \(LoadData[]\)}], "Input"],

Cell[BoxData[
    \(FileNames["\<dp*\>"]\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \({Min[phi], Max[phi]}\)], "Input"],

Cell[BoxData[
    \({\(-5.`\), 1.`}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\n", 
    \(\(\(ListDensityPlot[#, Mesh \[Rule] True, 
            PlotRange \[Rule] {Min[phi], Max[phi]}] &\) /@ phi;\)\), "\n", 
    \(\(ListPlot[phi[\([\)\(All, 3, 3\)\(]\)]];\)\)}], "Input"],

Cell[BoxData[
    \(\(\(\(\(\(LoadData[]\[IndentingNewLine]
            clear\[IndentingNewLine]
            \(\(Function\)\([\)\(i, \[IndentingNewLine]\(\(ContourPlot\)\([\)\
\(\(f[\([i]\)]\)[x, y], {x, \(-2\), 2}, {y, \(-2\), 2}, Contours \[Rule] {0}, 
                ContourShading \[Rule] None, PlotPoints \[Rule] 100, 
                ImageSize \[Rule] 800, 
                Epilog \[Rule] {\[IndentingNewLine]Green, 
                    PointSize[0.02], \(Point[#] &\) /@ 
                      X[\([i]\)], \
{\[IndentingNewLine]\[IndentingNewLine]Black, 
                      MapThread[\[IndentingNewLine]Function[{v, c}, 
                          Text[v, 
                            c[\([\)\({2, 3}\)\(]\)] - 
                              Which[\[IndentingNewLine]c[\([1]\)] \[Equal] 
                                  0, {0, 
                                  0}, \[IndentingNewLine]c[\([1]\)] \[Equal] 
                                  1, {0.5, 
                                  0}, \[IndentingNewLine]c[\([1]\)] \[Equal] 
                                  2, {0, 0.5}] + 
                              0\ 0.25 \(({Random[], Random[]} - 0.5)\), 
                            TextStyle \[Rule] {"\<Title\>"}]], \
\[IndentingNewLine]Cases[{vals[\([i]\)], 
                                coors[\([i]\)]}\[Transpose] , {_, {_, _, _, 
                                0}}]\[Transpose] \
]\[IndentingNewLine]}\)\)\)\)\)\(]\)\)\(\[IndentingNewLine]\)
          \)\(]\)\) /@ Range[Length[phi]];\)\)], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
    \(LoadData[]\), "\[IndentingNewLine]", 
    \(Length /@ vals\)}], "Input"],

Cell[BoxData[
    \({4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4}\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(\(Function[
        i, \[IndentingNewLine]Show@
          Graphics[\(Point[#] &\) /@ X[\([i]\)], 
            Text[X[\([i]\)], #] /@ X[\([i]\)]]\[IndentingNewLine]]\)[
      11]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
    \(LoadData[]\), "\[IndentingNewLine]", 
    \(clear\), "\[IndentingNewLine]", 
    \(Function[
        df, \[IndentingNewLine]\(Function[
            i, \[IndentingNewLine]ContourPlot[\(f[\([i]\)]\)[x, 
                y], {x, \(-2\), 2}, {y, \(-2\), 2}, Contours \[Rule] {0}, 
              ContourShading \[Rule] None, PlotPoints \[Rule] 100, 
              ImageSize \[Rule] 800, 
              Epilog \[Rule] {\[IndentingNewLine]Green, 
                  PointSize[0.02], \(Point[#] &\) /@ X[\([i]\)], 
                  Circle[X[\([i, 4]\)], 
                    1.1], \({\[IndentingNewLine]Black, Thickness[0.01], 
                        Line[{{# - 0.5, \(-3\)}, {# - 0.5, 10}}], 
                        Line[{{\(-3\), # - 0.5}, {10, # - 0.5}}], 
                        Thickness[0.003], \[IndentingNewLine]Cyan, 
                        Line[{{# - 0.5, \(-3\)}, {# - 0.5, 10}}], 
                        Line[{{\(-3\), #}, {10, #}}], \[IndentingNewLine]Red, 
                        Line[{{#, \(-3\)}, {#, 10}}], 
                        Line[{{\(-3\), # - 0.5}, {10, # - 
                                0.5}}]\[IndentingNewLine]} &\) /@ 
                    Range[\(-3\), 3], \[IndentingNewLine]Black, 
                  MapThread[\[IndentingNewLine]Function[{v, c}, 
                      Text[v, 
                        c + 0 \(({Random[], Random[]} - 0.5)\) + {0,  .05}, 
                        TextStyle \[Rule] {"\<Title\>"}]], \
\[IndentingNewLine]{df[\([i]\)], 
                      X[\([\)\(i\)\(]\)]}]\[IndentingNewLine]}]\
\[IndentingNewLine]]\)[11]] /@ {F1, F1n, F1nn}\)}], "Input"],

Cell[BoxData[
    RowBox[{"{", 
      RowBox[{
        TagBox[\(\[SkeletonIndicator]  
            ContourGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            ContourGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False], ",", 
        TagBox[\(\[SkeletonIndicator]  
            ContourGraphics  \[SkeletonIndicator]\),
          False,
          Editable->False]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(\(\(\(/@\)\(Range[Length[phi]]\)\);\)\)], "Input"],

Cell[BoxData[{
    \(\(dat = {{\(-0.527046\), \(-66.666667\)}, {\(-0.745356\), \
\(-50.000000\)}, {0.527046, \(-66.666667\)}, {0.745356, \(-50.000000\)}, \
{0.000000, \(-83.333333\)}};\)\), "\n", 
    \(\(ListPlot[dat];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(eq = Fit[dat, {1, x, x\^2}, x]\)], "Input"],

Cell[BoxData[
    \(\(-83.33332309420985`\) - 1.757412065257429`*^-14\ x + 
      59.999989277282`\ x\^2\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(D[eq, {x, 2}]\)], "Input"],

Cell[BoxData[
    \(119.999978554564`\)], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
    \(Plot[eq, {x, \(-1\), 1}, 
      Epilog \[Rule] {Green, Point /@ dat}]\)], "Input"],

Cell[BoxData[
    TagBox[\(\[SkeletonIndicator]  Graphics  \[SkeletonIndicator]\),
      False,
      Editable->False]], "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["irregularnode", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
    \(FileNames[]\)], "Input"],

Cell[BoxData[
    \({"params.txt", "phi.10000.Real64", "phi.10000.Real64.info", 
      "phi.irregNode.10000.array", "phi.irregNode.10000.array.info", 
      "phi.pos", "phi.size"}\)], "Output"]
}, Open  ]],

Cell[BoxData[{
    \(clear\), "\n", 
    \(\(ImportIrreg["\<phi.irregNode.10000.array\>"];\)\), "\
\[IndentingNewLine]", 
    \(\(ListPlot[ir`X, PlotRange \[Rule] {{\(-0.1\), 4}, {\(-0.1\), 4}}, 
        AspectRatio \[Rule] Automatic];\)\), "\[IndentingNewLine]", 
    \(\(phi = ImportGrid["\<phi\>"];\)\), "\n", 
    \(\(phi = phi[\([\)\(1, 1\)\(]\)];\)\)}], "Input"],

Cell[BoxData[{
    \(\(f = 
        ListInterpolation[phi, {{0, 1.5}, {0, 1.5}}, 
          InterpolationOrder \[Rule] 1];\)\), "\[IndentingNewLine]", 
    \(\(ContourPlot[f[x, y], {y, 0, 1}, {x, 0, 1}, Contours \[Rule] {0}, 
        ContourShading \[Rule] None, 
        Epilog \[Rule] {Green, \(Point[# + 0.01  rnd] &\) /@ 
              ir`X}];\)\)}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
    \(MatrixForm[phi]\)], "Input"],

Cell[BoxData[
    TagBox[
      RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.05`", "0.1`", "1.`"},
            {"1.`", \(-1.`\), "1.`"},
            {"1.`", "1.`", "15.`"}
            },
          RowSpacings->1,
          ColumnSpacings->1,
          ColumnAlignments->{Left}], "\[NoBreak]", ")"}],
      Function[ BoxForm`e$, 
        MatrixForm[ BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[
    \(rnd := {Random[], Random[]} - 0.5\)], "Input"],

Cell[BoxData[{
    \(\(clear;\)\), "\n", 
    \(\(f = {\(-0.1\), \(-0.1\), 0};\)\), "\n", 
    \(\(df = {0.06, 0.06, 1};\)\), "\n", 
    \(\(dg = {0.5, 0.5};\)\), "\[IndentingNewLine]", 
    \(\(l1 = \(Line[{{f[\([1]\)] + #*df[\([1]\)], \(-1.0\)}, {f[\([1]\)] + #*
                      df[\([1]\)], 10.0}}] &\) /@ Range[0, 200];\)\), "\n", 
    \(\(l2 = \(Line[{{\(-10\), f[\([2]\)] + #*df[\([2]\)]}, {10, 
                  f[\([2]\)] + #*df[\([2]\)]}}] &\) /@ 
          Range[0, 100];\)\), "\n", 
    \(\(lg = \({Line[{{#  dg[\([1]\)], \(-100\)}, {#  dg[\([1]\)], 100}}], 
              Line[{{\(-100\), #  dg[\([2]\)]}, {100, #  dg[\([2]\)]}}]} &\) /@ 
          Range[0, Max@Dimensions[phi]];\)\), "\[IndentingNewLine]", 
    \(\(pg = 
        Table[Point[dg {i, j}], {i, 0, Length[phi] - 1}, {j, 0, 
            Length[phi[\([1]\)]] - 1}];\)\), "\[IndentingNewLine]", 
    \(\(func = 
        ListInterpolation[phi, {{0, 1.5}, {0, 1.5}}, 
          InterpolationOrder \[Rule] 1];\)\), "\n", 
    \(\(rng = Quantile[Flatten[phi], {0, 1}];\)\), "\n", 
    \(\(DensityPlot[func[x, y], {y, 0, 1.5}, {x, 0, 1.5}, 
        PlotRange \[Rule] {{\(-0.1\), 1.6}, {\(-0.1\), 1.6}, All}, 
        PlotPoints \[Rule] 300, 
        Epilog \[Rule] {Thickness[0.01], Cyan, lg, Black, PointSize[0.05], 
            pg, Thickness[0.001], Blue, 
            PointSize[0.01], \(Point[# + 0.0  rnd] &\) /@ ir`X, l1, l2}, 
        ColorFunctionScaling \[Rule] 
          False, \[IndentingNewLine]ColorFunction \[Rule] \((If[# < 
                  0, \[IndentingNewLine]RGBColor[1, 
                  Clip[1 - #\/\(-0.2\), {0, 1}], 
                  0], \[IndentingNewLine]RGBColor[Clip[1 - #\/0.2, {0, 1}], 
                  1, 0]] &)\)\[IndentingNewLine]];\)\)}], "Input"]
}, Closed]]
},
FrontEndVersion->"5.2 for X",
ScreenRectangle->{{0, 2400}, {0, 1600}},
AutoGeneratedPackage->None,
WindowSize->{1200, 1523},
WindowMargins->{{0, Automatic}, {0, Automatic}},
ShowSelection->True
]

(*******************************************************************
Cached data follows.  If you edit this Notebook file directly, not
using Mathematica, you must remove the line containing CacheID at
the top of  the file.  The cache data will then be recreated when
you save this file from within Mathematica.
*******************************************************************)

(*CellTagsOutline
CellTagsIndex->{}
*)

(*CellTagsIndex
CellTagsIndex->{}
*)

(*NotebookFileOutline
Notebook[{

Cell[CellGroupData[{
Cell[1776, 53, 23, 0, 74, "Section"],

Cell[CellGroupData[{
Cell[1824, 57, 306, 6, 75, "Input",
  InitializationCell->True],
Cell[2133, 65, 331, 5, 70, "Message"]
}, Open  ]],
Cell[2479, 73, 39, 1, 27, "Input"],
Cell[2521, 76, 44, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[2590, 81, 76, 1, 27, "Input"],
Cell[2669, 84, 70, 1, 26, "Output"]
}, Open  ]],
Cell[2754, 88, 54, 1, 27, "Input"],
Cell[2811, 91, 600, 15, 91, "Input",
  InitializationCell->True]
}, Closed]],

Cell[CellGroupData[{
Cell[3448, 111, 30, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[3503, 115, 24, 0, 38, "Subsection"],
Cell[3530, 117, 104, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[3659, 123, 1295, 27, 427, "Input"],
Cell[4957, 152, 37, 1, 27, "Output"],
Cell[4997, 155, 35, 1, 27, "Output"]
}, Open  ]],
Cell[5047, 159, 111, 2, 43, "Input"],
Cell[5161, 163, 438, 7, 155, "Input"],
Cell[5602, 172, 45, 1, 27, "Input"],
Cell[5650, 175, 416, 8, 140, "Text"]
}, Closed]],

Cell[CellGroupData[{
Cell[6103, 188, 24, 0, 30, "Subsection"],

Cell[CellGroupData[{
Cell[6152, 192, 1352, 27, 443, "Input"],
Cell[7507, 221, 39, 1, 27, "Output"],
Cell[7549, 224, 36, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[7622, 230, 124, 2, 43, "Input"],
Cell[7749, 234, 93, 1, 43, "Output"]
}, Open  ]],
Cell[7857, 238, 73, 1, 27, "Input"],
Cell[7933, 241, 53, 1, 27, "Input"],
Cell[7989, 244, 49, 1, 27, "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[8087, 251, 27, 0, 44, "Section"],
Cell[8117, 253, 106, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[8248, 259, 238, 5, 91, "Input"],
Cell[8489, 266, 38, 1, 26, "Output"]
}, Open  ]],
Cell[8542, 270, 91, 1, 27, "Input"],
Cell[8636, 273, 91, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[8752, 278, 470, 8, 107, "Input"],
Cell[9225, 288, 382, 5, 20, "Message"],
Cell[9610, 295, 382, 5, 20, "Message"],
Cell[9995, 302, 382, 5, 20, "Message"],
Cell[10380, 309, 340, 5, 20, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[10757, 319, 481, 8, 123, "Input"],
Cell[11241, 329, 382, 5, 20, "Message"],
Cell[11626, 336, 382, 5, 20, "Message"],
Cell[12011, 343, 382, 5, 20, "Message"],
Cell[12396, 350, 340, 5, 20, "Message"]
}, Open  ]],
Cell[12751, 358, 265, 4, 43, "Input"],
Cell[13019, 364, 961, 24, 219, "Input"],
Cell[13983, 390, 77, 1, 27, "Input"],
Cell[14063, 393, 437, 8, 75, "Input"],
Cell[14503, 403, 294, 8, 57, "Input"],
Cell[14800, 413, 61, 1, 27, "Input"],
Cell[14864, 416, 106, 2, 27, "Input"],
Cell[14973, 420, 174, 3, 59, "Input"],
Cell[15150, 425, 265, 5, 72, "Input"],

Cell[CellGroupData[{
Cell[15440, 434, 62, 1, 27, "Input"],
Cell[15505, 437, 63, 1, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[15617, 444, 19, 0, 44, "Section"],
Cell[15639, 446, 566, 10, 171, "Input"],
Cell[16208, 458, 763, 12, 203, "Input"],
Cell[16974, 472, 51, 1, 27, "Input"],
Cell[17028, 475, 167, 3, 43, "Input"],
Cell[17198, 480, 160, 4, 43, "Input"],
Cell[17361, 486, 131, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[17517, 492, 51, 1, 27, "Input"],
Cell[17571, 495, 62, 1, 29, "Output"]
}, Open  ]],
Cell[17648, 499, 47, 1, 27, "Input"],
Cell[17698, 502, 210, 5, 59, "Input"],
Cell[17911, 509, 311, 6, 91, "Input"],
Cell[18225, 517, 113, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[18363, 523, 432, 8, 107, "Input"],
Cell[18798, 533, 52, 1, 27, "Output"],
Cell[18853, 536, 42, 1, 27, "Output"]
}, Open  ]],
Cell[18910, 540, 149, 3, 59, "Input"],
Cell[19062, 545, 311, 5, 107, "Input"],
Cell[19376, 552, 502, 8, 187, "Input"],

Cell[CellGroupData[{
Cell[19903, 564, 48, 1, 27, "Input"],
Cell[19954, 567, 37, 1, 27, "Output"]
}, Open  ]],
Cell[20006, 571, 230, 4, 59, "Input"],
Cell[20239, 577, 83, 1, 27, "Input"],
Cell[20325, 580, 361, 7, 91, "Input"],
Cell[20689, 589, 1147, 20, 320, "Input"],
Cell[21839, 611, 91, 1, 33, "Input"],

Cell[CellGroupData[{
Cell[21955, 616, 143, 3, 59, "Input"],
Cell[22101, 621, 51, 1, 27, "Output"],
Cell[22155, 624, 59, 1, 27, "Output"]
}, Open  ]],
Cell[22229, 628, 94, 2, 43, "Input"],
Cell[22326, 632, 286, 5, 107, "Input"],
Cell[22615, 639, 118, 2, 27, "Input"],
Cell[22736, 643, 105, 2, 29, "Input"],
Cell[22844, 647, 149, 2, 59, "Input"],
Cell[22996, 651, 55, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[23076, 656, 1498, 26, 395, "Input"],
Cell[24577, 684, 42, 1, 27, "Output"]
}, Open  ]],
Cell[24634, 688, 26, 0, 27, "Input"],
Cell[24663, 690, 199, 4, 69, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[24899, 699, 43, 0, 44, "Section"],
Cell[24945, 701, 69, 0, 38, "Subsection"],

Cell[CellGroupData[{
Cell[25039, 705, 73, 0, 38, "Subsection"],
Cell[25115, 707, 104, 2, 43, "Input"],

Cell[CellGroupData[{
Cell[25244, 713, 187, 4, 75, "Input"],
Cell[25434, 719, 37, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[25508, 725, 594, 10, 171, "Input"],
Cell[26105, 737, 444, 8, 59, "Output"],
Cell[26552, 747, 35, 1, 27, "Output"]
}, Open  ]],
Cell[26602, 751, 376, 6, 123, "Input"],
Cell[26981, 759, 173, 3, 59, "Input"],

Cell[CellGroupData[{
Cell[27179, 766, 330, 5, 96, "Input"],
Cell[27512, 773, 120, 2, 29, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[27669, 780, 26, 0, 27, "Input"],
Cell[27698, 782, 169, 3, 43, "Output"]
}, Open  ]],
Cell[27882, 788, 275, 5, 138, "Input"],
Cell[28160, 795, 64, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[28249, 800, 185, 4, 59, "Input"],
Cell[28437, 806, 80, 1, 27, "Output"]
}, Open  ]],
Cell[28532, 810, 89, 1, 27, "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[28670, 817, 41, 0, 44, "Section"],
Cell[28714, 819, 45, 1, 27, "Input"],
Cell[28762, 822, 209, 5, 59, "Input"],
Cell[28974, 829, 418, 7, 123, "Input"],
Cell[29395, 838, 70, 1, 27, "Input"],
Cell[29468, 841, 394, 7, 93, "Input"],
Cell[29865, 850, 311, 6, 53, "Input"],
Cell[30179, 858, 368, 8, 75, "Input"],
Cell[30550, 868, 113, 2, 27, "Input"],
Cell[30666, 872, 1185, 25, 212, "Input"],
Cell[31854, 899, 1186, 22, 315, "Input"],
Cell[33043, 923, 58, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[33126, 928, 98, 2, 43, "Input"],
Cell[33227, 932, 58, 1, 26, "Output"],
Cell[33288, 935, 59, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[33384, 941, 79, 1, 31, "Input"],
Cell[33466, 944, 122, 2, 27, "Output"]
}, Open  ]],
Cell[33603, 949, 200, 4, 31, "Input"],
Cell[33806, 955, 1359, 33, 217, "Input"],

Cell[CellGroupData[{
Cell[35190, 992, 515, 13, 106, "Input"],
Cell[35708, 1007, 82, 1, 26, "Output"],
Cell[35793, 1010, 77, 1, 26, "Output"],
Cell[35873, 1013, 307, 5, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[36217, 1023, 63, 1, 27, "Input"],
Cell[36283, 1026, 84, 1, 26, "Output"]
}, Open  ]],
Cell[36382, 1030, 217, 4, 27, "Input"],
Cell[36602, 1036, 409, 7, 139, "Input"],

Cell[CellGroupData[{
Cell[37036, 1047, 55, 1, 27, "Input"],
Cell[37094, 1050, 78, 1, 26, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[37221, 1057, 35, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[37281, 1061, 176, 4, 75, "Input"],
Cell[37460, 1067, 42, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[37539, 1073, 174, 4, 91, "Input"],
Cell[37716, 1079, 39, 1, 27, "Output"]
}, Open  ]],
Cell[37770, 1083, 228, 4, 75, "Input"],
Cell[38001, 1089, 627, 10, 203, "Input"],
Cell[38631, 1101, 63, 1, 27, "Input"],
Cell[38697, 1104, 209, 5, 59, "Input"],
Cell[38909, 1111, 180, 3, 43, "Input"],
Cell[39092, 1116, 132, 3, 43, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[39261, 1124, 30, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[39316, 1128, 44, 1, 27, "Input"],
Cell[39363, 1131, 219, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[39619, 1139, 358, 6, 91, "Input"],
Cell[39980, 1147, 45, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[40062, 1153, 70, 1, 27, "Input"],
Cell[40135, 1156, 130, 3, 26, "Output"]
}, Open  ]],
Cell[40280, 1162, 305, 5, 43, "Input"],
Cell[40588, 1169, 233, 4, 27, "Input"],

Cell[CellGroupData[{
Cell[40846, 1177, 54, 1, 27, "Input"],
Cell[40903, 1180, 318, 5, 20, "Message"]
}, Open  ]],

Cell[CellGroupData[{
Cell[41258, 1190, 425, 8, 139, "Input"],
Cell[41686, 1200, 45, 1, 26, "Output"]
}, Open  ]],
Cell[41746, 1204, 52, 1, 27, "Input"],
Cell[41801, 1207, 56, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[41882, 1212, 163, 3, 76, "Input"],
Cell[42048, 1217, 58, 1, 26, "Output"],
Cell[42109, 1220, 53, 1, 26, "Output"],
Cell[42165, 1223, 53, 1, 26, "Output"]
}, Open  ]],
Cell[42233, 1227, 287, 5, 84, "Input"],
Cell[42523, 1234, 339, 6, 101, "Input"],
Cell[42865, 1242, 456, 8, 84, "Input"],

Cell[CellGroupData[{
Cell[43346, 1254, 46, 0, 40, "Subsection"],

Cell[CellGroupData[{
Cell[43417, 1258, 44, 1, 27, "Input"],
Cell[43464, 1261, 199, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[43700, 1269, 229, 5, 75, "Input"],
Cell[43932, 1276, 40, 1, 26, "Output"]
}, Open  ]],
Cell[43987, 1280, 81, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[44093, 1285, 359, 8, 59, "Input"],
Cell[44455, 1295, 56, 1, 26, "Output"]
}, Open  ]],
Cell[44526, 1299, 469, 9, 107, "Input"],
Cell[44998, 1310, 55, 1, 27, "Input"],
Cell[45056, 1313, 124, 2, 59, "Input"],
Cell[45183, 1317, 106, 2, 44, "Input"],
Cell[45292, 1321, 228, 3, 59, "Input"],
Cell[45523, 1326, 215, 3, 59, "Input"],
Cell[45741, 1331, 75, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[45841, 1336, 125, 2, 43, "Input"],
Cell[45969, 1340, 52, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[46058, 1346, 497, 9, 91, "Input"],
Cell[46558, 1357, 42, 1, 26, "Output"]
}, Open  ]],
Cell[46615, 1361, 623, 12, 107, "Input"],
Cell[47241, 1375, 150, 3, 43, "Input"],
Cell[47394, 1380, 739, 11, 155, "Input"],
Cell[48136, 1393, 193, 3, 27, "Input"],

Cell[CellGroupData[{
Cell[48354, 1400, 109, 2, 31, "Input"],
Cell[48466, 1404, 35, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[48538, 1410, 112, 2, 31, "Input"],
Cell[48653, 1414, 35, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[48725, 1420, 70, 1, 27, "Input"],
Cell[48798, 1423, 75, 1, 27, "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[48922, 1430, 31, 0, 40, "Subsection"],
Cell[48956, 1432, 52, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[49033, 1437, 133, 3, 43, "Input"],
Cell[49169, 1442, 38, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[49244, 1448, 190, 5, 59, "Input"],
Cell[49437, 1455, 42, 1, 26, "Output"]
}, Open  ]],
Cell[49494, 1459, 48, 1, 27, "Input"],
Cell[49545, 1462, 722, 14, 155, "Input"],
Cell[50270, 1478, 58, 1, 27, "Input"],
Cell[50331, 1481, 66, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[50422, 1486, 48, 1, 27, "Input"],
Cell[50473, 1489, 37, 1, 26, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{
Cell[50571, 1497, 39, 0, 74, "Section"],
Cell[50613, 1499, 389, 7, 123, "Input"],
Cell[51005, 1508, 233, 4, 91, "Input"],

Cell[CellGroupData[{
Cell[51263, 1516, 105, 2, 43, "Input"],
Cell[51371, 1520, 36, 1, 27, "Output"]
}, Open  ]],
Cell[51422, 1524, 272, 5, 91, "Input"],
Cell[51697, 1531, 63, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[51785, 1536, 51, 1, 27, "Input"],
Cell[51839, 1539, 63, 1, 29, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[51939, 1545, 243, 6, 75, "Input"],
Cell[52185, 1553, 52, 1, 27, "Output"],
Cell[52240, 1556, 57, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[52334, 1562, 582, 10, 155, "Input"],
Cell[52919, 1574, 132, 3, 27, "Output"]
}, Open  ]],
Cell[53066, 1580, 126, 2, 27, "Input"],
Cell[53195, 1584, 382, 8, 107, "Input"],

Cell[CellGroupData[{
Cell[53602, 1596, 51, 1, 27, "Input"],
Cell[53656, 1599, 57, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[53750, 1605, 63, 1, 27, "Input"],
Cell[53816, 1608, 57, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[53910, 1614, 51, 1, 27, "Input"],
Cell[53964, 1617, 52, 1, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[54053, 1623, 106, 2, 43, "Input"],
Cell[54162, 1627, 52, 1, 27, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[54263, 1634, 28, 0, 44, "Section"],
Cell[54294, 1636, 106, 2, 43, "Input"],
Cell[54403, 1640, 53, 1, 27, "Input"],
Cell[54459, 1643, 48, 1, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[54544, 1649, 25, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[54594, 1653, 139, 2, 43, "Input"],
Cell[54736, 1657, 1008, 13, 101, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[55781, 1675, 89, 1, 27, "Input"],
Cell[55873, 1678, 701, 18, 159, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[56623, 1702, 32, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[56680, 1706, 44, 1, 27, "Input"],
Cell[56727, 1709, 64, 1, 26, "Output"]
}, Open  ]],
Cell[56806, 1713, 538, 10, 114, "Input"],

Cell[CellGroupData[{
Cell[57369, 1727, 41, 1, 27, "Input"],
Cell[57413, 1730, 38, 1, 26, "Output"]
}, Open  ]],
Cell[57466, 1734, 48, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[57539, 1739, 48, 1, 27, "Input"],
Cell[57590, 1742, 42, 1, 26, "Output"]
}, Open  ]],
Cell[57647, 1746, 67, 1, 27, "Input"],
Cell[57717, 1749, 51, 1, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[57805, 1755, 22, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[57852, 1759, 44, 1, 27, "Input"],
Cell[57899, 1762, 42, 1, 26, "Output"]
}, Open  ]],
Cell[57956, 1766, 938, 18, 219, "Input"],

Cell[CellGroupData[{
Cell[58919, 1788, 625, 10, 75, "Input"],
Cell[59547, 1800, 182, 5, 26, "Output"]
}, Open  ]],
Cell[59744, 1808, 489, 9, 123, "Input"],
Cell[60236, 1819, 125, 2, 43, "Input"],
Cell[60364, 1823, 87, 1, 27, "Input"]
}, Closed]],

Cell[CellGroupData[{
Cell[60488, 1829, 30, 0, 44, "Section"],
Cell[60521, 1831, 39, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[60585, 1836, 44, 1, 27, "Input"],
Cell[60632, 1839, 181, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[60850, 1847, 212, 3, 59, "Input"],
Cell[61065, 1852, 45, 1, 26, "Output"]
}, Open  ]],
Cell[61125, 1856, 1280, 25, 251, "Input"],
Cell[62408, 1883, 1073, 21, 251, "Input"],
Cell[63484, 1906, 188, 3, 27, "Input"],
Cell[63675, 1911, 108, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[63808, 1917, 42, 1, 27, "Input"],
Cell[63853, 1920, 40, 1, 26, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[63942, 1927, 27, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[63994, 1931, 44, 1, 27, "Input"],
Cell[64041, 1934, 73, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[64151, 1940, 182, 4, 43, "Input"],
Cell[64336, 1946, 242, 4, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[64615, 1955, 63, 1, 27, "Input"],
Cell[64681, 1958, 477, 13, 87, "Output"]
}, Open  ]],
Cell[65173, 1974, 130, 2, 27, "Input"],

Cell[CellGroupData[{
Cell[65328, 1980, 34, 1, 27, "Input"],
Cell[65365, 1983, 139, 2, 26, "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[65553, 1991, 26, 0, 44, "Section"],
Cell[65582, 1993, 44, 1, 27, "Input"],
Cell[65629, 1996, 1328, 22, 315, "Input"],
Cell[66960, 2020, 571, 10, 91, "Input"],

Cell[CellGroupData[{
Cell[67556, 2034, 785, 16, 155, "Input"],
Cell[68344, 2052, 397, 6, 41, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[68778, 2063, 86, 1, 27, "Input"],
Cell[68867, 2066, 36, 1, 26, "Output"]
}, Open  ]],
Cell[68918, 2070, 336, 6, 107, "Input"],

Cell[CellGroupData[{
Cell[69279, 2080, 82, 1, 38, "Subsection"],

Cell[CellGroupData[{
Cell[69386, 2085, 72, 1, 27, "Input"],
Cell[69461, 2088, 66, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[69564, 2094, 68, 1, 27, "Input"],
Cell[69635, 2097, 141, 2, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[69813, 2104, 108, 2, 43, "Input"],
Cell[69924, 2108, 45, 1, 26, "Output"]
}, Open  ]],
Cell[69984, 2112, 1112, 20, 251, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[71133, 2137, 86, 1, 38, "Subsection"],

Cell[CellGroupData[{
Cell[71244, 2142, 69, 1, 27, "Input"],
Cell[71316, 2145, 145, 2, 26, "Output"]
}, Open  ]],
Cell[71476, 2150, 72, 1, 27, "Input"],
Cell[71551, 2153, 1094, 20, 235, "Input"]
}, Open  ]],

Cell[CellGroupData[{
Cell[72682, 2178, 25, 0, 40, "Subsection"],
Cell[72710, 2180, 938, 18, 155, "Input"],
Cell[73651, 2200, 53, 1, 27, "Input"],

Cell[CellGroupData[{
Cell[73729, 2205, 53, 1, 27, "Input"],
Cell[73785, 2208, 49, 1, 26, "Output"]
}, Open  ]],
Cell[73849, 2212, 225, 4, 59, "Input"],
Cell[74077, 2218, 1517, 26, 267, "Input"],

Cell[CellGroupData[{
Cell[75619, 2248, 93, 2, 43, "Input"],
Cell[75715, 2252, 67, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[75819, 2258, 210, 5, 59, "Input"],
Cell[76032, 2265, 130, 3, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[76199, 2273, 1627, 28, 283, "Input"],
Cell[77829, 2303, 492, 14, 26, "Output"]
}, Open  ]],
Cell[78336, 2320, 70, 1, 27, "Input"],
Cell[78409, 2323, 235, 4, 43, "Input"],

Cell[CellGroupData[{
Cell[78669, 2331, 63, 1, 31, "Input"],
Cell[78735, 2334, 118, 2, 27, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[78890, 2341, 46, 1, 27, "Input"],
Cell[78939, 2344, 51, 1, 26, "Output"]
}, Open  ]],

Cell[CellGroupData[{
Cell[79027, 2350, 102, 2, 27, "Input"],
Cell[79132, 2354, 130, 3, 26, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{
Cell[79323, 2364, 32, 0, 44, "Section"],

Cell[CellGroupData[{
Cell[79380, 2368, 44, 1, 27, "Input"],
Cell[79427, 2371, 193, 3, 26, "Output"]
}, Open  ]],
Cell[79635, 2377, 368, 7, 91, "Input"],
Cell[80006, 2386, 363, 7, 43, "Input"],

Cell[CellGroupData[{
Cell[80394, 2397, 48, 1, 27, "Input"],
Cell[80445, 2400, 382, 11, 55, "Output"]
}, Open  ]],
Cell[80842, 2414, 66, 1, 27, "Input"],
Cell[80911, 2417, 1761, 31, 338, "Input"]
}, Closed]]
}
]
*)



(*******************************************************************
End of Mathematica Notebook file.
*******************************************************************)

